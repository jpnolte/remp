<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Kapitel 9 Inferenzstatistik | R für empirische Wissenschaften</title>
  <meta name="description" content="Dieses Buch bietet einfache Erklärungen mit praktischen Beispielen und Übungen, welche das Erlernen von R ohne Programmiervorkenntnisse im Selbststudium ermöglichen. Die Zielgruppe sind WissenschaftlerInnen und StudentInnen der Fachrichtungen Medizin, Psychologie, Wirtschaftswissenschaften, Sozialwissenschaften, Agrarwissenschaften, Neurowissenschaften, Biologie, Journalismus, Tourismus, Data Science, Biostatistik und allen weiteren Disziplinen, die Daten auswerten möchten." />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="Kapitel 9 Inferenzstatistik | R für empirische Wissenschaften" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/logo.png" />
  <meta property="og:description" content="Dieses Buch bietet einfache Erklärungen mit praktischen Beispielen und Übungen, welche das Erlernen von R ohne Programmiervorkenntnisse im Selbststudium ermöglichen. Die Zielgruppe sind WissenschaftlerInnen und StudentInnen der Fachrichtungen Medizin, Psychologie, Wirtschaftswissenschaften, Sozialwissenschaften, Agrarwissenschaften, Neurowissenschaften, Biologie, Journalismus, Tourismus, Data Science, Biostatistik und allen weiteren Disziplinen, die Daten auswerten möchten." />
  <meta name="github-repo" content="j3ypi/remp" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Kapitel 9 Inferenzstatistik | R für empirische Wissenschaften" />
  
  <meta name="twitter:description" content="Dieses Buch bietet einfache Erklärungen mit praktischen Beispielen und Übungen, welche das Erlernen von R ohne Programmiervorkenntnisse im Selbststudium ermöglichen. Die Zielgruppe sind WissenschaftlerInnen und StudentInnen der Fachrichtungen Medizin, Psychologie, Wirtschaftswissenschaften, Sozialwissenschaften, Agrarwissenschaften, Neurowissenschaften, Biologie, Journalismus, Tourismus, Data Science, Biostatistik und allen weiteren Disziplinen, die Daten auswerten möchten." />
  <meta name="twitter:image" content="/images/logo.png" />

<meta name="author" content="Dr. med. univ. Jan Philipp Nolte, MSc, BSc." />


<meta name="date" content="2024-12-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="images/touch-icon.png" />
  <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="visual.html"/>
<link rel="next" href="ergebnisse-exportieren.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@xiee/utils/js/key-buttons.min.js" defer></script>
<link href="https://cdn.jsdelivr.net/npm/@xiee/utils/css/key-buttons.min.css" rel="stylesheet"></link>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { } /* Alert */
code span.an { } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { } /* ControlFlow */
code span.ch { color: #0e7a0e; } /* Char */
code span.cn { } /* Constant */
code span.co { } /* Comment */
code span.cv { color: #0e7a0e; } /* CommentVar */
code span.do { } /* Documentation */
code span.er { font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fu { color: #e65100; } /* Function */
code span.im { } /* Import */
code span.in { } /* Information */
code span.kw { color: #e65100; } /* Keyword */
code span.op { } /* Operator */
code span.ot { } /* Other */
code span.pp { } /* Preprocessor */
code span.sc { } /* SpecialChar */
code span.ss { } /* SpecialString */
code span.st { color: #0e7a0e; } /* String */
code span.va { } /* Variable */
code span.vs { color: #0e7a0e; } /* VerbatimString */
code span.wa { font-weight: bold; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="toc.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="https://r-empirische-wissenschaften.de"> R für empirische Wissenschaften</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Vorwort</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#über-den-autor"><i class="fa fa-check"></i>Über den Autor</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#lizenz"><i class="fa fa-check"></i>Lizenz</a></li>
</ul></li>
<li class="part"><span><b>I Die ersten Schritte</b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Einleitung</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#für-wen-ist-dieses-buch"><i class="fa fa-check"></i><b>1.1</b> Für wen ist dieses Buch?</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#aufbau-und-bearbeitungsstrategie"><i class="fa fa-check"></i><b>1.2</b> Aufbau und Bearbeitungsstrategie</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#uebungen"><i class="fa fa-check"></i><b>1.3</b> Boxen, Übungen und Datensätze</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#books"><i class="fa fa-check"></i><b>1.4</b> Ergänzende Literatur</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="start.html"><a href="start.html"><i class="fa fa-check"></i><b>2</b> Startvoraussetzungen</a>
<ul>
<li class="chapter" data-level="2.1" data-path="start.html"><a href="start.html#installation-von-r-und-rstudio"><i class="fa fa-check"></i><b>2.1</b> Installation von R und RStudio</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="start.html"><a href="start.html#installr"><i class="fa fa-check"></i><b>2.1.1</b> Programmiersprache R</a></li>
<li class="chapter" data-level="2.1.2" data-path="start.html"><a href="start.html#rstudio"><i class="fa fa-check"></i><b>2.1.2</b> Programmierumgebung RStudio</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="start.html"><a href="start.html#aufbau"><i class="fa fa-check"></i><b>2.2</b> Aufbau von RStudio</a></li>
<li class="chapter" data-level="2.3" data-path="start.html"><a href="start.html#anpassung"><i class="fa fa-check"></i><b>2.3</b> RStudio anpassen</a></li>
<li class="chapter" data-level="2.4" data-path="start.html"><a href="start.html#functions"><i class="fa fa-check"></i><b>2.4</b> Funktionen und ihre Argumente</a></li>
<li class="chapter" data-level="2.5" data-path="start.html"><a href="start.html#packages"><i class="fa fa-check"></i><b>2.5</b> Packages (Erweiterungen)</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="start.html"><a href="start.html#installieren-und-laden"><i class="fa fa-check"></i><b>2.5.1</b> Installieren und laden</a></li>
<li class="chapter" data-level="2.5.2" data-path="start.html"><a href="start.html#required"><i class="fa fa-check"></i><b>2.5.2</b> Notwendige Packages für dieses Buch</a></li>
<li class="chapter" data-level="2.5.3" data-path="start.html"><a href="start.html#namespace"><i class="fa fa-check"></i><b>2.5.3</b> Namespace</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="start.html"><a href="start.html#help"><i class="fa fa-check"></i><b>2.6</b> Fehler- und Warnmeldungen</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="start.html"><a href="start.html#der-unterschied"><i class="fa fa-check"></i><b>2.6.1</b> Der Unterschied</a></li>
<li class="chapter" data-level="2.6.2" data-path="start.html"><a href="start.html#hilfe"><i class="fa fa-check"></i><b>2.6.2</b> Wo bekomme ich Hilfe?</a></li>
<li class="chapter" data-level="2.6.3" data-path="start.html"><a href="start.html#fehler-beheben"><i class="fa fa-check"></i><b>2.6.3</b> Fehler beheben</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Vorbereitung</b></span></li>
<li class="chapter" data-level="3" data-path="project.html"><a href="project.html"><i class="fa fa-check"></i><b>3</b> R Projekte</a>
<ul>
<li class="chapter" data-level="3.1" data-path="project.html"><a href="project.html#die-probleme-der-pfade"><i class="fa fa-check"></i><b>3.1</b> Die Probleme der Pfade</a></li>
<li class="chapter" data-level="3.2" data-path="project.html"><a href="project.html#projekte-in-rstudio-erstellen"><i class="fa fa-check"></i><b>3.2</b> Projekte in RStudio erstellen</a></li>
<li class="chapter" data-level="3.3" data-path="project.html"><a href="project.html#here"><i class="fa fa-check"></i><b>3.3</b> Der Pfad zum Datensatz</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="vars.html"><a href="vars.html"><i class="fa fa-check"></i><b>4</b> Wichtiges Grundlagenwissen</a>
<ul>
<li class="chapter" data-level="4.1" data-path="vars.html"><a href="vars.html#begin"><i class="fa fa-check"></i><b>4.1</b> Schritt für Schritt beginnen</a></li>
<li class="chapter" data-level="4.2" data-path="vars.html"><a href="vars.html#pfeil"><i class="fa fa-check"></i><b>4.2</b> Variablen speichern und verwenden</a></li>
<li class="chapter" data-level="4.3" data-path="vars.html"><a href="vars.html#datentypen"><i class="fa fa-check"></i><b>4.3</b> Datentypen</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="vars.html"><a href="vars.html#basetypes"><i class="fa fa-check"></i><b>4.3.1</b> Zahlen, Buchstaben und logische Abfragen</a></li>
<li class="chapter" data-level="4.3.2" data-path="vars.html"><a href="vars.html#factor"><i class="fa fa-check"></i><b>4.3.2</b> Faktoren</a></li>
<li class="chapter" data-level="4.3.3" data-path="vars.html"><a href="vars.html#zeitdaten"><i class="fa fa-check"></i><b>4.3.3</b> Zeitdaten</a></li>
<li class="chapter" data-level="4.3.4" data-path="vars.html"><a href="vars.html#datentypen-konvertieren"><i class="fa fa-check"></i><b>4.3.4</b> Datentypen konvertieren</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="vars.html"><a href="vars.html#struktur"><i class="fa fa-check"></i><b>4.4</b> Struktur von Datensätzen</a></li>
<li class="chapter" data-level="4.5" data-path="vars.html"><a href="vars.html#dollar"><i class="fa fa-check"></i><b>4.5</b> Der Dollar-Operator</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="io.html"><a href="io.html"><i class="fa fa-check"></i><b>5</b> Datensätze</a>
<ul>
<li class="chapter" data-level="5.1" data-path="io.html"><a href="io.html#import"><i class="fa fa-check"></i><b>5.1</b> Einlesen externer Dateien</a></li>
<li class="chapter" data-level="5.2" data-path="io.html"><a href="io.html#datensätze-aus-packages-laden"><i class="fa fa-check"></i><b>5.2</b> Datensätze aus Packages laden</a></li>
<li class="chapter" data-level="5.3" data-path="io.html"><a href="io.html#inR"><i class="fa fa-check"></i><b>5.3</b> Datensätze in R erstellen</a></li>
<li class="chapter" data-level="5.4" data-path="io.html"><a href="io.html#speichern-und-konvertieren"><i class="fa fa-check"></i><b>5.4</b> Speichern und Konvertieren</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html"><i class="fa fa-check"></i><b>6</b> Datenvorbereitung</a>
<ul>
<li class="chapter" data-level="6.1" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#tidyverse"><i class="fa fa-check"></i><b>6.1</b> Einführung</a></li>
<li class="chapter" data-level="6.2" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#select"><i class="fa fa-check"></i><b>6.2</b> Spalten auswählen, umbenennen und umsortieren</a></li>
<li class="chapter" data-level="6.3" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#filter"><i class="fa fa-check"></i><b>6.3</b> Zeilen auswählen und umsortieren</a></li>
<li class="chapter" data-level="6.4" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#mutate"><i class="fa fa-check"></i><b>6.4</b> Spalten hinzufügen und Spalteninhalte verändern</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#single"><i class="fa fa-check"></i><b>6.4.1</b> Einzelne Spalten</a></li>
<li class="chapter" data-level="6.4.2" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#across"><i class="fa fa-check"></i><b>6.4.2</b> Mehrere Spalten</a></li>
<li class="chapter" data-level="6.4.3" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#helfer"><i class="fa fa-check"></i><b>6.4.3</b> Änderungen unter Bedingungen</a></li>
<li class="chapter" data-level="6.4.4" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#function"><i class="fa fa-check"></i><b>6.4.4</b> Eigene Funktionen erstellen</a></li>
<li class="chapter" data-level="6.4.5" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#zeilenweise-berechnen"><i class="fa fa-check"></i><b>6.4.5</b> Zeilenweise berechnen</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#umgang-mit-fehlenden-werten-und-duplikaten"><i class="fa fa-check"></i><b>6.5</b> Umgang mit fehlenden Werten und Duplikaten</a></li>
<li class="chapter" data-level="6.6" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#tidy"><i class="fa fa-check"></i><b>6.6</b> Breites und langes Datenformat</a></li>
<li class="chapter" data-level="6.7" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#separate"><i class="fa fa-check"></i><b>6.7</b> Spalten trennen</a></li>
<li class="chapter" data-level="6.8" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#datensätze-zusammenführen"><i class="fa fa-check"></i><b>6.8</b> Datensätze zusammenführen</a></li>
<li class="chapter" data-level="6.9" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#datastring"><i class="fa fa-check"></i><b>6.9</b> Buchstaben und Wörter bearbeiten</a></li>
<li class="chapter" data-level="6.10" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#datafactor"><i class="fa fa-check"></i><b>6.10</b> Faktoren verändern</a></li>
<li class="chapter" data-level="6.11" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#datazeit"><i class="fa fa-check"></i><b>6.11</b> Mit Zeitdaten arbeiten</a></li>
<li class="chapter" data-level="6.12" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#binäre-antwortmatrix-erstellen"><i class="fa fa-check"></i><b>6.12</b> Binäre Antwortmatrix erstellen</a></li>
</ul></li>
<li class="part"><span><b>III Auswertung</b></span></li>
<li class="chapter" data-level="7" data-path="descr.html"><a href="descr.html"><i class="fa fa-check"></i><b>7</b> Deskriptive Statistik</a>
<ul>
<li class="chapter" data-level="7.1" data-path="descr.html"><a href="descr.html#lagestreu"><i class="fa fa-check"></i><b>7.1</b> Lagemaße und Streuungsmaße</a></li>
<li class="chapter" data-level="7.2" data-path="descr.html"><a href="descr.html#contigency"><i class="fa fa-check"></i><b>7.2</b> Häufigkeiten und Kontingenztafeln</a></li>
<li class="chapter" data-level="7.3" data-path="descr.html"><a href="descr.html#cor"><i class="fa fa-check"></i><b>7.3</b> Zusammenhangsmaße</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="visual.html"><a href="visual.html"><i class="fa fa-check"></i><b>8</b> Visualisierungen</a>
<ul>
<li class="chapter" data-level="8.1" data-path="visual.html"><a href="visual.html#einführung"><i class="fa fa-check"></i><b>8.1</b> Einführung</a></li>
<li class="chapter" data-level="8.2" data-path="visual.html"><a href="visual.html#histogram"><i class="fa fa-check"></i><b>8.2</b> Histogramm und Dichte</a></li>
<li class="chapter" data-level="8.3" data-path="visual.html"><a href="visual.html#scatter"><i class="fa fa-check"></i><b>8.3</b> Streudiagramm</a></li>
<li class="chapter" data-level="8.4" data-path="visual.html"><a href="visual.html#boxplot"><i class="fa fa-check"></i><b>8.4</b> Boxplot</a></li>
<li class="chapter" data-level="8.5" data-path="visual.html"><a href="visual.html#violin"><i class="fa fa-check"></i><b>8.5</b> Violin Plot</a></li>
<li class="chapter" data-level="8.6" data-path="visual.html"><a href="visual.html#barplot"><i class="fa fa-check"></i><b>8.6</b> Balkendiagramm</a></li>
<li class="chapter" data-level="8.7" data-path="visual.html"><a href="visual.html#anovaplot"><i class="fa fa-check"></i><b>8.7</b> Liniendiagramm</a></li>
<li class="chapter" data-level="8.8" data-path="visual.html"><a href="visual.html#qqplot"><i class="fa fa-check"></i><b>8.8</b> Quantil-Quantil Plot</a></li>
<li class="chapter" data-level="8.9" data-path="visual.html"><a href="visual.html#morefactors"><i class="fa fa-check"></i><b>8.9</b> Mehrfaktorielle Abbildungen</a>
<ul>
<li class="chapter" data-level="8.9.1" data-path="visual.html"><a href="visual.html#groups"><i class="fa fa-check"></i><b>8.9.1</b> Gruppierungsargumente</a></li>
<li class="chapter" data-level="8.9.2" data-path="visual.html"><a href="visual.html#facets"><i class="fa fa-check"></i><b>8.9.2</b> Facetten als weitere Dimensionen</a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="visual.html"><a href="visual.html#adapt"><i class="fa fa-check"></i><b>8.10</b> Anpassen des Aussehens</a>
<ul>
<li class="chapter" data-level="8.10.1" data-path="visual.html"><a href="visual.html#color"><i class="fa fa-check"></i><b>8.10.1</b> Farben</a></li>
<li class="chapter" data-level="8.10.2" data-path="visual.html"><a href="visual.html#themeaxis"><i class="fa fa-check"></i><b>8.10.2</b> Themen und Achsen</a></li>
<li class="chapter" data-level="8.10.3" data-path="visual.html"><a href="visual.html#legende-und-facetten"><i class="fa fa-check"></i><b>8.10.3</b> Legende und Facetten</a></li>
</ul></li>
<li class="chapter" data-level="8.11" data-path="visual.html"><a href="visual.html#patch"><i class="fa fa-check"></i><b>8.11</b> Anordnen mehrerer Graphen</a></li>
<li class="chapter" data-level="8.12" data-path="visual.html"><a href="visual.html#ggsave"><i class="fa fa-check"></i><b>8.12</b> Speichern von Abbildungen</a></li>
<li class="chapter" data-level="8.13" data-path="visual.html"><a href="visual.html#exemplarische-erweiterungen"><i class="fa fa-check"></i><b>8.13</b> Exemplarische Erweiterungen</a>
<ul>
<li class="chapter" data-level="8.13.1" data-path="visual.html"><a href="visual.html#kaplan"><i class="fa fa-check"></i><b>8.13.1</b> Kaplan-Meier-Kurve</a></li>
<li class="chapter" data-level="8.13.2" data-path="visual.html"><a href="visual.html#residuals"><i class="fa fa-check"></i><b>8.13.2</b> Residuen überprüfen</a></li>
<li class="chapter" data-level="8.13.3" data-path="visual.html"><a href="visual.html#ridgeline-plot"><i class="fa fa-check"></i><b>8.13.3</b> Ridgeline Plot</a></li>
</ul></li>
<li class="chapter" data-level="8.14" data-path="visual.html"><a href="visual.html#example"><i class="fa fa-check"></i><b>8.14</b> Anwendungsbeispiel</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="inductive.html"><a href="inductive.html"><i class="fa fa-check"></i><b>9</b> Inferenzstatistik</a>
<ul>
<li class="chapter" data-level="9.1" data-path="inductive.html"><a href="inductive.html#einführung-1"><i class="fa fa-check"></i><b>9.1</b> Einführung</a></li>
<li class="chapter" data-level="9.2" data-path="inductive.html"><a href="inductive.html#ein--und-zweistichprobenszenarien"><i class="fa fa-check"></i><b>9.2</b> Ein- und Zweistichprobenszenarien</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="inductive.html"><a href="inductive.html#ttest"><i class="fa fa-check"></i><b>9.2.1</b> <em>t</em> Test und Welch Test</a></li>
<li class="chapter" data-level="9.2.2" data-path="inductive.html"><a href="inductive.html#wilcoxon-test"><i class="fa fa-check"></i><b>9.2.2</b> Wilcoxon Test</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="inductive.html"><a href="inductive.html#unterschiede-mehrerer-gruppen"><i class="fa fa-check"></i><b>9.3</b> Unterschiede mehrerer Gruppen</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="inductive.html"><a href="inductive.html#aov"><i class="fa fa-check"></i><b>9.3.1</b> Varianz- und Kovarianzanalyse</a></li>
<li class="chapter" data-level="9.3.2" data-path="inductive.html"><a href="inductive.html#repeated"><i class="fa fa-check"></i><b>9.3.2</b> Varianzanalyse mit Messwiederholung</a></li>
<li class="chapter" data-level="9.3.3" data-path="inductive.html"><a href="inductive.html#kruskal"><i class="fa fa-check"></i><b>9.3.3</b> Welch Approximation und Kruskal-Wallis Test</a></li>
<li class="chapter" data-level="9.3.4" data-path="inductive.html"><a href="inductive.html#friedman"><i class="fa fa-check"></i><b>9.3.4</b> Friedman Test</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="inductive.html"><a href="inductive.html#cortest"><i class="fa fa-check"></i><b>9.4</b> Korrelationsanalysen</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="inductive.html"><a href="inductive.html#pearsoncor"><i class="fa fa-check"></i><b>9.4.1</b> Produkt-Moment Korrelation</a></li>
<li class="chapter" data-level="9.4.2" data-path="inductive.html"><a href="inductive.html#rangcor"><i class="fa fa-check"></i><b>9.4.2</b> Rangkorrelationen</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="inductive.html"><a href="inductive.html#regression"><i class="fa fa-check"></i><b>9.5</b> Regressionsmodelle</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="inductive.html"><a href="inductive.html#linregression"><i class="fa fa-check"></i><b>9.5.1</b> Lineare Regression</a></li>
<li class="chapter" data-level="9.5.2" data-path="inductive.html"><a href="inductive.html#logistische-regression"><i class="fa fa-check"></i><b>9.5.2</b> Logistische Regression</a></li>
<li class="chapter" data-level="9.5.3" data-path="inductive.html"><a href="inductive.html#multinomiales-logit-modell"><i class="fa fa-check"></i><b>9.5.3</b> Multinomiales Logit Modell</a></li>
<li class="chapter" data-level="9.5.4" data-path="inductive.html"><a href="inductive.html#propodds"><i class="fa fa-check"></i><b>9.5.4</b> Kumulatives Logit Modell</a></li>
<li class="chapter" data-level="9.5.5" data-path="inductive.html"><a href="inductive.html#poisson-regression"><i class="fa fa-check"></i><b>9.5.5</b> Poisson Regression</a></li>
<li class="chapter" data-level="9.5.6" data-path="inductive.html"><a href="inductive.html#cox"><i class="fa fa-check"></i><b>9.5.6</b> Cox Regression</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="inductive.html"><a href="inductive.html#contingency"><i class="fa fa-check"></i><b>9.6</b> Kontingenztafeln</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="inductive.html"><a href="inductive.html#fisher"><i class="fa fa-check"></i><b>9.6.1</b> Exakter Fisher Test</a></li>
<li class="chapter" data-level="9.6.2" data-path="inductive.html"><a href="inductive.html#chi"><i class="fa fa-check"></i><b>9.6.2</b> Chi Quadrat Tests</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="inductive.html"><a href="inductive.html#voraussetzung"><i class="fa fa-check"></i><b>9.7</b> Voraussetzungen überprüfen</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="inductive.html"><a href="inductive.html#normalverteilung"><i class="fa fa-check"></i><b>9.7.1</b> Normalverteilung</a></li>
<li class="chapter" data-level="9.7.2" data-path="inductive.html"><a href="inductive.html#varianzhomogenitaet"><i class="fa fa-check"></i><b>9.7.2</b> Varianzhomogenität und Homoskedastizität</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="inductive.html"><a href="inductive.html#broom"><i class="fa fa-check"></i><b>9.8</b> Ergebnisse formatieren</a></li>
</ul></li>
<li class="part"><span><b>IV Vertiefung</b></span></li>
<li class="chapter" data-level="10" data-path="ergebnisse-exportieren.html"><a href="ergebnisse-exportieren.html"><i class="fa fa-check"></i><b>10</b> Ergebnisse exportieren</a>
<ul>
<li class="chapter" data-level="10.1" data-path="ergebnisse-exportieren.html"><a href="ergebnisse-exportieren.html#intromarkdown"><i class="fa fa-check"></i><b>10.1</b> Wichtige Begriffe</a></li>
<li class="chapter" data-level="10.2" data-path="ergebnisse-exportieren.html"><a href="ergebnisse-exportieren.html#markdown"><i class="fa fa-check"></i><b>10.2</b> Berichte erstellen</a></li>
<li class="chapter" data-level="10.3" data-path="ergebnisse-exportieren.html"><a href="ergebnisse-exportieren.html#tabellen-umwandeln"><i class="fa fa-check"></i><b>10.3</b> Tabellen umwandeln</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="ergebnisse-exportieren.html"><a href="ergebnisse-exportieren.html#knitr"><i class="fa fa-check"></i><b>10.3.1</b> Exportieren nach Word und PDF</a></li>
<li class="chapter" data-level="10.3.2" data-path="ergebnisse-exportieren.html"><a href="ergebnisse-exportieren.html#latex"><i class="fa fa-check"></i><b>10.3.2</b> Exportieren nach LaTeX</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="ergebnisse-exportieren.html"><a href="ergebnisse-exportieren.html#quarto"><i class="fa fa-check"></i><b>10.4</b> Alternative mit Quarto</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="datatypes.html"><a href="datatypes.html"><i class="fa fa-check"></i><b>11</b> Datenstrukturen</a>
<ul>
<li class="chapter" data-level="11.1" data-path="datatypes.html"><a href="datatypes.html#vec"><i class="fa fa-check"></i><b>11.1</b> Vektor</a></li>
<li class="chapter" data-level="11.2" data-path="datatypes.html"><a href="datatypes.html#matrix"><i class="fa fa-check"></i><b>11.2</b> Matrix</a></li>
<li class="chapter" data-level="11.3" data-path="datatypes.html"><a href="datatypes.html#tibble"><i class="fa fa-check"></i><b>11.3</b> Data.frame und tibble</a></li>
<li class="chapter" data-level="11.4" data-path="datatypes.html"><a href="datatypes.html#lists"><i class="fa fa-check"></i><b>11.4</b> Liste</a></li>
<li class="chapter" data-level="11.5" data-path="datatypes.html"><a href="datatypes.html#umwandlung"><i class="fa fa-check"></i><b>11.5</b> Umwandlungen</a></li>
<li class="chapter" data-level="11.6" data-path="datatypes.html"><a href="datatypes.html#objekte-und-objektorientierung"><i class="fa fa-check"></i><b>11.6</b> Objekte und Objektorientierung</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="iterationmain.html"><a href="iterationmain.html"><i class="fa fa-check"></i><b>12</b> Funktionen wiederholt anwenden</a>
<ul>
<li class="chapter" data-level="12.1" data-path="iterationmain.html"><a href="iterationmain.html#iteration"><i class="fa fa-check"></i><b>12.1</b> Das Copy &amp; Paste Problem</a></li>
<li class="chapter" data-level="12.2" data-path="iterationmain.html"><a href="iterationmain.html#map"><i class="fa fa-check"></i><b>12.2</b> Listenbasierte Berechnungen</a></li>
<li class="chapter" data-level="12.3" data-path="iterationmain.html"><a href="iterationmain.html#for"><i class="fa fa-check"></i><b>12.3</b> for-Schleifen</a></li>
<li class="chapter" data-level="12.4" data-path="iterationmain.html"><a href="iterationmain.html#nest"><i class="fa fa-check"></i><b>12.4</b> Einnisten</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>Appendix</a>
<ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#datensatzerläuterungen"><i class="fa fa-check"></i>Datensatzerläuterungen</a>
<ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#big-5-persönlichkeitsfaktoren"><i class="fa fa-check"></i>Big 5 Persönlichkeitsfaktoren</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#statistische-bildung"><i class="fa fa-check"></i>Statistische Bildung</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#bitcoin-aktienkurs"><i class="fa fa-check"></i>Bitcoin Aktienkurs</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#radiochemotherapie"><i class="fa fa-check"></i>Radiochemotherapie</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#sars-cov-2-diagnostik"><i class="fa fa-check"></i>SARS-CoV-2 Diagnostik</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#eye-tracking"><i class="fa fa-check"></i>Eye Tracking</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#iq-und-kreativität"><i class="fa fa-check"></i>IQ und Kreativität</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#musikstreaming-nutzerstatistik"><i class="fa fa-check"></i>Musikstreaming Nutzerstatistik</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#videostreaming-nutzerstatitstik"><i class="fa fa-check"></i>Videostreaming Nutzerstatitstik</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#fußballwetten"><i class="fa fa-check"></i>Fußballwetten</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#literaturverzeichnis"><i class="fa fa-check"></i>Literaturverzeichnis</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#verwendete-softwareversionen"><i class="fa fa-check"></i>Verwendete Softwareversionen</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R für empirische Wissenschaften</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="inductive" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Kapitel 9</span> Inferenzstatistik<a href="inductive.html#inductive" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<blockquote>
<p>In diesem Kapitel wird die Umsetzung der gängigsten statistischen Modelle in R gezeigt. Dabei liegt der Fokus klar auf der Programmierung und nicht auf dem für die Interpretation notwendigen Statistikwissen. Letzteres sollte aus einem der angegeben Statistikbüchern entnommen werden. Durch diese strikte Trennung können wir in den Unterkapiteln auch fortgeschrittenere Modelle betrachten, die in anderen Programmierbüchern leider häufig ausgelassen werden. Nach diesem Kapitel kannst du (fast) alle deiner Forschungsfragen mit R beantworten.</p>
</blockquote>
<div id="einführung-1" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Einführung<a href="inductive.html#einführung-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Welches statistische Modell zur Beantwortung der eigenen Forschungsfragen in Form von Hypothesen geeignet ist, hängt im Wesentlichen von der Art der Hypothese, der zugrunde liegenden Verteilung und dem Skalenniveau der Merkmale ab. Die Ausgabe der Ergebnisse sieht dabei immer ähnlich aus und enthält die wesentlichen Informationen, die in einer wissenschaftlichen Arbeit berichtet werden müssen. Während wir hauptsächlich direkt in R integrierte Funktionen verwenden werden, sind in Einzelfällen zusätzliche Packages notwendig, auf die an geeigneter Stelle hingewiesen wird.</p>
<p>In den folgenden Kapiteln werden wir einen Datensatz namens <code>chemo</code> verwenden, der im <a href="https://r-empirische-wissenschaften.de">remp</a> Package enthalten ist (siehe Kapitel <a href="start.html#required">2.5.2</a> zur Installationsanleitung). 450 PatientInnen mit einer bösartigen Krebserkrankung haben entweder nur Chemotherapie, nur eine Bestrahlung oder eine Kombination aus beidem erhalten. Neben der Beobachtungszeit (<code>Beob_zeit</code>) unter jeder dieser Behandlungen, wurden ebenfalls weitere Merkmale untersucht, die wir in den folgendenen Kapiteln als <strong>abhängige Variablen</strong> verwenden werden.</p>
<pre class="bordercode"><code># A tibble: 450 × 8
  Stationaer Komorb Schmerzen Lebensqualitaet Infektionen Leukos_t0 Leukos_t6 Beob_zeit
       &lt;int&gt; &lt;fct&gt;      &lt;int&gt;           &lt;int&gt;       &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1          0 Keine          6               2           4      5.74      5.68     0.833
2          0 Lunge          2               2           3      6.71      6.64     4.80 
3          0 Keine          7               2           3      6.03      5.97     1.46 
4          1 Keine          2               4           1      5.6       5.55     0.922
# ℹ 446 more rows</code></pre>
<p>Der stationäre Aufenthalt aufgrund einer schweren Infektion <code>Stationaer</code> ist binär und wird durch eine Binomialverteilung modelliert. Die Information über weitere Erkrankungen <code>Komorb</code> (kurz für Komorbiditäten) ist nominal skaliert aus der Multinomialverteilung. Die Variablen <code>Schmerzen</code> und <code>Lebensqualitaet</code> wurden durch einen Fragebogen auf jeweils 10 Stufen erfasst und haben daher ein ordinales Skalenniveau. Die Häufigkeit von <code>Infektionen</code> innerhalb von zwei Jahren hat eine negative Binomialverteilung. Schließlich wurde die Anzahl der Leukozyten zu Beginn der Therapie (<code>Leukos_t0</code>) und 6 Monate später (<code>Leukos_t6</code>) erhoben, die jeweils normalverteilt und intervallskaliert (auch metrisch genannt) sind. Leukozyten sind weiße Blutzellen, die einen integralen Bestandteil des Immunsystems darstellen.</p>
<p>Die beschriebenen interessierenden Größen können möglicherweise Unterschiede bzw. Zusammenhänge im Bezug auf das biologische Geschlecht, die Behandlungsart und dem Alter haben. Diese stellen unsere <strong>unabhängigen Variablen</strong> in sämtlichen Unterkapiteln dar.</p>
<pre class="bordercode"><code># A tibble: 450 × 3
  Alter Geschlecht Behandlung
  &lt;dbl&gt; &lt;chr&gt;      &lt;fct&gt;     
1    49 f          Radio     
2    46 f          Radiochemo
3    41 m          Radio     
4    43 f          Radio     
# ℹ 446 more rows</code></pre>
<p>Es handelt sich beim <code>chemo</code> Datensatz nicht um reale Daten. Stattdessen wurden die einzelnen Variablen simuliert, was den Vorteil bietet, dass die wahren Verteilungen und Effekte bekannt sind. Für genaue Informationen über die zur Simulation verwendeten Parameter sei auf die <a href="https://r-empirische-wissenschaften.de/reference/index.html">Dokumentation</a> verwiesen.</p>
<p>In R werden für inferenzstatistische Methoden zwei verschiedene Schreibweisen verwendet. Entweder müssen die interessierenden Variablen in Form von Vektoren (oder Wertereihen) aus dem Datensatz mithilfe des Dollar-Operators extrahiert werden (siehe Kapitel <a href="vars.html#dollar">4.5</a>). Oder es wird im Kontext von (verallgemeinerten) linearen Modellen auf eine Formelschreibweise zurückgegriffen, bei der auf der linken Seite einer Tilde <code>~</code> die abhängige Variable und auf der rechten Seite eine oder mehrere unabhängige Variablen (Faktoren oder Kovariaten), getrennt von einem Pluszeichen, geschrieben werden. Interaktionsterme können wir mithilfe eines Doppelpunktes hinzufügen. In diesem Buch konzentrieren wir uns auf univariate Fragestellungen mit einer abhängigen Variable und einer oder mehreren unabhängigen Variablen.</p>
<p>Die innerhalb von R ausgegebenen Ergebnislisten sind zwar übersichtlich, allerdings nicht geeignet zum Weiterverarbeiten in Tabellenform beim Exportieren nach Word oder in ein PDF. Dafür gibt es ein dediziertes Package, welches abschließend in Kapitel <a href="inductive.html#broom">9.8</a> vorgestellt wird.</p>
</div>
<div id="ein--und-zweistichprobenszenarien" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Ein- und Zweistichprobenszenarien<a href="inductive.html#ein--und-zweistichprobenszenarien" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="ttest" class="section level3 hasAnchor" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> <em>t</em> Test und Welch Test<a href="inductive.html#ttest" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Zum Berechnen der Effektstärken muss das <code>effectsize</code> Package installiert und geladen sein.</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb447-1"><a href="inductive.html#cb447-1" tabindex="-1"></a><span class="fu">library</span>(effectsize)</span></code></pre></div>
<p>Im Einstichproben <em>t</em> Test untersuchen wir ein normalverteiltes, intervallskaliertes Merkmal in Hinblick auf einen unter der Nullhypothese festgelegten Mittelwert (<span class="math inline">\(\mu\)</span>). In Bezug auf unseren <code>chemo</code> Datensatz fragen wir uns, ob die mittlere Leukoyztenanzahl nach sechs Monaten Behandlung statistisch signifikant von dem Normwert von 6 E9/L abweicht. Wir würden unter der Nullhypothese demnach einen Mittelwert der Spalte <code>Leukos_t6</code> in Höhe von 6 E9/L erwarten.</p>
<p>In R setzen wir dies mit der Funktion <code>t.test()</code> um, welcher wir beim Untersuchen einer Stichprobe zunächst die interessierende Variable <code>Leukos_t6</code> als Vektor (bzw. Wertereihe) mithilfe des Dollar-Operators übergeben (siehe Kapitel <a href="vars.html#dollar">4.5</a>). Anschließend müssen wir noch den Mittelwert <span class="math inline">\(\mu\)</span> festlegen, welchen wir unter der Nullhypothese, dass es keinen Unterschied zwischen beiden Mittelwerten gibt, erwarten würden.</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb448-1"><a href="inductive.html#cb448-1" tabindex="-1"></a><span class="fu">t.test</span>(chemo<span class="sc">$</span>Leukos_t6, <span class="at">mu =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre class="bordercode"><code>
    One Sample t-test

data:  chemo$Leukos_t6
t = -1.3637, df = 449, p-value = 0.1734
alternative hypothesis: true mean is not equal to 6
95 percent confidence interval:
 5.947976 6.009402
sample estimates:
mean of x 
 5.978689 </code></pre>
<p>In der Ausgabe sehen wir den <em>t</em>-Wert (-1.3637), die Freiheitsgrade (449), den <em>p</em>-Wert (0.1734), die Alternativhypothesen, das 95% Konfidenzintervall (5.95; 6.01) und den Mittelwert der Leukozyten (5.98). Bei einem in der Wissenschaft üblichen <span class="math inline">\(\alpha\)</span>-Niveau (Fehler 1. Art) von 5% ist der auf Basis der geschätzten Teststatistik berechnete <em>p</em>-Wert nicht statistisch signifikant, da 0.1734 größer als 0.05 ist. Die Nullhypothese wird demnach beibehalten. Sprich, die Leukozytenanzahl nach sechs Monaten Behandlung weicht nicht signifikant vom Normwert ab.</p>
<p>Zweiseitige Hypothesentests (Mittelwerte sind gleich oder ungleich) sind in der wissenschaftlichen Praxis zwar Standard, weil die Richtung des Effekt vorher selten bekannt ist. Allerdings können wir in Ausnahmefällen mit dem Argument <code>alternative</code> allerdings auch einseitige Hypothesen testen (<code>"less"</code> oder <code>"greater"</code>). Die Standardeinstellung ist ein zweiseitiger Test, weswegen wir das Argument in unserem Beispiel nicht extra benennen müssen. Das <span class="math inline">\(\alpha\)</span>-Niveau kann über das Argument <code>conf.level</code> modifiziert werden, welches mit 0.95 (also einem <span class="math inline">\(\alpha\)</span> von 5%) voreingestellt ist.</p>
<p>Für den <em>t</em> Test nehmen wir neben einer zugrunde liegenden Normalverteilung beider Merkmale außerdem gleiche Varianzen an (siehe Kapitel <a href="inductive.html#voraussetzung">9.7</a>). Dies müssen wir explizit mit dem Argument <code>var.equal</code> festlegen, da die Standardeinstellung in R von ungleichen Varianzen ausgeht. Bei ungleichen Varianzen (<code>var.equal = FALSE</code>) wird ein Welch Test berechnet, welcher die Freiheitsgrade entsprechend korrigiert. Die Überprüfungen der Voraussetzungen der Normalverteilung und Varianzhomogenität wird in Kapitel <a href="inductive.html#voraussetzung">9.7</a> erläutert.</p>
<p>Wir sind an dieser Stelle an der Hypothese interessiert, ob sich die mittlere Leukozytenzahl nach sechs Monaten zwischen den biologischen Geschlechtern signifikant voneinander unterscheidet. Um zwei Gruppen in R zu vergleichen, verwenden wir die Formelschreibweise. Auf die linke Seite der Tilde schreiben wir die intervallskalierte Variable <code>Leukos_t6</code> und auf die rechten Seite die kategorisierende Variable <code>Geschlecht</code>.</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb450-1"><a href="inductive.html#cb450-1" tabindex="-1"></a><span class="fu">t.test</span>(Leukos_t6 <span class="sc">~</span> Geschlecht, <span class="at">data =</span> chemo, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre class="bordercode"><code>
    Two Sample t-test

data:  Leukos_t6 by Geschlecht
t = 1.456, df = 448, p-value = 0.1461
alternative hypothesis: true difference in means between group f and group m is not equal to 0
95 percent confidence interval:
 -0.01591524  0.10690584
sample estimates:
mean in group f mean in group m 
       6.000426        5.954930 </code></pre>
<p>Da der <em>p</em>-Wert auch in diesem Beispiel mit 0.1461 größer als 0.05 ist, behalten wir auch hier bei einem <span class="math inline">\(\alpha\)</span>-Niveau von 5% die Nullhypothese bei. In unserer Stichprobe gibt es folglich keine signifikanten Unterschiede in der Leukoyztenzahl zwischen den Gechlechtern.</p>
<p>Zusätzlich zum <em>t</em> Test sollte eine Effektstärke berechnet werden, die im Kontext von Mittelwertsvergleichen häufig Cohens d oder Hedges g darstellt. Mit der Funktion <code>cohens_d()</code> respektive <code>hedges_g()</code> aus dem <code>effectsize</code> Package sind diese in R implementiert. Zur Berechnung übergeben wir die Variablen fast identisch wie zuvor innerhalb der Funktion <code>t.test()</code>. Es ändert sich lediglich das Argument <code>var.equal</code> zu <code>pooled_sd</code>.</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb452-1"><a href="inductive.html#cb452-1" tabindex="-1"></a><span class="fu">cohens_d</span>(Leukos_t6 <span class="sc">~</span> Geschlecht, <span class="at">data =</span> chemo, <span class="at">pooled_sd =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre class="bordercode"><code>Cohen&#39;s d |        95% CI
-------------------------
0.14      | [-0.05, 0.32]

- Estimated using pooled SD.</code></pre>
<p>Beachte, dass bei einem <em>t</em> Test nur zwei Gruppen miteinander verglichen werden können. Für mehr als zwei Gruppen kann auf eine Varianzanalyse zurückgegriffen werden (siehe Kapitel <a href="inductive.html#aov">9.3.1</a>).</p>
<p>Für einen Test auf abhängige (verbundene, gepaarte) Stichproben, müssen wir zusätzlich das <code>paired</code> Argument hinzufügen. Unterscheiden sich die Mittelwerte der Leukozytenanzahlen von Behandlungsbeginn im Vergleich zur Messung nach sechs Monaten? Zur Beantwortung dieser Hypothese übergeben wir der Funktion <code>t.test()</code> die beiden Variablen mit dem Dollar-Operator als Vektoren.</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb454-1"><a href="inductive.html#cb454-1" tabindex="-1"></a><span class="fu">t.test</span>(chemo<span class="sc">$</span>Leukos_t0, chemo<span class="sc">$</span>Leukos_t6, <span class="at">var.equal =</span> <span class="cn">TRUE</span>, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre class="bordercode"><code>
    Paired t-test

data:  chemo$Leukos_t0 and chemo$Leukos_t6
t = 251.83, df = 449, p-value &lt; 2.2e-16
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 0.05926718 0.06019949
sample estimates:
mean difference 
     0.05973333 </code></pre>
<p>Die Leukoyztenanzahl ist zwischen den beiden Messzeitpunkten statistisch signifikant unterschiedlich, da der <em>p</em>-Wert kleiner als 2.2e-16 ist, was die wissenschaftliche Notation für eine Zahl mit 15 Nullen hinter dem Komma darstellt. Die Alternativhypothese wird in diesem Beispiel demnach angenommen. Auch hier können wir die Effektstärke in Form von Cohens d berechnen. Allerdings verwenden wir hier die Funktion <code>repeated_measures_d()</code> aus dem <code>effectsize</code> Package. An dieser Stelle ist der beobachtete Effekt deutlich größer als beim vorherigen <em>t</em>-Test, was wir in Hinblick auf den signifikanten <em>p</em>-Wert auch erwarten würden.</p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb456-1"><a href="inductive.html#cb456-1" tabindex="-1"></a><span class="fu">repeated_measures_d</span>(chemo<span class="sc">$</span>Leukos_t0, chemo<span class="sc">$</span>Leukos_t6)</span></code></pre></div>
<pre class="bordercode"><code>d (rm) |       95% CI
---------------------
0.14   | [0.14, 0.14]

- Adjusted for small sample bias.</code></pre>
<div class="idea">
<p>Bei einem Vergleich von Mittelwerten intervallskalierter (metrischer) Merkmale mit maximal zwei Gruppen können wir <em>t</em> Tests verwenden. Falls die Variablen keine ähnliche Varianz haben, wählen wir stattdessen den Welch-Test. Auch bei Verletzung der Annahme einer Normalverteilung kann der Welch-Test eine gute Wahl sein. Bei gröberen Verletzungen oder bei ordinalem Skalenniveau greifen wir hingegen auf nicht-parametrische Tests wie den Wilcoxon Test zurück, welcher im folgenden Kapitel eingeführt wird.</p>
</div>
</div>
<div id="wilcoxon-test" class="section level3 hasAnchor" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> Wilcoxon Test<a href="inductive.html#wilcoxon-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Zum Berechnen der Effektstärke muss das <code>effectsize</code> Package installiert und geladen werden.</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb458-1"><a href="inductive.html#cb458-1" tabindex="-1"></a><span class="fu">library</span>(effectsize)</span></code></pre></div>
<p>Der Wilcoxon Test für unabhängige Stichproben ist ein nicht-parametrischer Hypothesentest für intervall- oder ordinalskalierte Variablen, welcher bei Verletzungen der Annahmen von Normalverteilung und Varianzhomogenität Anwendung findet. Dieser wird in der Literatur auch als Mann-Whitney U-Test bezeichnet.</p>
<p>In R ist dieser in Form der Funktion <code>wilcox.test()</code> enthalten, welcher äquivalent zum <em>t</em> Test des vorherigen Kapitels angewandt wird. Beim Vergleich einer intervallskalierten Variable zwischen zwei Gruppen verwenden wir daher auch in diesem Fall die Formelschreibweise mit kategorisierenden Variable auf der rechten Seite der Tilde. Zusätzlich lassen wir uns das 95%iger Konfidenzintervall ausgeben.</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb459-1"><a href="inductive.html#cb459-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(Leukos_t6 <span class="sc">~</span> Geschlecht, <span class="at">data =</span> chemo, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre class="bordercode"><code>
    Wilcoxon rank sum test with continuity correction

data:  Leukos_t6 by Geschlecht
W = 26825, p-value = 0.2571
alternative hypothesis: true location shift is not equal to 0
95 percent confidence interval:
 -0.02999439  0.10002589
sample estimates:
difference in location 
            0.03998897 </code></pre>
<p>Als Ergebnis erhalten wir die geschätzte Kenngröße <code>W</code> und den zugehörigen <em>p</em>-Wert. Der <em>p</em>-Wert ist mit 0.2571 größer als 0.05 und somit nicht statistisch signifikant. Es wird also die Alternativhypothese abgelehnt und die Nullhypothese beibehalten. Die Leukozytenverteilungen der beiden biologischen Geschlechter unterscheiden sich demnach in unseren Daten nicht nennenswert voneinander. Eine geeignete Effektstärke ist die biseriale Rangkorrelation, die wir mit der Funktion <code>rank_biserial()</code> aus dem <code>effectsize</code> Package berechnen.</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb461-1"><a href="inductive.html#cb461-1" tabindex="-1"></a><span class="fu">rank_biserial</span>(Leukos_t6 <span class="sc">~</span> Geschlecht, <span class="at">data =</span> chemo)</span></code></pre></div>
<pre class="bordercode"><code>r (rank biserial) |        95% CI
---------------------------------
0.06              | [-0.04, 0.17]</code></pre>
<p>Im Kontext von abhängigen (bzw. gepaarten) Stichproben findet stattdessen der Wilcoxon-Vorzeichen-Rang Test Anwendung. Dies ist häufig in Szenarien mit wiederholten Messungen für dieselbe Person der Fall. In unserem Datensatz haben wir die Leukozytenzahl zu zwei verschiedenen Zeitpunkten gemessen. Durch das Setzen des Arguments <code>paired</code> auf <code>TRUE</code> erhalten wir den entsprechenden Schätzer. Wie im vorherigen Kapitel übergeben wir die beiden Spalten als Vektoren mithilfe des Dollar-Operators (siehe Kapitel <a href="vars.html#dollar">4.5</a>).</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb463-1"><a href="inductive.html#cb463-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(chemo<span class="sc">$</span>Leukos_t0, chemo<span class="sc">$</span>Leukos_t6, <span class="at">paired =</span> <span class="cn">TRUE</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre class="bordercode"><code>
    Wilcoxon signed rank test with continuity correction

data:  chemo$Leukos_t0 and chemo$Leukos_t6
V = 101475, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0
95 percent confidence interval:
 0.05996573 0.06004989
sample estimates:
(pseudo)median 
    0.05996195 </code></pre>
<p>Ähnlich wie beim <em>t</em> Test des vorherigen Kapitels finden wir auch hier einen statistisch signifikanten <em>p</em>-Wert. Der Wert ist in diesem Fall kleiner als <span class="math inline">\(2.2*10^{-16}\)</span>, was einer Zahl kleiner 0.00000000000000022 entspricht. Andere Statistikprogramm wie SPSS geben bereits bei <em>p</em>-Werten kleiner 0.001 keinen exakten Wert mehr aus. Auch hier können wir erneut die biseriale Rangkorrelation berechnen. Die augenscheinlich perfekte Korrelation ist der Natur der simulierten Daten geschuldet und kommt im Kontext echter Daten normalerweise nicht vor.</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb465-1"><a href="inductive.html#cb465-1" tabindex="-1"></a><span class="fu">rank_biserial</span>(chemo<span class="sc">$</span>Leukos_t0, chemo<span class="sc">$</span>Leukos_t6, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre class="bordercode"><code>r (rank biserial) |       95% CI
--------------------------------
1.00              | [1.00, 1.00]</code></pre>
<div class="idea">
<p>Die beiden Varianten des Wilcoxon Tests finden in der Praxis häufig zur Beantwortung der gleichen Fragestellungen wie der <em>t</em> Test Anwendung. Die Wilcoxon Tests werden tendenziell bei kleineren Stichproben, gröberen Verletzungen der Voraussetzungen der Normalverteilung und Varianzhomogenität oder bei ordinalem Skalenniveau präferiert. Falls nur die Annahme der Varianzhomogenität verletzt ist, kann alternativ auch der Welch-Test verwendet werden (siehe Kapitel <a href="inductive.html#ttest">9.2.1</a>).</p>
</div>
</div>
</div>
<div id="unterschiede-mehrerer-gruppen" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Unterschiede mehrerer Gruppen<a href="inductive.html#unterschiede-mehrerer-gruppen" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="aov" class="section level3 hasAnchor" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> Varianz- und Kovarianzanalyse<a href="inductive.html#aov" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Für die Funktionen dieses Kapitels müssen die Packages <code>car</code> und <code>effectsize</code> installiert und geladen werden.</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb467-1"><a href="inductive.html#cb467-1" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb467-2"><a href="inductive.html#cb467-2" tabindex="-1"></a><span class="fu">library</span>(effectsize)</span></code></pre></div>
<p>Im Vergleich zum <em>t</em>-Test und Wilcoxon Test der vorherigen Kapitel bietet eine Varianzanalyse drei Vorteile:</p>
<ol style="list-style-type: decimal">
<li>Es können mehr als zwei Gruppen betrachtet werden.</li>
<li>Mehr als eine unabhängige Variable kann in das Modell eingeschlossen werden.</li>
<li>Interaktionsterme zwischen den unabhängigen Variablen können geschätzt werden.</li>
</ol>
<p>Ansonsten setzen wir auch hier eine Normalverteilung der intervallskalierten Merkmale und Varianzhomogenität voraus (siehe Kapitel <a href="inductive.html#voraussetzung">9.7</a>). Im Kontext der Varianzanalyse testen wir die Nullhypothese, ob alle Mittelwerte gleich sind, gegen die Alternativhypothese mindestens eines statistisch signifikant abweichenden Mittelwertes.</p>
<p>Wir möchten im Folgenden untersuchen, inwiefern sich die Leukozytenanzahl nach sechs Monaten Behandlung zwischen den drei Behandlungsarten und den biologischen Geschlechtern unterscheidet. Die zu überprüfende Nullhypothese des Faktors Behandlung ist demnach die Gleichheit der Mittelwerte der PatientInnen mit Radiochemotherapie, Chemotherapie oder Radiotherapie. Falls auch nur für eine dieser Gruppen ein nennenswert unterschiedlicher Mittelwert in unserer Stichprobe geschätzt wird, könnten wir bereits einen signifikanten <em>p</em>-Wert dieses Haupteffektes in der Varianzanalyse erhalten.</p>
<p>Die Berechnung einer Varianzanalyse besteht in R aus zwei Schritten. Zunächst muss das Modell mit der Funktion <code>aov()</code> aufgestellt werden (Akronym für <strong>a</strong>nalysis <strong>o</strong>f <strong>v</strong>ariances, engl. für Varianzanalyse). Auf der linken Seite der Tilde steht dabei die abhängige Variable und auf der rechten Seite in diesem Fall unsere beiden unabhängigen Variablen, getrennt von einem Pluszeichen. Interaktionseffekte könnte man in das Modell mit einem zusätzlichen Term mit Doppelpunkt hinzufügen. Eine Interaktion (auch Moderation genannt) zwischen den Variablen Behandlung und Geschlecht würde man demnach mit <code>Behandlung:Geschlecht</code> erhalten. Im Rahmen von Kovarianzanalysen wird dieses Konzept später im Kapitel praktisch angewendet.</p>
<p>Das Ausgeben der Ergebnisse erfolgt mit der Funktion <code>Anova()</code> aus dem <code>car</code> Package. Andere Statistikprogramme wie SPSS geben standardmäßig die Typ 3 Quadratsummen aus, weswegen auch wir uns mit dem Argument <code>type</code> dafür entscheiden. Alternativ könnten über dieses Argument ebenfalls die Typ 2 Quadratsummen berechnet werden. Typ 1 Quadratsummen erhält man, indem man das Ergebnis von <code>aov()</code> der Funktion <code>summary()</code> übergibt (z.B. <code>summary(result)</code>).</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb468-1"><a href="inductive.html#cb468-1" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">aov</span>(Leukos_t6 <span class="sc">~</span> Behandlung <span class="sc">+</span> Geschlecht, <span class="at">data =</span> chemo)</span>
<span id="cb468-2"><a href="inductive.html#cb468-2" tabindex="-1"></a>res_aov <span class="ot">&lt;-</span> <span class="fu">Anova</span>(result, <span class="at">type =</span> <span class="dv">3</span>)</span>
<span id="cb468-3"><a href="inductive.html#cb468-3" tabindex="-1"></a>res_aov</span></code></pre></div>
<pre class="bordercode"><code>Anova Table (Type III tests)

Response: Leukos_t6
            Sum Sq  Df    F value  Pr(&gt;F)    
(Intercept) 4225.0   1 39004.9324 &lt; 2e-16 ***
Behandlung     0.8   2     3.7144 0.02513 *  
Geschlecht     0.2   1     2.1527 0.14302    
Residuals     48.3 446                       
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>In der Ergebnisliste erhalten wir Informationen über die Quadratsummen (<code>Sum Sq</code>), Freheitsgrade (<code>df</code>) und die Teststatistik in Form des <em>F</em>-Wertes mit entsprechenden <em>p</em>-Wert. Daraus können wir schließen, dass unsere Daten bei einem üblichen <span class="math inline">\(\alpha\)</span>-Niveau von 5% keinen nennenswerten Unterschied zwischen den biologischen Geschlechtern in Hinblick auf die Leukozytenzahl nach sechs Monaten Therapie zeigen (da 0.14302 größer als 0.05). Bei der Behandlungsart sieht es anders aus. Weil wir hier einen <em>p</em>-Wert von 0.02513 geschätzt haben und dieser kleiner als 0.05 ist, weicht mindestens eine mittleren Leukozytenzahlen der Gruppen statistisch signifikant von den anderen ab.</p>
<p>Ob der Unterschied nun zwischen Radiochemotherapie und Chemotherapie, Radiochemotherapie und Radiotherapie oder Chemotherapie und Radiotherapie besteht, können wir aus diesem Ergebnis noch nicht ableiten. Für die genaue Untersuchung des Haupteffekts Behandlungsgruppe verwenden wir an dieser Stelle einen sogenannten Post-hoc Test nach Tukey, welcher innerhalb von R durch die Funktion <code>TukeyHSD()</code> implementiert ist (Akronym für <strong>H</strong>onest <strong>S</strong>ignificant <strong>D</strong>ifferences).</p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb470-1"><a href="inductive.html#cb470-1" tabindex="-1"></a><span class="fu">TukeyHSD</span>(result, <span class="st">&quot;Behandlung&quot;</span>)</span></code></pre></div>
<pre class="bordercode"><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = Leukos_t6 ~ Behandlung + Geschlecht, data = chemo)

$Behandlung
                        diff        lwr         upr     p adj
Chemo-Radiochemo -0.03151523 -0.1207342  0.05770374 0.6841799
Radio-Radiochemo -0.10123872 -0.1906078 -0.01186968 0.0217816
Radio-Chemo      -0.06972349 -0.1592404  0.01979339 0.1604867</code></pre>
<p>Ausgeben wird eine Tabelle mit der Mittelwertsdifferenz aller Gruppenunterschiede (<code>diff</code>) mit 95% Konfidenzintervall (<code>lwr</code>, <code>upr</code>) und korrigierten <em>p</em>-Wert. Der Haupteffekt ist in der Varianzanalyse folglich aufgrund des Unterschiedes in der Leukoyztenzahl zwischen Radiochemotherapie und Radiotherapie entstanden. Die Leukozyten sind in der Gruppe mit reiner Bestrahlung (Radiotherapie) geringer als bei der Kombinationstherapie mit einem statistisch signifikanten <em>p</em>-Wert (da 0.022 kleiner 0.05).</p>
<p>Eine Alternative dazu stellen paarweise <em>t</em> Tests dar, welche jeweils die Mittelwerte der Behandlungsgruppen vergleichen und für jede Kombination einen <em>p</em>-Wert zurückgibt. Da wir an dieser Stelle mehrfach Hypothesentests anwenden und es somit zur Inflation des Fehlers 1. Art kommt, wird standardmäßig auch hier der <em>p</em>-Wert korrigiert. Über das <code>p.adjust.method</code>Argument können unter anderem Bonferroni (<code>"bonferroni"</code>), Benjamini-Hochberg (<code>"BH"</code>) oder Holm (“holm”) verwendet werden.</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb472-1"><a href="inductive.html#cb472-1" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(chemo<span class="sc">$</span>Leukos_t6, chemo<span class="sc">$</span>Behandlung, <span class="at">p.adjust.method =</span> <span class="st">&quot;BH&quot;</span>)</span></code></pre></div>
<pre class="bordercode"><code>
    Pairwise comparisons using t tests with pooled SD 

data:  chemo$Leukos_t6 and chemo$Behandlung 

      Radiochemo Chemo
Chemo 0.407      -    
Radio 0.024      0.102

P value adjustment method: BH </code></pre>
<p>Auch hier können wir mit einem <em>p</em>-Wert von 0.024 einen statistisch signifikanten Unterschied zwischen der mittleren Leukozytenzahl bei PatientInnen mit Radiochemotherapie und Radiotherapie erkennen.</p>
<p>Die übliche Effektstärke im Kontext von Varianzanalysen ist das partielle <span class="math inline">\(\eta^2\)</span>, welches Aufschluss über den korrigierten Anteil der Varianzaufklärung der jeweiligen unabhängigen Variable gibt. In R berechnen wir diese mit der Funktion <code>eta_squared()</code> aus dem <code>effectsize</code> Package und setzen das Argument <code>partial</code> auf <code>TRUE</code>.</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb474-1"><a href="inductive.html#cb474-1" tabindex="-1"></a><span class="fu">eta_squared</span>(res_aov, <span class="at">partial =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre class="bordercode"><code># Effect Size for ANOVA (Type III)

Parameter  | Eta2 (partial) |       95% CI
------------------------------------------
Behandlung |           0.02 | [0.00, 1.00]
Geschlecht |       4.80e-03 | [0.00, 1.00]

- One-sided CIs: upper bound fixed at [1.00].</code></pre>
<p>Wir erhalten das partielle <span class="math inline">\(\eta^2\)</span> für beide Haupteffekte. Beachte an dieser Stelle, dass 4.80e-03 die wissenschaftliche Notation für 0.0048 ist.</p>
<p>Die sogenannte Kovarianzanalyse (kurz ANCOVA) korrigiert den Haupteffekt um den Einfluss einer intervallskalierten (metrischen) Kovariate. So könnten wir möglicherweise die Vermutung haben, dass der Einfluss der Behandlungsmethode auf die Leukozytenzahl maßgeblich vom Alter der PatientInnen abhängt. Zum Beispiel könnten die weißen Blutzellen bei älteren Menschen generell niedriger sein. Zur Berücksichtigung der Kovariate fügen wir sie mit einem Pluszeichen ins Modell hinzu.</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb476-1"><a href="inductive.html#cb476-1" tabindex="-1"></a>result2 <span class="ot">&lt;-</span> <span class="fu">aov</span>(Leukos_t6 <span class="sc">~</span> Behandlung <span class="sc">+</span> Alter, <span class="at">data =</span> chemo)</span>
<span id="cb476-2"><a href="inductive.html#cb476-2" tabindex="-1"></a><span class="fu">Anova</span>(result2, <span class="at">type =</span> <span class="dv">3</span>) </span></code></pre></div>
<pre class="bordercode"><code>Anova Table (Type III tests)

Response: Leukos_t6
             Sum Sq  Df   F value  Pr(&gt;F)    
(Intercept) 130.083   1 1208.3795 &lt; 2e-16 ***
Behandlung    0.770   2    3.5743 0.02884 *  
Alter         0.531   1    4.9323 0.02686 *  
Residuals    48.012 446                      
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Sowohl die Behandlungsart als auch das Alter haben einen statistisch signifikanten Einfluss auf die Leukoyztenzahl nach 6 Monaten Behandlung. Interaktionseffekt können wir entweder mit einem Doppelpunkt oder als Kurzform durch einen Asterisk (<code>*</code>) schätzen.</p>
<div class="sourceCode" id="cb478"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb478-1"><a href="inductive.html#cb478-1" tabindex="-1"></a><span class="fu">aov</span>(Leukos_t6 <span class="sc">~</span> Behandlung <span class="sc">+</span> Geschlecht <span class="sc">+</span> Behandlung<span class="sc">:</span>Geschlecht, <span class="at">data =</span> chemo)</span>
<span id="cb478-2"><a href="inductive.html#cb478-2" tabindex="-1"></a><span class="fu">aov</span>(Leukos_t6 <span class="sc">~</span> Behandlung <span class="sc">*</span> Geschlecht, <span class="at">data =</span> chemo)</span></code></pre></div>
<div class="idea">
<p>Die abhängige Variable muss bei der Varianzanalyse immer intervallskaliert (metrisch) und die unabhängigen Variablen nominal skaliert sein. In der Kovarianzanalyse können wir die Haupteffekte um die Einfluss einer intervallskalierten Kovariate in Form eines Interaktionsterms korrigieren. Die Varianzanalyse ist gegenüber Verletzungen der Voraussetzungen der Normalverteilung und Varianzhomogenität relativ robust. Erst bei gröberen Verletzungen müssen wir auf nicht-parametrische Tests wie dem Kruskal-Wallis Test zurückgreifen (siehe Kapitel <a href="inductive.html#kruskal">9.3.3</a>).</p>
</div>
</div>
<div id="repeated" class="section level3 hasAnchor" number="9.3.2">
<h3><span class="header-section-number">9.3.2</span> Varianzanalyse mit Messwiederholung<a href="inductive.html#repeated" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In diesem Unterkapitel müssen die Packages <code>afex</code> und <code>emmeans</code> installiert und geladen sein.</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb479-1"><a href="inductive.html#cb479-1" tabindex="-1"></a><span class="fu">library</span>(afex)</span>
<span id="cb479-2"><a href="inductive.html#cb479-2" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span></code></pre></div>
<p>Die Varianzanalyse für abhängige Stichproben wird häufig auch als Varianzanalyse mit Messwiederholung bezeichnet (engl. repeated-measures ANOVA). In diesem Falle haben wir, neben den bereits im vorherigen Kapitel untersuchten Zwischensubjektfaktoren (Behandlung und Geschlecht), ebenfalls Innersubjektfaktoren vorliegen. Jede Person wird also mehrfach untersucht. In unserem Beispiel wurde die Leukozytenanzahl bei Therapiebeginn und sechs Monate später erfasst. In diesem Kapitel untersuchen wir, ob sich die mittlere Leukozytenzahl zwischen diesen Zeitpunkten in Abhängigkeit der anderen unabhängigen Variablen unterscheidet.</p>
<p>Bevor wir zur Berechnung kommen, müssen wir den Datensatz zunächst in ein langes Format bringen (siehe Kapitel <a href="datenvorbereitung.html#tidy">6.6</a>).</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb480-1"><a href="inductive.html#cb480-1" tabindex="-1"></a>chemo_long <span class="ot">&lt;-</span> chemo <span class="sc">|&gt;</span> </span>
<span id="cb480-2"><a href="inductive.html#cb480-2" tabindex="-1"></a>  <span class="fu">select</span>(Leukos_t0, Leukos_t6, Geschlecht, Behandlung, Pat_id, Alter) <span class="sc">|&gt;</span> </span>
<span id="cb480-3"><a href="inductive.html#cb480-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb480-4"><a href="inductive.html#cb480-4" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(Leukos_t0, Leukos_t6),</span>
<span id="cb480-5"><a href="inductive.html#cb480-5" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;Leukos&quot;</span>,</span>
<span id="cb480-6"><a href="inductive.html#cb480-6" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;Zeitpunkt&quot;</span></span>
<span id="cb480-7"><a href="inductive.html#cb480-7" tabindex="-1"></a>  )</span>
<span id="cb480-8"><a href="inductive.html#cb480-8" tabindex="-1"></a>chemo_long</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 900 × 6
  Geschlecht Behandlung Pat_id Alter Zeitpunkt Leukos
  &lt;chr&gt;      &lt;fct&gt;       &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;
1 f          Radio           1    49 Leukos_t0   5.74
2 f          Radio           1    49 Leukos_t6   5.68
3 f          Radiochemo      2    46 Leukos_t0   6.71
4 f          Radiochemo      2    46 Leukos_t6   6.64
# ℹ 896 more rows</code></pre>
<p>Anschließend übergeben wir der Funktion <code>aov_4()</code> aus dem <code>afex</code> Package, wie gewohnt, auf der linken Seite der Tilde die abhängige Variable und auf der rechten Seite der Tilde die unabhängigen Variablen. Innerhalb runder Klammern werden die Innersubjektfaktoren (hier <code>Zeitpunkt</code>) definiert, gegeben (<code>|</code>) des Personenidentifikators (hier <code>Pat_id</code>). Die Ziffer 4 befindet sich im Funktionsnamen, weil die verwendete Formelschreibweise auf dem <code>lme4</code> Package basiert, was uns an dieser Stelle nicht weiter interessieren muss. Zusätzlich können wir mit dem Argument <code>anova_table()</code> innerhalb einer Liste diverse Anpassungen vornehmen. Hier verändern wir die Effektstärke zum partiellen <span class="math inline">\(\eta^2\)</span>. Standardmäßig wird ansonsten das generalisierte <span class="math inline">\(\eta^2\)</span> berechnet, welches die explizite Definition der beobachteten Variablen mithilfe des <code>observed</code> Arguments benötigt. Also alle Variablen, die wir nicht experimentell verändert haben (in unserem Fall das Geschlecht).</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb482-1"><a href="inductive.html#cb482-1" tabindex="-1"></a>result3 <span class="ot">&lt;-</span> <span class="fu">aov_4</span>(</span>
<span id="cb482-2"><a href="inductive.html#cb482-2" tabindex="-1"></a>  <span class="at">formula =</span> Leukos <span class="sc">~</span> Behandlung <span class="sc">+</span> Geschlecht <span class="sc">+</span> (Zeitpunkt <span class="sc">|</span> Pat_id), </span>
<span id="cb482-3"><a href="inductive.html#cb482-3" tabindex="-1"></a>  <span class="at">data =</span> chemo_long,</span>
<span id="cb482-4"><a href="inductive.html#cb482-4" tabindex="-1"></a>  <span class="at">anova_table =</span> <span class="fu">list</span>(<span class="at">es =</span> <span class="st">&quot;pes&quot;</span>)</span>
<span id="cb482-5"><a href="inductive.html#cb482-5" tabindex="-1"></a>)</span>
<span id="cb482-6"><a href="inductive.html#cb482-6" tabindex="-1"></a>result3</span></code></pre></div>
<pre class="bordercode"><code>Anova Table (Type 3 tests)

Response: Leukos
                Effect     df  MSE            F  pes p.value
1           Behandlung 2, 446 0.22       3.70 * .016    .026
2           Geschlecht 1, 446 0.22         2.18 .005    .141
3            Zeitpunkt 1, 446 0.00 63467.03 *** .993   &lt;.001
4 Behandlung:Zeitpunkt 2, 446 0.00         0.43 .002    .651
5 Geschlecht:Zeitpunkt 1, 446 0.00       3.72 + .008    .054
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;+&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Die Ergebnisse der Zwischensubjektfaktoren <code>Behandlung</code> und <code>Geschlecht</code> sind in etwa wie im vorherigen Kapitel bei der Varianzanalyse für unabhängige Stichproben. Der Innersubjektfaktor <code>Zeitpunkt</code> zeigt einen statistisch signifikanten mit <em>p</em>-Wert kleiner als 001 und somit kleiner als 0.05. Insbesondere auch die Interaktion zwischen Behandlung und Zeitpunkt interessant, welche die Veränderung über die Zeit zwischen den Behandlungsarten modelliert. Ein nicht statistisch signifikanter <em>p</em>-Wert von 0.651 weist daraufhin, dass die Unterschiede zwischen den Behandlungen in Bezug auf die Leukozytenzahl keinen Effekt über die Zeit aufweist.</p>
<p>Die Werte ohne Rundung würden wir mit <code>summary(result3)</code> erhalten. Bei mehr als zwei Stufen des Innersubjektfaktors gibt, würde <code>summary(result3)</code> die Ergebnisse ohne Korrektur, mit Greenhouse-Geisser Korrektur und Hyunh-Feldt Korrektur sowie das Ergebnis des Mauchly Tests für Sphärizität ausgeben. Da wir hier nur zwei Messzeitpunkte vorliegen haben, erhalten wir nur die Schätzwerte der Varianzanalyse.</p>
<p>Als Post-hoc Test schätzen wir die Randmittel mithilfe der Funktion <code>emmeans()</code> aus dem gleichnamigen Package (Akronym für <strong>e</strong>stimated <strong>m</strong>arginal <strong>means</strong>, engl. für geschätzte Randmittelwerte). Neben dem Ergebnis der Varianzanalyse müssen wir der Funktion zusätzlich die zu untersuchende Gruppe nachfolgend an eine Tilde übergeben.</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb484-1"><a href="inductive.html#cb484-1" tabindex="-1"></a>post_aov <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(result3, <span class="sc">~</span> Behandlung)</span>
<span id="cb484-2"><a href="inductive.html#cb484-2" tabindex="-1"></a>post_aov</span></code></pre></div>
<pre class="bordercode"><code> Behandlung emmean     SE  df lower.CL upper.CL
 Radiochemo   6.05 0.0269 446     6.00     6.10
 Chemo        6.02 0.0270 446     5.97     6.07
 Radio        5.95 0.0271 446     5.90     6.00

Results are averaged over the levels of: Geschlecht, Zeitpunkt 
Confidence level used: 0.95 </code></pre>
<p>Um die unterschiedlichen Mittelwerte durch Hypothesentests miteinander zu vergleichen, verwenden wir an dieser Stelle die Funktion <code>pairs()</code>. Das Ergebnis entspricht dabei dem des vorherigen Kapitel, da <code>Behandlung</code> als Zwischensubjektfaktor auch im Kontext einer Varianzanalyse für unabhängige Stichproben adäquat analysiert werden kann.</p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb486-1"><a href="inductive.html#cb486-1" tabindex="-1"></a><span class="fu">pairs</span>(post_aov)</span></code></pre></div>
<pre class="bordercode"><code> contrast           estimate     SE  df t.ratio p.value
 Radiochemo - Chemo   0.0315 0.0381 446   0.827  0.6868
 Radiochemo - Radio   0.1015 0.0382 446   2.659  0.0221
 Chemo - Radio        0.0700 0.0382 446   1.831  0.1607

Results are averaged over the levels of: Geschlecht, Zeitpunkt 
P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
<p>Die Funktion <code>emmeans()</code> erlaubt es auch, die Behandlungsarten nach Zeitpunkt oder Geschlecht weiter aufzutrennen. Dabei müssen die einzelnen Faktoren mit einem Pluszeichen voneinander getrennt werden. Auch hier könnte man Hypothesentests mithilfe der <code>pairs()</code> Funktion durchführen.</p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb488-1"><a href="inductive.html#cb488-1" tabindex="-1"></a><span class="fu">emmeans</span>(result3, <span class="sc">~</span> Behandlung <span class="sc">+</span> Zeitpunkt)</span></code></pre></div>
<pre class="bordercode"><code> Behandlung Zeitpunkt emmean     SE  df lower.CL upper.CL
 Radiochemo Leukos_t0   6.08 0.0270 446     6.03     6.13
 Chemo      Leukos_t0   6.05 0.0271 446     6.00     6.10
 Radio      Leukos_t0   5.98 0.0272 446     5.93     6.03
 Radiochemo Leukos_t6   6.02 0.0268 446     5.97     6.07
 Chemo      Leukos_t6   5.99 0.0269 446     5.94     6.04
 Radio      Leukos_t6   5.92 0.0270 446     5.87     5.97

Results are averaged over the levels of: Geschlecht 
Confidence level used: 0.95 </code></pre>
<p>Alle unabhängigen Variablen werden von der Funktion <code>aov_4()</code> standardmäßig als nominale Merkmale angenommen und daher als Faktor umgewandelt, falls diese einen anderen Datentyp haben. Im Falle einer Kovarianzanalyse mit Messwiederholung würde somit ebenfalls die intervallskalierte Kovariate als Faktor formatiert, was keinen Sinn ergibt und in einem Fehler endet. Bei einer Kovarianzanalyse müssen folglich Faktoren im Voraus erstellt werden. In unserem Beispiel ist die Spalte <code>Behandlung</code> zwar bereits ein Faktor, zur besseren Übersicht wird die Umwandlung an dieser Stelle explizit gezeigt (siehe Kapitel <a href="datenvorbereitung.html#mutate">6.4</a> und <a href="datenvorbereitung.html#datafactor">6.10</a>). Die Kovariate (hier <code>Alter</code>) sollte darüber hinaus standardisiert werden.</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb490-1"><a href="inductive.html#cb490-1" tabindex="-1"></a>chemo_long1 <span class="ot">&lt;-</span> chemo_long <span class="sc">|&gt;</span> </span>
<span id="cb490-2"><a href="inductive.html#cb490-2" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb490-3"><a href="inductive.html#cb490-3" tabindex="-1"></a>    <span class="at">Behandlung =</span> <span class="fu">factor</span>(Behandlung, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Radiochemo&quot;</span>, <span class="st">&quot;Chemo&quot;</span>, <span class="st">&quot;Radio&quot;</span>)),</span>
<span id="cb490-4"><a href="inductive.html#cb490-4" tabindex="-1"></a>    <span class="at">Alter =</span> <span class="fu">as.numeric</span>(<span class="fu">scale</span>(Alter))</span>
<span id="cb490-5"><a href="inductive.html#cb490-5" tabindex="-1"></a>  )</span></code></pre></div>
<p>In der Funktion <code>aov_4()</code> setzen wir nun zusätzlich das Argument <code>factorize</code> auf <code>FALSE</code>, um die automatische Umwandlung der Kovariate <code>Alter</code> in einen Faktor zu verhindern.</p>
<div class="sourceCode" id="cb491"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb491-1"><a href="inductive.html#cb491-1" tabindex="-1"></a><span class="fu">aov_4</span>(</span>
<span id="cb491-2"><a href="inductive.html#cb491-2" tabindex="-1"></a>  <span class="at">formula =</span> Leukos <span class="sc">~</span> Behandlung <span class="sc">+</span> Alter <span class="sc">+</span> (Zeitpunkt <span class="sc">|</span> Pat_id), </span>
<span id="cb491-3"><a href="inductive.html#cb491-3" tabindex="-1"></a>  <span class="at">data =</span> chemo_long1, </span>
<span id="cb491-4"><a href="inductive.html#cb491-4" tabindex="-1"></a>  <span class="at">anova_table =</span> <span class="fu">list</span>(<span class="at">es =</span> <span class="st">&quot;pes&quot;</span>),</span>
<span id="cb491-5"><a href="inductive.html#cb491-5" tabindex="-1"></a>  <span class="at">factorize =</span> <span class="cn">FALSE</span></span>
<span id="cb491-6"><a href="inductive.html#cb491-6" tabindex="-1"></a>)</span></code></pre></div>
<pre class="bordercode"><code>Anova Table (Type 3 tests)

Response: Leukos
                Effect     df  MSE            F  pes p.value
1           Behandlung 2, 446 0.22       3.56 * .016    .029
2                Alter 1, 446 0.22       4.93 * .011    .027
3            Zeitpunkt 1, 446 0.00 63370.93 *** .993   &lt;.001
4 Behandlung:Zeitpunkt 2, 446 0.00         0.41 .002    .664
5      Alter:Zeitpunkt 1, 446 0.00         1.85 .004    .175
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;+&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="idea">
<p>Neben Normalverteilung und Varianzhomogenität müssen wir bei Varianzanalysen für abhängige Stichproben mit mehr als zwei Stufen des Innersubjektfaktors (z.B. drei Messzeitpunkte) ebenfalls die Sphärizität überprüfen. Das Vorliegen der Sphärizität wird automatisch von <code>aov_4()</code> getestet und mit entsprechenden Korrekturen zurückgegeben. Falls zu grobe Verletzungen dieser drei Annahmen vorliegen, können wir auf nicht-parametrische Verfahren wie den Friedman Test wechseln (siehe Kapitel <a href="inductive.html#friedman">9.3.4</a>).</p>
</div>
</div>
<div id="kruskal" class="section level3 hasAnchor" number="9.3.3">
<h3><span class="header-section-number">9.3.3</span> Welch Approximation und Kruskal-Wallis Test<a href="inductive.html#kruskal" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Beide in diesem Unterkapitel vorgestellte statistische Tests sind Alternativen für eine Varianzanalyse bei vermuteter grober Verletzungen der Annahmen über Normalverteilung und Varianzhomogenität, welche allerdings auf eine unabhängige Variable limitiert sind.</p>
<p>Falls die Voraussetzung der Normalverteilung erfüllt ist, aber keine Varianzhomogenität besteht, kann die Welch Approximation der Varianzanalyse verwendet werden. Dieser kann als Generalisierung des in Kapitel <a href="inductive.html#ttest">9.2.1</a> kennengelernten t-Tests mit Welch Korrektur verstanden werden. Die Verallgemeinerung bezieht sich hierbei auf die Anwendung bei mehr als zwei Gruppen (hier z.B. drei Behandlungsarten). In R ist diese Methode innerhalb der Funktion <code>oneway.test()</code> implementiert. Wir erhalten hier ein sehr ähnliches Ergebnis zu der Varianzanalyse aus Kapitel <a href="inductive.html#aov">9.3.1</a>, da in unserem Beispiel des <code>chemo</code> Datensatzes sowohl Normalverteilung als auch Varianzhomogenität vorliegt (siehe Kapitel <a href="inductive.html#voraussetzung">9.7</a>).</p>
<div class="sourceCode" id="cb493"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb493-1"><a href="inductive.html#cb493-1" tabindex="-1"></a><span class="fu">oneway.test</span>(Leukos_t6 <span class="sc">~</span> Behandlung, <span class="at">data =</span> chemo)</span></code></pre></div>
<pre class="bordercode"><code>
    One-way analysis of means (not assuming equal variances)

data:  Leukos_t6 and Behandlung
F = 3.8224, num df = 2.00, denom df = 297.59, p-value = 0.02296</code></pre>
<p>Im Falle einer Verletzung der Annahme von Normalverteilung <strong>und</strong> Varianzhomogenität greifen wir stattdessen auf den Kruskal-Wallis Test zurück, der durch die Funktion <code>kruskal.test()</code> in R enthalten ist. Auch hier kriegen wir ein ähnliches Ergebnis zu der Varianzanalyse ausgegeben.</p>
<div class="sourceCode" id="cb495"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb495-1"><a href="inductive.html#cb495-1" tabindex="-1"></a><span class="fu">kruskal.test</span>(Leukos_t6 <span class="sc">~</span> Behandlung, <span class="at">data =</span> chemo)</span></code></pre></div>
<pre class="bordercode"><code>
    Kruskal-Wallis rank sum test

data:  Leukos_t6 by Behandlung
Kruskal-Wallis chi-squared = 5.9832, df = 2, p-value = 0.05021</code></pre>
<div class="idea">
<p>Beide Verfahren bieten eine Alternative zur klassischen Varianzanalyse bei Verletzung der Annahmen von Normalverteilung und/oder Varianzhomogenität. Beachte hierbei, dass nur eine unabhängige, nominal skalierte Variable in Hinblick eines möglichen Einflusses auf ein intervallskaliertes Merkmal untersucht werden kann.</p>
</div>
</div>
<div id="friedman" class="section level3 hasAnchor" number="9.3.4">
<h3><span class="header-section-number">9.3.4</span> Friedman Test<a href="inductive.html#friedman" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Eine nicht-parametrische Alternative zur Varianzanalyse für abhängige Stichproben bei Verletzungen von Annahmen der Normalverteilung, Varianzhomogenität oder Sphärizität stellt der Friedman Test dar. Dieses Verfahren hat die Einschränkung, nur den Innersubjektfaktor einzeln untersuchen zu können.</p>
<p>Da auch hier häufig eine Messwiederholung die interessierende nominale unabhängige Variable darstellt, müssen wir zunächst den Datensatz in ein langes Format bringen (siehe Kapitel <a href="datenvorbereitung.html#tidy">6.6</a>).</p>
<div class="sourceCode" id="cb497"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb497-1"><a href="inductive.html#cb497-1" tabindex="-1"></a>chemo_long <span class="ot">&lt;-</span> chemo <span class="sc">|&gt;</span> </span>
<span id="cb497-2"><a href="inductive.html#cb497-2" tabindex="-1"></a>  <span class="fu">select</span>(Leukos_t0, Leukos_t6, Geschlecht, Behandlung, Pat_id) <span class="sc">|&gt;</span> </span>
<span id="cb497-3"><a href="inductive.html#cb497-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb497-4"><a href="inductive.html#cb497-4" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(Leukos_t0, Leukos_t6),</span>
<span id="cb497-5"><a href="inductive.html#cb497-5" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;Leukos&quot;</span>,</span>
<span id="cb497-6"><a href="inductive.html#cb497-6" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;Zeitpunkt&quot;</span></span>
<span id="cb497-7"><a href="inductive.html#cb497-7" tabindex="-1"></a>  )</span>
<span id="cb497-8"><a href="inductive.html#cb497-8" tabindex="-1"></a>chemo_long</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 900 × 5
  Geschlecht Behandlung Pat_id Zeitpunkt Leukos
  &lt;chr&gt;      &lt;fct&gt;       &lt;int&gt; &lt;chr&gt;      &lt;dbl&gt;
1 f          Radio           1 Leukos_t0   5.74
2 f          Radio           1 Leukos_t6   5.68
3 f          Radiochemo      2 Leukos_t0   6.71
4 f          Radiochemo      2 Leukos_t6   6.64
# ℹ 896 more rows</code></pre>
<p>Die Schreibweise unterscheidet sich nur insofern von der Varianzanalyse mit Messwiederholung aus Kapitel <a href="inductive.html#repeated">9.3.2</a>, als dass wir keine Klammern um den Messwiederholungsterm auf der rechten Seite der Tilde schreiben. Getrennt sind Innersubjektfaktor und Personenidentifikator durch einen vertikalen Strich.</p>
<div class="sourceCode" id="cb499"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb499-1"><a href="inductive.html#cb499-1" tabindex="-1"></a><span class="fu">friedman.test</span>(Leukos <span class="sc">~</span> Zeitpunkt <span class="sc">|</span> Pat_id, <span class="at">data =</span> chemo_long)</span></code></pre></div>
<pre class="bordercode"><code>
    Friedman rank sum test

data:  Leukos and Zeitpunkt and Pat_id
Friedman chi-squared = 450, df = 1, p-value &lt; 2.2e-16</code></pre>
<p>Die Ausgabe zeigt auch hier ein statistisch signifikantes Ergebnis. Die Leukozytenanzahl unterscheidet sich demnach zwischen dem Therapiebeginn und nach sechs Monaten Behandlung nennenswert.</p>
</div>
</div>
<div id="cortest" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> Korrelationsanalysen<a href="inductive.html#cortest" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="pearsoncor" class="section level3 hasAnchor" number="9.4.1">
<h3><span class="header-section-number">9.4.1</span> Produkt-Moment Korrelation<a href="inductive.html#pearsoncor" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Bereits in Kapitel <a href="descr.html#cor">7.3</a> haben wir Korrelationen in Form im Kontext der deskriptiven Statistik als Zusammenhangsmaße berechnet. Wir können allerdings auch die Nullhypothese eines nicht vorhandenen Zusammenhangs (Korrelation von 0) gegen die Alternativhypothese eines bestehenden Zusammenhangs prüfen. Die Funktion für diese Hypothesentests heißt in R <code>cor.test()</code>.</p>
<p>Für die Produkt-Moment Korrelation nach Pearson können wir dem <code>method</code> Argument <code>“pearson”</code> übergeben. Wir müssen allerdings nicht, da dies die Standardeinstellung der Funktion darstellt. Mit der Produkt-Moment Korrelation vergleichen wir zwei intervallskalierte Merkmale miteinander. An dieser Stelle möchten wir herausfinden, ob es einen Zusammenhang zwischen der Leukoszytenanzahl nach sechs Monaten Behandlung und dem Alter gibt. Die Merkmale übergeben wir dabei als Vektoren (bzw. Wertereihen) mithilfe des Dollar-Operators (siehe Kapitel <a href="vars.html#dollar">4.5</a>).</p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb501-1"><a href="inductive.html#cb501-1" tabindex="-1"></a><span class="fu">cor.test</span>(chemo<span class="sc">$</span>Leukos_t6, chemo<span class="sc">$</span>Alter, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre class="bordercode"><code>
    Pearson&#39;s product-moment correlation

data:  chemo$Leukos_t6 and chemo$Alter
t = 2.2785, df = 448, p-value = 0.02317
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.01473737 0.19751435
sample estimates:
    cor 
0.10703 </code></pre>
<p>Die Ausgabe enthält die Teststatistik in Form eines <em>t</em>-Wertes mit Freiheitsgraden und entsprechendem statistisch signifikanten <em>p</em>-Wert, welcher mit 0.02317 kleiner als das in der Wissenschaft übliche <span class="math inline">\(\alpha\)</span>-Niveau von 0.05 ist. Außerdem wird die Korrelation in Höhe von 0.10703 mit 95% Konfidenzintervall ausgegeben. Je älter die PatientInnen sind, desto mehr Leukozyten haben wir nach sechs Monaten in unserer Stichprobe gemessen (positive Korrelation). Vielleicht haben die Behandlungen eine einschneidenere Auswirkung auf das Immunsystem jüngerer PatientInnen. Das ist allerdings reine Mutmaßung, da ein vorhandener Zusammenhang nicht zwingend auch eine Kausalität bedeutet.</p>
<p>Ein Sonderfall der Pearson Korrelation ist die Punkt-biseriale Korrelation, welche den Zusammenhang zwischen einem intervallskaliertes Merkmal und einem nominalen Merkmal mit zwei Ausprägungen quantifiziert. Hierfür müssen wir zunächst die Inhalte der Spalte Geschlecht in Zahlen umwandeln (siehe Kapitel <a href="datenvorbereitung.html#helfer">6.4.3</a>). In diesem Fall steht eine 1 für weiblich und eine 0 für männlich.</p>
<div class="sourceCode" id="cb503"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb503-1"><a href="inductive.html#cb503-1" tabindex="-1"></a>chemo1 <span class="ot">&lt;-</span> chemo <span class="sc">|&gt;</span> </span>
<span id="cb503-2"><a href="inductive.html#cb503-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Geschlecht =</span> <span class="fu">case_match</span>(Geschlecht, <span class="st">&quot;f&quot;</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="st">&quot;m&quot;</span> <span class="sc">~</span> <span class="dv">0</span>))</span></code></pre></div>
<p>Anschließend übergeben wir die beiden Spalten auf dieselbe Art und Weise wie zuvor der Funktion <code>cor.test()</code>.</p>
<div class="sourceCode" id="cb504"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb504-1"><a href="inductive.html#cb504-1" tabindex="-1"></a><span class="fu">cor.test</span>(chemo1<span class="sc">$</span>Leukos_t6, chemo1<span class="sc">$</span>Geschlecht, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre class="bordercode"><code>
    Pearson&#39;s product-moment correlation

data:  chemo1$Leukos_t6 and chemo1$Geschlecht
t = 1.456, df = 448, p-value = 0.1461
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.02396547  0.16004821
sample estimates:
       cor 
0.06862502 </code></pre>
<p>Als Ergebnis erhalten wir eine Korrelation in Höhe von 0.07, die nicht statistisch signifikant von 0 abweicht, da der <em>p</em>-Wert mit 0.1461 größer als 0.05 ist. Dies stimmt mit den Ergebnissen des <em>t</em> Tests aus Kapitel <a href="inductive.html#ttest">9.2.1</a> überein, indem wir keinen Unterschied zwischen den Geschlechtern in Bezug auf die Leukozytenanzahl finden konnten.</p>
<div class="idea">
<p>Die Produkt-Moment Korrelation quantifiziert den Zusammenhang zwischen zwei intervallskalierten Merkmalen. Falls ordinales Skalenniveau vorliegt, muss stattdessen auf Rangkorrelation zurückgegriffen werden.</p>
</div>
</div>
<div id="rangcor" class="section level3 hasAnchor" number="9.4.2">
<h3><span class="header-section-number">9.4.2</span> Rangkorrelationen<a href="inductive.html#rangcor" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Bei Vorliegen zweier ordinaler Merkmale können wir nicht-parametrischen Rangkorrelationen verwenden. Eine weit verbreitete Methode dafür ist die Rangkorrelation nach Spearman. Im Vergleich zum vorherigen Kapitel verändert sich lediglich das <code>method</code> Argument. Die Merkmale müssen auch hier in Form von Vektoren (bzw. Wertereihen) mithilfe des Dollar-Operators aus dem Datensatz extrahiert werden (siehe Kapitel <a href="vars.html#dollar">4.5</a>).</p>
<p>Wir möchten an dieser Stelle untersuchen, ob das subjektive Schmerzausmaß der PatientInnen mit der empfundenen Lebensqualität zusammenhängt. Beide Merkmale sind durch einen Fragebogen mit zehn Stufen erhoben worden. Auf der Schmerzskala entspricht eine 1 keinen und eine 10 unerträglichen Schmerzen. Bei der Lebensqualität steht eine 1 für unzumutbare Einschränkungen und eine 10 für uneingeschränktes Glück. Die Nullhypothese ist auch bei der Rangkorrelation ein fehlender Zusammenhang, während die Alternativhypothese eine Korrelation ungleich 0 beschreibt.</p>
<div class="sourceCode" id="cb506"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb506-1"><a href="inductive.html#cb506-1" tabindex="-1"></a><span class="fu">cor.test</span>(chemo<span class="sc">$</span>Schmerzen, chemo<span class="sc">$</span>Lebensqualitaet, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
<pre class="bordercode"><code>Warning in cor.test.default(chemo$Schmerzen, chemo$Lebensqualitaet, method = &quot;spearman&quot;):
Cannot compute exact p-value with ties</code></pre>
<pre class="bordercode"><code>
    Spearman&#39;s rank correlation rho

data:  chemo$Schmerzen and chemo$Lebensqualitaet
S = 23595117, p-value &lt; 2.2e-16
alternative hypothesis: true rho is not equal to 0
sample estimates:
       rho 
-0.5535956 </code></pre>
<p>Die Rangkorrelation nach Spearman wird als <span class="math inline">\(\rho\)</span> (rho) bezeichnet. In der Ausgabe sehen wir eine statistisch signifikante Abweichung der Korrelation von 0, da ein <em>p</em>-Wert von 2.2e-16 die wissenschaftliche Notation für 0.00000000000000022 darstellt und somit deutlich kleiner als das übliche <span class="math inline">\(\alpha\)</span>-Niveau von 0.05 ist. Wir finden eine negative Korrelation von -0.55 vor. Je mehr Schmerzen die PatientInnen haben, desto geringer ist ihre Lebensqualität in unserer Stichprobe. Umgekehrt, je höher die Lebensqualität ist, desto niedriger die Schmerzen. Auch hier muss bei kausalen Schlussfolgerungen Vorsicht geboten werden, weil Korrelationskoeffizienten lediglich Zusammenhänge quantifizieren.</p>
<p>Zusätzlich erhalten wir eine Warnmeldung, dass sogenannte <em>Ties</em> vorliegen. Ties beschreiben im Kontext von Rangreihungen mehrere Beobachtungen mit demselben Rang. In diesem Fall ist die Berechnung der Kendall-Korrelation angemessener, wofür wir lediglich das <code>method</code> Argument entsprechend anpassen müssen.</p>
<div class="sourceCode" id="cb509"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb509-1"><a href="inductive.html#cb509-1" tabindex="-1"></a><span class="fu">cor.test</span>(chemo<span class="sc">$</span>Schmerzen, chemo<span class="sc">$</span>Lebensqualitaet, <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)</span></code></pre></div>
<pre class="bordercode"><code>
    Kendall&#39;s rank correlation tau

data:  chemo$Schmerzen and chemo$Lebensqualitaet
z = -12.197, p-value &lt; 2.2e-16
alternative hypothesis: true tau is not equal to 0
sample estimates:
       tau 
-0.4351842 </code></pre>
<p>Die Höhe des negativen Zusammenhangs ist hier mit -0.44 etwas kleiner, aber ebenfalls statistisch signifikant von 0 abweichend.</p>
</div>
</div>
<div id="regression" class="section level2 hasAnchor" number="9.5">
<h2><span class="header-section-number">9.5</span> Regressionsmodelle<a href="inductive.html#regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="linregression" class="section level3 hasAnchor" number="9.5.1">
<h3><span class="header-section-number">9.5.1</span> Lineare Regression<a href="inductive.html#linregression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Lineare Regressionmodelle werden zur Untersuchung des Zusammenhangs zwischen einer intervallskalierten (metrischen) abhängigen Variable und einer bis zu mehreren unabhängigen Variablen verwendet. Der Hauptunterschied zur einfachen Korrelation des vorherigen Kapitels besteht in der Möglichkeit, mehr als einen möglichen Einfluss auf das interessierende Merkmal zu überprüfen. Die unabhängigen Variablen müssen dabei intervallskaliert (z.B. Alter) oder nominal mit zwei Ausprägungsgraden (z.B. Geschlecht) sein. Bei mehr als zwei Ausprägungsgraden müssen wir Faktoren erstellen (siehe Kapitel <a href="vars.html#factor">4.3.2</a> und <a href="datenvorbereitung.html#datafactor">6.10</a>). Dabei sollte man sich immer darüber bewusst sein, welche Faktorstufe die Referenzkategorie darstellt, mit denen man die anderen Faktorstufen vergleicht. Die Referenzkategorie ist immer die erste Faktorstufe.</p>
<p>In R erstellt die Funktion <code>lm()</code> ein lineares Regressionsmodell (Akronym für lineares Modell). Auf der linken Seite der Tilde (<code>~</code>) wird die abhängige Variable und auf der rechten Seite eine oder mehrere unabhängige Variablen der Funktion übergeben. Wir stellen uns an dieser Stelle die Frage eines möglichen Zusammenhangs zwischen der Leukozytenanazahl nach sechs Monaten Behandlung und den unabhängigen Variablen Alter und Geschlecht. Eine Übersicht über die Ergebnisse erhalten wir mit der Funktion <code>summary()</code>.</p>
<div class="sourceCode" id="cb511"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb511-1"><a href="inductive.html#cb511-1" tabindex="-1"></a>res_reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(Leukos_t6 <span class="sc">~</span> Alter <span class="sc">+</span> Geschlecht, <span class="at">data =</span> chemo)</span>
<span id="cb511-2"><a href="inductive.html#cb511-2" tabindex="-1"></a><span class="fu">summary</span>(res_reg)</span></code></pre></div>
<pre class="bordercode"><code>
Call:
lm(formula = Leukos_t6 ~ Alter + Geschlecht, data = chemo)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.92152 -0.23057  0.01753  0.21903  0.87584 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  5.614790   0.162217  34.613   &lt;2e-16 ***
Alter        0.008676   0.003618   2.398   0.0169 *  
Geschlechtm -0.051062   0.031170  -1.638   0.1021    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.3294 on 447 degrees of freedom
Multiple R-squared:  0.01735,   Adjusted R-squared:  0.01296 
F-statistic: 3.947 on 2 and 447 DF,  p-value: 0.01998</code></pre>
<p>In der Ausgabe sehen wir zunächst die Verteilung der Residuen. Darunter sind die <span class="math inline">\(\beta\)</span>-Koeffizienten als <code>estimates</code> für jede Kovariate aufgelistet. Der Intercept (<span class="math inline">\(\beta_0\)</span>) ist entsprechend darüber angegeben. In den nächsten Spalten ist der Standardfehler und der <em>t</em>-Wert mit entsprechendem p-Wert angegeben. Die Teststatistik als <em>t</em>-Wert basiert in diesem Falle auf dem Wald Test, der die Nullhypothese prüft, ob der <span class="math inline">\(\beta\)</span>-Koeffizient der jeweiligen unabhängigen Variable gleich 0 ist (kein Zusammenhang). Die Alternativhypothese ist hier, ein <span class="math inline">\(\beta\)</span>-Koeffizient ungleich 0. Beachte außerdem, dass es sich hierbei um partielle Korrelationen handelt. Der Einfluss der jeweils anderen unabhängigen Variablen auf die abhängige Variable wird dabei herausgerechnet.</p>
<p>Der <span class="math inline">\(\beta\)</span>-Koeffizient der Kovariate Alter weicht statistisch signifikant von 0 ab, da der <em>p</em>-Wert mit 0.0169 kleiner als das übliche <span class="math inline">\(\alpha\)</span>-Niveau von 0.05 ist. Da der <span class="math inline">\(\beta\)</span>-Koeffizient positiv ist, haben wir hier einen positiven Zusammenhang vorliegen: je älter die PatientInnen sind, desto höher ist die Leukozytenanzahl und umgekehrt. Beim Geschlecht finden wir hingegen keinen nennenswerten Einfluss auf die Leukozytenanzahl in unserer Stichprobe (0.1021 ist größer als 0.05). Der <span class="math inline">\(\beta\)</span>-Koeffizient ist negativ, aber welches der Geschlechter hat eine geringer Leukozytenanzahl? Hinter dem Geschlecht ist ein kleines <em>m</em> angehängt, womit R uns sagt, dass das weibliche Geschlecht innerhalb der Funktion mit 0 und das männliche Geschlecht mit 1 kodiert wird. Wenn die Kovariate Geschlecht einen Wert von 1 hat, reduziert sich die Leukozytenanzahl. Folglich ist die Anzahl weißer Blutkörperchen bei Männern nach sechs Monaten Behandlung tendenziell geringer. Allerdings ist dieser Zusammenhang in unserem Fall nicht statistisch signifikant.</p>
<p>Weiter unten in der Ausgabe finden wir noch die Effektstärke der Regressionsanalyse: die Varianzaufklärung in Form des (korrigierten) <span class="math inline">\(R^2\)</span>. Darunter ist das Ergebnis des globalen <em>F</em>-Tests ausgegeben, welcher die Alternativhypothese prüft, ob mindestens einer der <span class="math inline">\(\beta\)</span>-Koeffizienten ungleich 0 ist. Da eine der Kovariaten einen nennenswerten Zusammenhang zeigt mit der Leukozytenanzahl zeigt, finden wir auch hier einen statistisch signifikanten <em>p</em>-Wert vor (0.01998).</p>
<p>Die Voraussetzungen der linearen Regression sind Normalverteilung und Varianzhomogenität der Residuen. Diese lassen sich am einfachsten und besten graphisch überprüfen (siehe Kapitel <a href="visual.html#residuals">8.13.2</a> und <a href="inductive.html#voraussetzung">9.7</a>).</p>
<p>Auch im Kontext von Regression können wir mithilfe eines Doppelpunktes Interaktionsterme zum Modell hinzufügen. Hier schauen wir uns zusätzlich zu den bisherigen Kovariaten ebenfalls die Interaktion zwischen Alter und Geschlecht an. Hier untersuchen wir also, ob der Alterseffekt möglicherweise je nach Geschlecht anders ausgeprägt ist.</p>
<div class="sourceCode" id="cb513"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb513-1"><a href="inductive.html#cb513-1" tabindex="-1"></a>res_reg2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Leukos_t6 <span class="sc">~</span> Alter <span class="sc">+</span> Geschlecht <span class="sc">+</span> Alter<span class="sc">:</span>Geschlecht, <span class="at">data =</span> chemo)</span>
<span id="cb513-2"><a href="inductive.html#cb513-2" tabindex="-1"></a><span class="fu">summary</span>(res_reg2)</span></code></pre></div>
<pre class="bordercode"><code>
Call:
lm(formula = Leukos_t6 ~ Alter + Geschlecht + Alter:Geschlecht, 
    data = chemo)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.9323 -0.2266  0.0190  0.2186  0.8763 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        5.871429   0.229189  25.618   &lt;2e-16 ***
Alter              0.002902   0.005134   0.565   0.5721    
Geschlechtm       -0.562745   0.324841  -1.732   0.0839 .  
Alter:Geschlechtm  0.011431   0.007223   1.582   0.1143    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.3288 on 446 degrees of freedom
Multiple R-squared:  0.02284,   Adjusted R-squared:  0.01627 
F-statistic: 3.475 on 3 and 446 DF,  p-value: 0.01606</code></pre>
<p>Wir können beobachten, dass der Alterseffekt nach Berücksichtigung einer möglichen Interaktion mit dem biologischen Geschlecht nun nicht mehr statistisch signifikant ist. Auch wenn der Interaktionsterm an sich nicht signifikant ist, könnte dies ein Hinweis auf einen gewissen Zusammenhang zwischen Alter und Geschlecht hindeuten.</p>
<p>Falls die nominale unabhängige Variable mehr als zwei Stufen hat, solltest du vor der Analyse einen Faktor daraus machen (siehe Kapitel <a href="datenvorbereitung.html#datafactor">6.10</a>). Definiere dabei explizit, welche Gruppe die Referenz darstellen soll (auch Baseline genannt). Die <span class="math inline">\(\beta\)</span>-Koeffizienten der jeweils anderen Gruppen beziehen sich dann auf Veränderungen im Vergleich zur Referenzgruppe (Stufe 1 des Faktors). An dieser Stelle untersuchen wir mögliche Zusammenhänge zwischen den Behandlungsarten und der Leukozytenanzahl nach sechs Monaten Therapie. Die Referenzgruppe ist in diesem Fall die Behandlung mit Radiochemotherapie.</p>
<div class="sourceCode" id="cb515"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb515-1"><a href="inductive.html#cb515-1" tabindex="-1"></a>res_reg3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Leukos_t6 <span class="sc">~</span> Behandlung, <span class="at">data =</span> chemo) </span>
<span id="cb515-2"><a href="inductive.html#cb515-2" tabindex="-1"></a><span class="fu">summary</span>(res_reg3)</span></code></pre></div>
<pre class="bordercode"><code>
Call:
lm(formula = Leukos_t6 ~ Behandlung, data = chemo)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.9727 -0.2224  0.0088  0.2387  0.8588 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      6.02272    0.02682  224.58  &lt; 2e-16 ***
BehandlungChemo -0.03152    0.03799   -0.83  0.40722    
BehandlungRadio -0.10124    0.03805   -2.66  0.00808 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.3295 on 447 degrees of freedom
Multiple R-squared:  0.01629,   Adjusted R-squared:  0.01189 
F-statistic: 3.701 on 2 and 447 DF,  p-value: 0.02545</code></pre>
<p>Während beide <span class="math inline">\(\beta\)</span>-Koeffizienten negativ sind, ergibt nur der Wald Tests der Gruppe der Radiotherapie einen statistisch signifikanten <em>p</em>-Wert (0.00808 ist kleiner als 0.05). Die Leukoyztenzahl ist folglich sowohl bei alleiniger Chemotherapie als auch alleiniger Radiotherapie kleiner als bei der Kombinationstherapie. Allerdings scheint der Zusammenhang beim Vergleich zwischen Radiochemotherapie und Chemotherapie kleiner ausgeprägt zu sein.</p>
<div class="idea">
<p>Im linearen Regressionsmodell untersuchen wir den Zusammenhang zwischen einer intervallskalierten abhängigen Variable und einer oder mehrerer intervallskalierter oder nominaler unabhängiger Variable. Falls die abhängige Variable nicht intervallskaliert ist, müssen wir auf ein anderes Regressionsmodell zurückgreifen.</p>
</div>
</div>
<div id="logistische-regression" class="section level3 hasAnchor" number="9.5.2">
<h3><span class="header-section-number">9.5.2</span> Logistische Regression<a href="inductive.html#logistische-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Logistische Regression verwenden wir zur Untersuchung einer abhängigen Variablen mit nominalem Skalenniveau mit zwei Ausprägungsgraden (0 und 1), die aus einer Binomialverteilung stammen (Synonym: Binomiales Logit Modell).</p>
<p>In R trägt die Funktion zur Modellierung einer logistischen Regression den Namen <code>glm()</code> (Akronym für generalisiertes lineares Modell). Wir möchten an dieser Stelle die Frage beantworten, ob das biologische Geschlecht und die Infektionshäufigkeit innerhalb von zwei Jahren einen Zusammenhang mit dem stationären Aufenthalt aufweist. Die abhängige Variable des stationären Aufenthalts (<code>Stationaer</code>) beinhaltet die Information, ob jemand im Beobachtungszeitraum einen Krankenhausaufenthalt hatte (1) oder nicht (0).</p>
<p>Das Aufstellen der Regressionsgleichung funktioniert hier äquivalent zu den bisher kennengelernten linearen Modellen. Auf der linken Seite der Tilde schreiben wir die abhängige Variable und auf der rechten Seite die unabhängigen Variablen, getrennt von einem Pluszeichen. Zusätzlich definieren wir über das <code>family</code> Argument die Verteilung als <code>binomial</code> (ohne Anführungszeichen). Beachte, dass wir hier die Funktion <code>glm()</code> anstelle von <code>lm()</code> verwenden. Die Ergebnisse werden von der Funktion <code>summary()</code> zusammengefasst.</p>
<div class="sourceCode" id="cb517"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb517-1"><a href="inductive.html#cb517-1" tabindex="-1"></a>res_reg4 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Stationaer <span class="sc">~</span> Geschlecht <span class="sc">+</span> Infektionen, <span class="at">data =</span> chemo, <span class="at">family =</span> binomial)</span>
<span id="cb517-2"><a href="inductive.html#cb517-2" tabindex="-1"></a><span class="fu">summary</span>(res_reg4)</span></code></pre></div>
<pre class="bordercode"><code>
Call:
glm(formula = Stationaer ~ Geschlecht + Infektionen, family = binomial, 
    data = chemo)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -2.99282    0.32229  -9.286  &lt; 2e-16 ***
Geschlechtm  0.19232    0.33572   0.573  0.56674    
Infektionen  0.21365    0.06936   3.080  0.00207 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 269.96  on 449  degrees of freedom
Residual deviance: 260.76  on 447  degrees of freedom
AIC: 266.76

Number of Fisher Scoring iterations: 5</code></pre>
<p>Während der <span class="math inline">\(\beta\)</span>-Koeffizient für das Geschlecht nicht statistisch signifikant von 0 abweicht, erhalten wir für die Infektionshäufigkeit einen nennenswerten Zusammenhang mit der Notwendigkeit eines Krankenhausaufenthalts (0.00207 ist kleiner als 0.05). Der positive <span class="math inline">\(\beta\)</span>-Koeffizient besagt, dass die Wahrscheinlichkeit eines Krankenhausaufenthalts mit steigender Infektionshäufigkeit ansteigt. Das Odds Ratios erhalten wir durch das Exponieren der <span class="math inline">\(\beta\)</span>-Koeffizienten, die wir mit dem Dollar-Operator aus der Ergebnisliste herausziehen (siehe Kapitel <a href="vars.html#dollar">4.5</a>).</p>
<div class="sourceCode" id="cb519"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb519-1"><a href="inductive.html#cb519-1" tabindex="-1"></a><span class="fu">exp</span>(res_reg4<span class="sc">$</span>coefficients)</span></code></pre></div>
<pre class="bordercode"><code>(Intercept) Geschlechtm Infektionen 
 0.05014566  1.21206341  1.23818556 </code></pre>
<p>Im Unterschied zu den linearen Modellen wird uns an dieser Stelle zusätzlich ein Informationskriterium (AIC) ausgegeben, mit welchem wir mehrere ähnliche Modelle miteinander vergleichen könnten. Für eine genaue Beschreibung der Ausgabe von Regressionsmodellen in R und deren Voraussetzungen sei auf Kapitel <a href="inductive.html#linregression">9.5.1</a> verwiesen.</p>
</div>
<div id="multinomiales-logit-modell" class="section level3 hasAnchor" number="9.5.3">
<h3><span class="header-section-number">9.5.3</span> Multinomiales Logit Modell<a href="inductive.html#multinomiales-logit-modell" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Für dieses Unterkapitel muss das Package <code>VGAM</code> installiert und geladen sein. Beachte hier, dass der Name des Packages vollständig in Großbuchstaben geschrieben ist.</p>
<div class="sourceCode" id="cb521"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb521-1"><a href="inductive.html#cb521-1" tabindex="-1"></a><span class="fu">library</span>(VGAM)</span></code></pre></div>
<p>Möchten wir eine abhängige Variable mit nominalem Skalenniveau mit mehr als zwei Ausprägungen untersuchen, greifen wir auf ein Logit Modell unter multinomialer Verteilungsannahme zurück. Da wir ein nominales Skalenniveau und somit ungeordnete Kategorien vorliegen haben, müssen wir uns auch hier für eine Referenzkategorie entscheiden. Falls die erste Kategorie als Referenz gewählt wird, ist das Modell in der Literatur auch als sogenanntes Baseline Logit Modell beschrieben.</p>
<p>Wir möchten untersuchen, inwiefern die unabhängigen Variablen Alter und Geschlecht einen Einfluss auf drei mögliche Komorbiditäten der PatientInnen hat. Hierbei handelt es sich um weitere Erkrankungen, die neben der Haupterkrankung auftreten können. In unserem Beispiel haben 271 keine weitere Erkrankung, während bei insgesamt 179 zusätzlich entweder eine Erkrankungen der Lungen, des Herzens oder Gehirns auftritt.</p>
<div class="sourceCode" id="cb522"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb522-1"><a href="inductive.html#cb522-1" tabindex="-1"></a><span class="fu">table</span>(chemo<span class="sc">$</span>Komorb)</span></code></pre></div>
<pre class="bordercode"><code>
 Keine  Lunge   Herz Gehirn 
   271     67     63     49 </code></pre>
<p>Umgesetzt ist das multinomiale Logit Modell in R in Form der <code>vglm()</code> Funktion aus dem <code>VGAM</code> Package. Wir übergeben der Funktion die abhängige Variable auf der linken Seite der Tilde und die unabhängigen Variablen auf der rechten Seite. Entscheiden ist hier das <code>family</code> Argument. Innerhalb der Helferfunktion <code>multinomial()</code> legen wir die Referenzkategorie fest. Hier entscheiden wir uns für die erste Faktorstufe (keine Komorbidität). Die drei weiteren Faktorstufen Lunge, Herz und Gehirn werden im Vergleich zur Referenz betrachtet. Wir erhalten folglich einen Intercept und zwei <span class="math inline">\(\beta\)</span>-Koeffizienten pro Kategorie. Welche Faktorstufe die erste ist, muss explizit im Zuge der Erstellung des Faktors definiert werden (siehe Kapitel <a href="datenvorbereitung.html#datafactor">6.10</a>). Die Zusammenfassung der Ergebnisse wird mit der Funktion <code>summary()</code> erstellt.</p>
<div class="sourceCode" id="cb524"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb524-1"><a href="inductive.html#cb524-1" tabindex="-1"></a>reg_res5 <span class="ot">&lt;-</span> <span class="fu">vglm</span>(</span>
<span id="cb524-2"><a href="inductive.html#cb524-2" tabindex="-1"></a>  <span class="at">formula =</span> Komorb <span class="sc">~</span> Geschlecht <span class="sc">+</span> Alter, </span>
<span id="cb524-3"><a href="inductive.html#cb524-3" tabindex="-1"></a>  <span class="at">data =</span> chemo, </span>
<span id="cb524-4"><a href="inductive.html#cb524-4" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">multinomial</span>(<span class="at">refLevel =</span> <span class="dv">1</span>)</span>
<span id="cb524-5"><a href="inductive.html#cb524-5" tabindex="-1"></a>)</span>
<span id="cb524-6"><a href="inductive.html#cb524-6" tabindex="-1"></a><span class="fu">summary</span>(reg_res5)</span></code></pre></div>
<pre class="bordercode"><code>
Call:
vglm(formula = Komorb ~ Geschlecht + Alter, family = multinomial(refLevel = 1), 
    data = chemo)

Coefficients: 
               Estimate Std. Error z value Pr(&gt;|z|)
(Intercept):1  0.545334   1.425047   0.383    0.702
(Intercept):2 -0.696183   1.466621  -0.475    0.635
(Intercept):3  0.008255   1.619572   0.005    0.996
Geschlechtm:1 -0.071655   0.274680  -0.261    0.794
Geschlechtm:2 -0.097160   0.281295  -0.345    0.730
Geschlechtm:3 -0.047474   0.312092  -0.152    0.879
Alter:1       -0.042804   0.032045  -1.336    0.182
Alter:2       -0.015986   0.032713  -0.489    0.625
Alter:3       -0.037991   0.036388  -1.044    0.296

Names of linear predictors: log(mu[,2]/mu[,1]), log(mu[,3]/mu[,1]), log(mu[,4]/mu[,1])

Residual deviance: 992.3763 on 1341 degrees of freedom

Log-likelihood: -496.1882 on 1341 degrees of freedom

Number of Fisher scoring iterations: 5 

No Hauck-Donner effect found in any of the estimates


Reference group is level  1  of the response</code></pre>
<p>Die Referenzkategorie wurde zuvor als <em>keine Komorbiditäten</em> definiert. Wir erhalten drei Intercepts, drei <span class="math inline">\(\beta\)</span>-Koeffizienten für Geschlecht und drei für das Alter. Dabei wird die Reihenfolge der Faktorenstufen eingehalten. <code>(Intercept):1</code>, <code>Geschlechtm:1</code> und <code>Alter:1</code> beschreiben folglich mögliche Geschlechts- oder Alterseffekte auf die Wahrscheinlichkeit, eine Lungenerkrankungen zusätzlich zu der bereits bestehenden Krebserkrankungen zu haben (im Vergleich zu keiner Komorbidität). Äquivalent steht die Zahl 2 für Herzerkrankungen und 3 für Erkrankungen des Gehirns jeweils im Vergleich zu unserer Baseline (keine Komorbidität). Da keiner der <span class="math inline">\(\beta\)</span>-Koeffizienten signifikant von 0 abweicht, liegt kein Zusammenhang zwischen den unabhängigen Variablen und dem Auftreten einer Komorbidität vor.</p>
<div class="idea">
<p>Wenn die abhängige Variable nominal skaliert mit mehr als zwei Ausprägungen ist, können wir das multinomiale Logit Modell verwenden. Falls nur zwei Ausprägungen vorliegen, ist die logistische Regression angemessener. Bei ordinalem Skalenniveau greifen wir auf das kumulative Logit Modell zurück.</p>
</div>
</div>
<div id="propodds" class="section level3 hasAnchor" number="9.5.4">
<h3><span class="header-section-number">9.5.4</span> Kumulatives Logit Modell<a href="inductive.html#propodds" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In diesem Kapitel muss das <code>VGAM</code> Package installiert und geladen werden. Der Packagename wird in Großbuchstaben geschrieben.</p>
<div class="sourceCode" id="cb526"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb526-1"><a href="inductive.html#cb526-1" tabindex="-1"></a><span class="fu">library</span>(VGAM)</span></code></pre></div>
<p>Bei einem interessierenden Merkmal, welches geordnete Kategorien beinhaltet, haben wir ein ordinales Skalenniveau vorliegen und verwenden daher ein kumulatives Logit Modell. Ein anderer etwas unscharfer Begriff dafür ist Ordinales Regressionsmodell. Grundsätzlich gibt es verschiedene kumulative Logit Modelle wie das Adjacent Category Model oder das Proportional Odds Model. Wir werden uns im weiteren Verlauf auf letzteres konzentrieren.</p>
<p>Wir möchten im weiteren Verlauf einen möglichen Zusammenhang zwischen dem subjektiv empfundenen Schmerz während der Behandlung und den unabhängigen Variablen Alter und Geschlecht untersuchen. Die Schmerzen wurden mithilfe eines Fragebogens erfasst, bei dem 1 für keine Schmerzen und 10 für unerträgliche Schmerzen steht.</p>
<div class="sourceCode" id="cb527"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb527-1"><a href="inductive.html#cb527-1" tabindex="-1"></a><span class="fu">table</span>(chemo<span class="sc">$</span>Schmerzen)</span></code></pre></div>
<pre class="bordercode"><code>
 1  2  3  4  5  6  7  8  9 10 
36 46 37 40 86 62 61 56 17  9 </code></pre>
<p>Wie im vorherigen Kapitel greifen wir auch hier auf die Funktion <code>vglm()</code> aus dem <code>VGAM</code> Package zurück. Die abhängige Variable wird auf die linke Seite der Tilde und die unabhängigen, getrennt von einem Pluszeichen, auf die rechte Seite geschrieben. Das <code>family</code> Argument wird beim Proportional Odds Model durch die Helferfunktion <code>propodds()</code> definiert. Die Zusammenfassung der Ergebnisse erhalten wir durch die Funktion <code>summary()</code>.</p>
<div class="sourceCode" id="cb529"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb529-1"><a href="inductive.html#cb529-1" tabindex="-1"></a>reg_parallel <span class="ot">&lt;-</span> <span class="fu">vglm</span>(</span>
<span id="cb529-2"><a href="inductive.html#cb529-2" tabindex="-1"></a>  <span class="at">formula =</span> Schmerzen <span class="sc">~</span> Alter <span class="sc">+</span> Geschlecht, </span>
<span id="cb529-3"><a href="inductive.html#cb529-3" tabindex="-1"></a>  <span class="at">data =</span> chemo, </span>
<span id="cb529-4"><a href="inductive.html#cb529-4" tabindex="-1"></a>  <span class="at">family =</span> propodds</span>
<span id="cb529-5"><a href="inductive.html#cb529-5" tabindex="-1"></a>)</span>
<span id="cb529-6"><a href="inductive.html#cb529-6" tabindex="-1"></a><span class="fu">summary</span>(reg_parallel)</span></code></pre></div>
<pre class="bordercode"><code>
Call:
vglm(formula = Schmerzen ~ Alter + Geschlecht, family = propodds, 
    data = chemo)

Coefficients: 
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept):1  2.90034    0.87618   3.310 0.000932 ***
(Intercept):2  1.95733    0.86692   2.258 0.023958 *  
(Intercept):3  1.47788    0.86452   1.709 0.087361 .  
(Intercept):4  1.05810    0.86311   1.226 0.220232    
(Intercept):5  0.27075    0.86174   0.314 0.753379    
(Intercept):6 -0.31889    0.86184  -0.370 0.711376    
(Intercept):7 -1.05919    0.86392  -1.226 0.220186    
(Intercept):8 -2.34958    0.87822  -2.675 0.007465 ** 
(Intercept):9 -3.44873    0.91845  -3.755 0.000173 ***
Alter         -0.01246    0.01920  -0.649 0.516203    
Geschlechtm    0.22298    0.16561   1.346 0.178152    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Number of linear predictors:  9 

Names of linear predictors: logitlink(P[Y&gt;=2]), logitlink(P[Y&gt;=3]), logitlink(P[Y&gt;=4]), 
logitlink(P[Y&gt;=5]), logitlink(P[Y&gt;=6]), logitlink(P[Y&gt;=7]), logitlink(P[Y&gt;=8]), 
logitlink(P[Y&gt;=9]), logitlink(P[Y&gt;=10])

Residual deviance: 1957.469 on 4039 degrees of freedom

Log-likelihood: -978.7347 on 4039 degrees of freedom

Number of Fisher scoring iterations: 4 

No Hauck-Donner effect found in any of the estimates


Exponentiated coefficients:
      Alter Geschlechtm 
   0.987615    1.249799 </code></pre>
<p>Für jeden Logit wird ein Intercept ausgegeben. Wir erhalten über alle Logits einen <span class="math inline">\(\beta\)</span>-Koeffizienten für Alter und einen für Geschlecht. Beide zeigen in diesem Fall keinen signifikanten Zusammenhang mit den einzelnen Logits.</p>
<p>In der Praxis sollte immer die sogenannte <em>Proportional Odds Assumption</em> überprüft werden. Schließlich wissen wir im vornherein nicht, ob die Annahme der gleichen Effekte der Kovariate über alle Kategorien zutrifft. Hierfür stellen wir ein Partial Proportional Odds Model auf, in dem wir für jede Kategorie einen eigenen Effekt schätzen. Hierfür benötigen wir für das <code>family</code> Argument die <code>cumulative()</code> Funktion, in der wir das Argument auf <code>FALSE</code> setzen. Getrennt von einer Tilde wird das partielle Modell definiert. In diesem Fall exkludieren wir den Intercept (<code>-1</code>) und schätzen die Effekte für beide Kovariaten (<code>Alter</code> und <code>Geschlecht</code>).</p>
<div class="sourceCode" id="cb531"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb531-1"><a href="inductive.html#cb531-1" tabindex="-1"></a>reg_notparallel <span class="ot">&lt;-</span> <span class="fu">vglm</span>(</span>
<span id="cb531-2"><a href="inductive.html#cb531-2" tabindex="-1"></a>  <span class="at">formula =</span> Schmerzen <span class="sc">~</span> Alter <span class="sc">+</span> Geschlecht, </span>
<span id="cb531-3"><a href="inductive.html#cb531-3" tabindex="-1"></a>  <span class="at">data =</span> chemo, </span>
<span id="cb531-4"><a href="inductive.html#cb531-4" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">cumulative</span>(<span class="at">parallel =</span> <span class="cn">FALSE</span> <span class="sc">~</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> Alter <span class="sc">+</span> Geschlecht, <span class="at">reverse =</span> <span class="cn">TRUE</span>)</span>
<span id="cb531-5"><a href="inductive.html#cb531-5" tabindex="-1"></a>)</span></code></pre></div>
<p>Anschließend vergleichen wir beide Modelle mithilfe des Likelihood Ratio Tests, welcher durch die Funktion <code>lrtest()</code> ebenfalls im <code>VGAM</code> Package enthalten ist. Die Argumente sind hierbei lediglich beide Modelle.</p>
<div class="sourceCode" id="cb532"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb532-1"><a href="inductive.html#cb532-1" tabindex="-1"></a><span class="fu">lrtest</span>(reg_parallel, reg_notparallel)</span></code></pre></div>
<pre class="bordercode"><code>Likelihood ratio test

Model 1: Schmerzen ~ Alter + Geschlecht
Model 2: Schmerzen ~ Alter + Geschlecht
   #Df  LogLik Df Chisq Pr(&gt;Chisq)
1 4039 -978.73                    
2 4031 -978.90 -8 0.334          1</code></pre>
<p>Da wir einen <em>p</em>-Wert von 1 erhalten, welcher größer als 0.05 ist, können wir von zutreffender <em>Proportional Odds</em> Annahme ausgehen.</p>
<div class="idea">
<p>Eine andere häufig verwendete Funktion ist <code>polr()</code> aus dem <code>MASS</code> Package, welche Ergebnisse mit umgekehrten Vorzeichen im Vergleich zu der hier kennengelernten Funktion ausgibt. Dies liegt daran, dass in <code>VGAM</code> die Logits als <span class="math inline">\(logit[P(Y \leq j)] = \alpha_j + \beta x\)</span> definiert sind und im <code>MASS</code> Package als <span class="math inline">\(logit[P(Y \leq j)] = \alpha_j - \beta x\)</span> mit <span class="math inline">\(j =1, \dots ,J −1\)</span>.</p>
</div>
<div class="idea">
<p>Falls die geordneten Kategorien des interessierenden Merkmals viele Unterstufen haben, ist möglicherweise das Schätzen eines linearen Modell möglich, welches einfacher zu interpretieren ist. In der wissenschaftlichen Praxis werden vor allem im Kontext von Fragebogenstudien häufig Verfahren für intervallskalierte Merkmale angewandt, obwohl Messungen durch einen Fragebogen im Regelfall nur ordinales Skalenniveau vorweisen.</p>
</div>
</div>
<div id="poisson-regression" class="section level3 hasAnchor" number="9.5.5">
<h3><span class="header-section-number">9.5.5</span> Poisson Regression<a href="inductive.html#poisson-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Für dieses Kapitel sind die Installation und das Laden des <code>MASS</code> Packages notwendig.</p>
<div class="sourceCode" id="cb534"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb534-1"><a href="inductive.html#cb534-1" tabindex="-1"></a><span class="fu">library</span>(MASS)</span></code></pre></div>
<p>Von sogenannten Zähldaten spricht man normalerweise im Kontext von Häufigkeiten. Die klassische Verteilung für Häufigkeiten ist die Poisson Verteilung, welche den Mittelwert gleich der Varianz postuliert. Dies ist in der Realität dennoch selten der Fall, weil die Varianz häufig bei höherer Häufigkeit steigt. Wir werden im weiteren Verlauf dieses Kapitels zwei mögliche Lösungen für das Problem kennenlernen. Ein weiterer Anwendungsfall für die Possion Regression ist die Modellierung seltener Ereignisse.</p>
<p>Um den Einfluss der Behandlungsarten auf das Immunsystem zu beurteilen, wurde im <code>chemo</code> Datensatz ebenfalls die Infektionshäufigkeit innerhalb von zwei Jahren erhoben. Da die Behandlungsarten mehr als zwei nominale Ausprägungen haben, müssen wir diese als Faktor übergeben (wurde bereits erstellt) (siehe Kapitel <a href="datenvorbereitung.html#datafactor">6.10</a>). Die Referenz ist die Radiochemotherapie. Zusätzlich möchten wir noch etwaige Alterseffekte auf die Infektionshäufigkeit ausschließen. Als <code>family</code> Argument verwenden wir <code>poisson</code> (ohne Anführungszeichen). Mit der Funktion <code>summary()</code> werden die Ergebnisse übersichtlich zusammengefasst.</p>
<div class="sourceCode" id="cb535"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb535-1"><a href="inductive.html#cb535-1" tabindex="-1"></a>reg_res7 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Infektionen <span class="sc">~</span> Behandlung <span class="sc">+</span> Alter, <span class="at">data =</span> chemo, <span class="at">family =</span> poisson)</span>
<span id="cb535-2"><a href="inductive.html#cb535-2" tabindex="-1"></a><span class="fu">summary</span>(reg_res7)</span></code></pre></div>
<pre class="bordercode"><code>
Call:
glm(formula = Infektionen ~ Behandlung + Alter, family = poisson, 
    data = chemo)

Coefficients:
                Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)     0.671640   0.331482   2.026   0.0427 * 
BehandlungChemo 0.161160   0.078867   2.043   0.0410 * 
BehandlungRadio 0.229135   0.077726   2.948   0.0032 **
Alter           0.000258   0.007307   0.035   0.9718   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 874.75  on 449  degrees of freedom
Residual deviance: 865.62  on 446  degrees of freedom
AIC: 1862.6

Number of Fisher Scoring iterations: 5</code></pre>
<p>Im Vergleich zur Radiochemotherapie haben PatientInnen unter alleiniger Chemotherapie oder Radiotherapie mehr Infektionen innerhalb von 2 Jahren. Dies erkennen wir an den positiven <span class="math inline">\(\beta\)</span>-Koeffizienten, die statistisch signifikant von 0 abweichen, weil die <em>p</em>-Werte mit 0.0410 und 0.0032 kleiner als das übliche <span class="math inline">\(\alpha\)</span>-Niveau von 0.05 sind. Das Alter scheint hingegen keinen relevanten Zusammenhang mit der Infektionshäufigkeit zu haben. Als Effektstärke berechnen wir in diesem Kontext die sogenannte <em>Incidence Rate Ratio</em>, welche wir durch Exponieren der <span class="math inline">\(\beta\)</span>-Koeffizienten erhalten. Die <span class="math inline">\(\beta\)</span>-Koeffizienten extrahieren wir anhand des Dollar-Operators aus dem Modell.</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb537-1"><a href="inductive.html#cb537-1" tabindex="-1"></a><span class="fu">exp</span>(reg_res7<span class="sc">$</span>coefficients)</span></code></pre></div>
<pre class="bordercode"><code>    (Intercept) BehandlungChemo BehandlungRadio           Alter 
       1.957445        1.174873        1.257512        1.000258 </code></pre>
<p>Der Dispersionsparameter ist hier als 1 festgelegt, da in der Poisson Verteilung der Mittelwert gleich der Varianz postuliert wird. Wie bereits angesprochen, ist die aus den Daten geschätzte Varianz häufig höher als durch die Poisson Verteilung angenommen. Man redet in diesem Kontext auch von einer sogenannten Überdispersion (engl. over-dispersion). Eine Möglichkeit zur Korrektur ist die Verwendung der Quasipoisson Verteilung. Ein Nachteil hierbei ist, dass Quasi-Likelihood Methoden keine Möglichkeit zur Berechnung von Informationskriterien bieten.</p>
<div class="sourceCode" id="cb539"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb539-1"><a href="inductive.html#cb539-1" tabindex="-1"></a>reg_res8 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Infektionen <span class="sc">~</span> Behandlung <span class="sc">+</span> Alter, <span class="at">data =</span> chemo, <span class="at">family =</span> quasipoisson) </span>
<span id="cb539-2"><a href="inductive.html#cb539-2" tabindex="-1"></a><span class="fu">summary</span>(reg_res8)</span></code></pre></div>
<pre class="bordercode"><code>
Call:
glm(formula = Infektionen ~ Behandlung + Alter, family = quasipoisson, 
    data = chemo)

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)     0.671640   0.453395   1.481   0.1392  
BehandlungChemo 0.161160   0.107873   1.494   0.1359  
BehandlungRadio 0.229135   0.106312   2.155   0.0317 *
Alter           0.000258   0.009995   0.026   0.9794  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for quasipoisson family taken to be 1.870828)

    Null deviance: 874.75  on 449  degrees of freedom
Residual deviance: 865.62  on 446  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 5</code></pre>
<p>Im Vergleich zur vorherigen Poisson Regression stellen wir bei den Ergebnissen hier einen entscheidenden Unterschied fest. Nur die Radiotherapie hat im Vergleich zur Radiochemotherapie noch einen nennenswerten positiven Zusammenhang mit der Infektionshäufigkeit, die Chemotherapie hingegen nicht mehr. In den Daten scheint folglich eine Überdispersion vorzulegen, worauf auch der auf 1.87 geschätzte Dispersionsparameter hindeutet.</p>
<p>Eine weitere Alternative ohne die Einschränkungen der Quasipoisson Verteilung bei bestehender Überdispersion ist die sogenannte negative Binomial Verteilung. Diese ist in Form der <code>glm.nb()</code> im <code>MASS</code> Package implementiert. Bei der Verwendung bleibt abgesehen vom Wegfall des <code>family</code> Arguments alles gleich.</p>
<div class="sourceCode" id="cb541"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb541-1"><a href="inductive.html#cb541-1" tabindex="-1"></a>reg_res9 <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(Infektionen <span class="sc">~</span> Behandlung <span class="sc">+</span> Alter, <span class="at">data =</span> chemo) </span>
<span id="cb541-2"><a href="inductive.html#cb541-2" tabindex="-1"></a><span class="fu">summary</span>(reg_res9)</span></code></pre></div>
<pre class="bordercode"><code>
Call:
glm.nb(formula = Infektionen ~ Behandlung + Alter, data = chemo, 
    init.theta = 2.592130972, link = log)

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)     0.6602195  0.4533734   1.456   0.1453  
BehandlungChemo 0.1611161  0.1065635   1.512   0.1306  
BehandlungRadio 0.2292369  0.1057676   2.167   0.0302 *
Alter           0.0005127  0.0100032   0.051   0.9591  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for Negative Binomial(2.5921) family taken to be 1)

    Null deviance: 516.19  on 449  degrees of freedom
Residual deviance: 511.28  on 446  degrees of freedom
AIC: 1767.4

Number of Fisher Scoring iterations: 1

              Theta:  2.592 
          Std. Err.:  0.408 

 2 x log-likelihood:  -1757.383 </code></pre>
<p>Das Ergebnis ist hier sehr ähnlich des Regressionsmodell unter Annahme einer Quasipoisson Verteilung. Hier wird die Überdispersion mit 2.59 sogar noch höher geschätzt. Für eine genaue Beschreibungen der Ausgabe von Regressionsmodellen in R und deren Voraussetzungen sei auch an dieser Stelle auf Kapitel <a href="inductive.html#linregression">9.5.1</a> verwiesen.</p>
<div class="warning">
<p>Beim Laden des <code>MASS</code> Packages für die negative Binomial Regression wird <code>select()</code> aus dem <code>tidyverse</code> maskiert, weswegen die Reihenfolge beim Laden der beiden Packages relevant ist. Andernfalls hat die kennengelernte Funktion <code>select()</code> aus dem <code>tidyverse</code> nicht mehr die gewohnte Funktionalität. Lade also zunächst <code>MASS</code> und anschließend das <code>tidyverse</code>. Für mehr Informationen über den dafür verantwortlichen Namespace, schaue dir Kapitel <a href="start.html#namespace">2.5.3</a> erneut an. Führe im Zweifel einen Neustart von RStudio durch und lade die beiden Packages nun in der für uns richtigen Reihenfolge.</p>
</div>
<div class="idea">
<p>Die klassische Verteilung für Zähldaten ist die Poisson Verteilung. Man sollte diese aber wegen häufig auftretender Überdispersion immer mit den Ergebnissen der Regression unter Annahme einer Quasipoisson oder negativen Binomial Verteilung vergleichen. Falls Häufigkeit nicht als Spalte sondern in Form von Kontingenztafeln vorliegen, muss man stattdessen auf den Exakten Fisher Test oder den <span class="math inline">\(\chi^2\)</span> Test zurückgreifen (siehe Kapitel <a href="inductive.html#contingency">9.6</a>).</p>
</div>
</div>
<div id="cox" class="section level3 hasAnchor" number="9.5.6">
<h3><span class="header-section-number">9.5.6</span> Cox Regression<a href="inductive.html#cox" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In diesem Kapitel muss das <code>survival</code> Package installiert und geladen werden.</p>
<div class="sourceCode" id="cb543"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb543-1"><a href="inductive.html#cb543-1" tabindex="-1"></a><span class="fu">library</span>(survival)</span></code></pre></div>
<p>Wir haben in Kapitel <a href="visual.html#kaplan">8.13.1</a> bereits gelernt, wie Überlebenszeiten in Form von Kaplan-Meier Kurven graphisch dargestellt werden können. In diesem Kapitel beschäftigen wir uns mit der statistischen Modellierung durch die Cox Regression (engl. Cox Proportional-Hazards Model) und den Log Rank Test. Uns interessiert die Frage, ob die drei Behandlungsmethoden und das Geschlecht einen Einfluss auf die Überlebenszeit haben.</p>
<p>Im <code>chemo</code> Datensatz beinhaltet die Spalte <code>Beob_zeit</code> die Beobachtungszeit innerhalb eines Zeitraums von 15 Jahren und <code>Status</code> die Information über das Versterben oder sonstige Ausscheiden aus dieser Studie. Eine 0 steht in dieser Spalte für ein sogenanntes zensiertes Ereignis. Der Patient oder die Patientin ist also aus irgendeinem Grund aus der Studie ausgeschieden (z.B. durch Umzug in ein anderes Land). Mit 1 ist der jeweilige Todesfall dokumentiert. Grundsätzlich wäre es außerdem möglich zwei Ereignisse miteinander zu vergleichen, wobei das zweite Ereignis dann entsprechend als 2 kodiert werden muss. Es ist wichtig, dass die Spalte mit den Informationen über die Ereignisse immer genau diese Kodierung hat. Funktionen zur Umkodierung haben wir bereits in Kapitel <a href="datenvorbereitung.html#helfer">6.4.3</a> kennengelernt.</p>
<pre class="bordercode"><code># A tibble: 450 × 4
  Beob_zeit Status Behandlung Geschlecht
      &lt;dbl&gt;  &lt;dbl&gt; &lt;fct&gt;      &lt;chr&gt;     
1     0.833      1 Radio      f         
2     4.80       1 Radiochemo f         
3     1.46       1 Radio      m         
4     0.922      1 Radio      f         
# ℹ 446 more rows</code></pre>
<p>Im Kontext von Überlebenszeitanalysen interessiert uns häufig zunächst das Überleben nach einer bestimmten Zeit. Hierfür übergeben wir die abhängigen Variablen (<code>Beob_zeit</code> und <code>Status</code>) der Helferfunktion <code>Surv()</code> auf der linken Seite der Tilde und eine 1 auf der rechten Seite. Schließlich sind wir zunächst am gesamten Überleben ohne Unterteilung interessiert.</p>
<div class="sourceCode" id="cb545"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb545-1"><a href="inductive.html#cb545-1" tabindex="-1"></a>zeit <span class="ot">&lt;-</span> <span class="fu">survfit</span>(</span>
<span id="cb545-2"><a href="inductive.html#cb545-2" tabindex="-1"></a>  <span class="at">formula =</span> <span class="fu">Surv</span>(<span class="at">time =</span> Beob_zeit, <span class="at">event =</span> Status) <span class="sc">~</span> <span class="dv">1</span>, </span>
<span id="cb545-3"><a href="inductive.html#cb545-3" tabindex="-1"></a>  <span class="at">data =</span> chemo</span>
<span id="cb545-4"><a href="inductive.html#cb545-4" tabindex="-1"></a>)</span>
<span id="cb545-5"><a href="inductive.html#cb545-5" tabindex="-1"></a>zeit</span></code></pre></div>
<pre class="bordercode"><code>Call: survfit(formula = Surv(time = Beob_zeit, event = Status) ~ 1, 
    data = chemo)

       n events median 0.95LCL 0.95UCL
[1,] 450    407   1.99    1.82    2.21</code></pre>
<p>Das mediane Überleben liegt bei dieser Erkrankung bei knapp 2 Jahren. Für die Überlebenswahrscheinlichkeit nach 5 Jahren übergeben wir die Variable <code>zeit</code> an die Funktion <code>summary()</code>. Durch das <code>times</code> Argument kann die interessierende Überlebenszeit festgelegt werden (hier 5 Jahre).</p>
<div class="sourceCode" id="cb547"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb547-1"><a href="inductive.html#cb547-1" tabindex="-1"></a><span class="fu">summary</span>(zeit, <span class="at">times =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre class="bordercode"><code>Call: survfit(formula = Surv(time = Beob_zeit, event = Status) ~ 1, 
    data = chemo)

 time n.risk n.event survival std.err lower 95% CI upper 95% CI
    5     47     361    0.129   0.017       0.0993        0.167</code></pre>
<p>Nur knapp 13% überleben die ersten fünf Jahre nach Diagnosestellung. Als nächsten Schritt beantworten wir die Frage nach möglichem Einfluss der unabhängigen Variablen Behandlungsart und Geschlecht, welche wir ebenfalls auf die rechte Seite der Tilde schreiben. Die Cox Regression ist mit der Funktion <code>coxph()</code> aus dem <code>survival</code> Package in R verfügbar. Falls eine Modellierung in Abhängigkeit der Start- und Endzeit gewünscht ist, kann die Startzeit dem <code>time</code> und die Endzeit dem <code>time2</code> Argument übergeben werden. Die Zusammenfassung der Ergebnisse erfolgt durch <code>summary()</code>.</p>
<div class="sourceCode" id="cb549"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb549-1"><a href="inductive.html#cb549-1" tabindex="-1"></a>reg_res10 <span class="ot">&lt;-</span> <span class="fu">coxph</span>(</span>
<span id="cb549-2"><a href="inductive.html#cb549-2" tabindex="-1"></a>  <span class="at">formula =</span> <span class="fu">Surv</span>(<span class="at">time =</span> Beob_zeit, <span class="at">event =</span> Status) <span class="sc">~</span> Behandlung <span class="sc">+</span> Geschlecht, </span>
<span id="cb549-3"><a href="inductive.html#cb549-3" tabindex="-1"></a>  <span class="at">data =</span> chemo</span>
<span id="cb549-4"><a href="inductive.html#cb549-4" tabindex="-1"></a>)</span>
<span id="cb549-5"><a href="inductive.html#cb549-5" tabindex="-1"></a><span class="fu">summary</span>(reg_res10)</span></code></pre></div>
<pre class="bordercode"><code>Call:
coxph(formula = Surv(time = Beob_zeit, event = Status) ~ Behandlung + 
    Geschlecht, data = chemo)

  n= 450, number of events= 407 

                  coef exp(coef) se(coef)      z Pr(&gt;|z|)    
BehandlungChemo 1.1703    3.2230   0.1364  8.577   &lt;2e-16 ***
BehandlungRadio 2.2387    9.3816   0.1558 14.372   &lt;2e-16 ***
Geschlechtm     0.8596    2.3622   0.1041  8.260   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

                exp(coef) exp(-coef) lower .95 upper .95
BehandlungChemo     3.223     0.3103     2.467     4.211
BehandlungRadio     9.382     0.1066     6.913    12.731
Geschlechtm         2.362     0.4233     1.926     2.897

Concordance= 0.732  (se = 0.012 )
Likelihood ratio test= 261.1  on 3 df,   p=&lt;2e-16
Wald test            = 241.1  on 3 df,   p=&lt;2e-16
Score (logrank) test = 275.7  on 3 df,   p=&lt;2e-16</code></pre>
<p>Oben in der Ausgabe erfahren wir, dass nach 15 Jahren nur 43 der 450 Behandelten, die bis zum Ende Teil der Studie waren, noch Leben. Anschließend werden die <span class="math inline">\(\beta\)</span>-Koeffizienten (<code>coef</code>), Hazards Ratios (<code>exp(coef)</code>), Standardfehler (<code>se</code>), <em>z</em>-Wert und <em>p</em>-Wert.</p>
<p>Die Kovariate <code>Behandlung</code> ist bereits von vornherein als Faktor definiert worden, da hier drei Gruppen vorliegen. Dabei ist die Referenzgruppe die Radiochemotherapie. Wir erhalten also die Informationen, dass unter der Behandlung mit alleiniger Chemotherapie dreimal mehr PatientInnen sterben, mit alleiniger Radiotherapie sogar neunmal mehr. In der Kovariate Geschlecht sehen wir am Ende des Wortes den Buchstaben <em>m</em>. Die Referenzkategorie ist hier folglich das weibliche Geschlecht (<em>f</em>). Männer haben in unserer Stichprobe mehr als die doppelte Gefahr, an der Erkrankung zu sterben. Alle drei <span class="math inline">\(\beta\)</span>-Koeffizienten weichen statistisch signifikant von 0 ab, da die <em>p</em>-Werte mit 2.2e-16 (<span class="math inline">\(2.2*10^{-16}\)</span>) deutlich kleiner als das übliche Signifikanzniveau von 5% ist.</p>
<p>Anschließend werden die Hazard Ratios diesmal mit 95% Konfidenzintervall gezeigt. Zuletzt werden die Ergebnisse der drei üblichsten Likelihood Tests für die globale Nullhypothese, dass alle <span class="math inline">\(\beta\)</span>-Koeffizienten gleich 0 sind, angegeben. Die Alternativhypothese stellt hier das Abweichen mindestens eines <span class="math inline">\(\beta\)</span>-Koeffizienten von 0 dar.</p>
<p>Eine zentrale Voraussetzung steckt bereits im Namen des Cox Proportional Hazards Modells. Man geht davon aus, dass sich die Hazard Ratio über den zeitlichen Verlauf zwischen den Gruppen proportional zueinander verhält. Es sollte also nicht sein, dass das Risiko in einer Gruppe zu Beginn der Zeitmessung deutlich höher ist und sich dieser Trend zum Ende der Zeitmessung umdreht. Überprüft wird diese Annahme mit dem Score Test für die Schoenfeld Residuen. Im <code>survival</code> Package ist dieser in Form der Funktion <code>cox.zph()</code> umgesetzt.</p>
<div class="sourceCode" id="cb551"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb551-1"><a href="inductive.html#cb551-1" tabindex="-1"></a><span class="fu">cox.zph</span>(reg_res10)</span></code></pre></div>
<pre class="bordercode"><code>           chisq df    p
Behandlung 1.503  2 0.47
Geschlecht 0.846  1 0.36
GLOBAL     2.395  3 0.49</code></pre>
<p>Da der p-Wert hier nicht statistisch signifikant ist, behalten wir die Nullhypothese bei, dass die Annahme der Proportional Hazards nicht verletzt ist. Graphisch würde man Verletzungen dieser Annahme an einem Kreuzen der Kaplan-Meier Kurven erkennen.</p>
<p>Ergänzend sei an dieser Stelle noch der Log-Rank Test vorgestellt, der ohne Berücksichtigung von Kovariaten zwei oder mehr Gruppen in Hinblick Unterschiede zwischen den Kaplan-Meier Kurven vergleicht. So könnten wir beispielsweise die Kaplan-Meier Kurven der beiden erhobenen Geschlechter miteinander vergleichen. Der p-Wert des Log-Rank Tests wird wahlweise direkt in der Abbildung eingeblendet (siehe Kapitel <a href="visual.html#kaplan">8.13.1</a>). Generell kann man in Abbildung <a href="inductive.html#fig:survplot2">9.1</a> schon mit bloßem Auge eine Assoziation zwischen dem Überleben und dem biologischen Geschlecht vermuten, da die Prognose für Männer schlechter zu sein scheint.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:survplot2"></span>
<img src="r-empirische-wissenschaften_files/figure-html/survplot2-1.svg" alt="Kaplan-Meier-Kurve unterteilt nach biologischem Geschlecht." width="672" height="384" />
<p class="caption">
Abbildung 9.1: Kaplan-Meier-Kurve unterteilt nach biologischem Geschlecht.
</p>
</div>
<p>Den dazugehörigen Log-Rank Test berechnen wir mit der Funktion <code>survdiff()</code> aus dem <code>survival</code> Package. Ansonsten ändert sich nichts im Bezug auf die Schreibweise im Vergleich zur zuvor kennengelenrten Cox Regression.</p>
<div class="sourceCode" id="cb553"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb553-1"><a href="inductive.html#cb553-1" tabindex="-1"></a><span class="fu">survdiff</span>(</span>
<span id="cb553-2"><a href="inductive.html#cb553-2" tabindex="-1"></a>  <span class="at">formula =</span> <span class="fu">Surv</span>(<span class="at">time =</span> Beob_zeit, <span class="at">event =</span> Status) <span class="sc">~</span> Geschlecht, </span>
<span id="cb553-3"><a href="inductive.html#cb553-3" tabindex="-1"></a>  <span class="at">data =</span> chemo</span>
<span id="cb553-4"><a href="inductive.html#cb553-4" tabindex="-1"></a>)</span></code></pre></div>
<pre class="bordercode"><code>Call:
survdiff(formula = Surv(time = Beob_zeit, event = Status) ~ Geschlecht, 
    data = chemo)

               N Observed Expected (O-E)^2/E (O-E)^2/V
Geschlecht=f 235      205      265      13.5      40.5
Geschlecht=m 215      202      142      25.3      40.5

 Chisq= 40.5  on 1 degrees of freedom, p= 2e-10 </code></pre>
<p>Auch hier finden wir einen statistisch signifikanten Zusammenhang zwischen dem Geschlecht und der Überlebenszeit. Zusätzlich werden die beobachteten und erwarteten Häufigkeiten ausgegeben, die zur Berechnung miteinander verglichen wurden.</p>
</div>
</div>
<div id="contingency" class="section level2 hasAnchor" number="9.6">
<h2><span class="header-section-number">9.6</span> Kontingenztafeln<a href="inductive.html#contingency" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="fisher" class="section level3 hasAnchor" number="9.6.1">
<h3><span class="header-section-number">9.6.1</span> Exakter Fisher Test<a href="inductive.html#fisher" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Zur Berechnung der Effektstärken muss das <code>effectsize</code> Package installiert und geladen werden.</p>
<div class="sourceCode" id="cb555"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb555-1"><a href="inductive.html#cb555-1" tabindex="-1"></a><span class="fu">library</span>(effectsize)</span></code></pre></div>
<p>Die Erstellung von Kontingenztafeln wurde bereits in Kapitel <a href="descr.html#contigency">7.2</a> eingeführt (Synonym: Kreuztabellen). Durch Erstellung dieser Kontingenztafeln können wir die Unabhängigkeit zweier kategoriale Merkmale systematisch überprüfen. Wir möchten wissen, ob ein stationärer Aufenthalt aufgrund irgendeiner Erkrankung abhängig vom biologischen Geschlecht ist. Zunächst müssen wir dafür die Kontingenztafel erstellen.</p>
<div class="sourceCode" id="cb556"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb556-1"><a href="inductive.html#cb556-1" tabindex="-1"></a>tbl1 <span class="ot">&lt;-</span> <span class="fu">table</span>(chemo<span class="sc">$</span>Geschlecht, chemo<span class="sc">$</span>Stationaer)</span>
<span id="cb556-2"><a href="inductive.html#cb556-2" tabindex="-1"></a>tbl1</span></code></pre></div>
<pre class="bordercode"><code>   
      0   1
  f 216  19
  m 194  21</code></pre>
<p>Im Kontext von <span class="math inline">\(2 \times 2\)</span> Tabellen und relativ kleinen Stichproben verwenden wir den exakten Test nach Fisher. Es gibt eine umstrittene Daumenregel, die besagt, dass dieser Test nur bei einer Stichprobengröße kleiner als 1000 mit mindestens einer Zelle mit einer Häufigkeit von weniger als fünf verwendet wird. Ansonsten wird der im folgenden Kapitel erklärte <span class="math inline">\(\chi^2\)</span> Test nach Pearson empfohlen. Heutige Computer können den exakten Fisher Test zwar auch problemlos bei größeren Stichproben berechnen, allerdings wird im Regelfall schon bei moderater Stichprobengröße eine <span class="math inline">\(\chi^2\)</span> Verteilung approximiert.</p>
<p>Die Funktion innerhalb von R heißt <code>fisher.test()</code>, welcher wir lediglich die Kontingenztafel übergeben müssen. Ein großer Vorteil des exakten Fisher Tests ist die Möglichkeit des gerichteten Hypothesentestens. Anstelle der Abhängigkeit beider Merkmale könnten wir uns also auch fragen, ob der stationäre Aufenthalt häufiger bei Männern oder weniger häufig ist. Dafür müssten wir das Argument <code>alternative</code> von <code>"two.sided"</code> auf <code>"less"</code> oder <code>"greater"</code> ändern.</p>
<div class="sourceCode" id="cb558"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb558-1"><a href="inductive.html#cb558-1" tabindex="-1"></a><span class="fu">fisher.test</span>(tbl1, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>) </span></code></pre></div>
<pre class="bordercode"><code>
    Fisher&#39;s Exact Test for Count Data

data:  tbl1
p-value = 0.6195
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
 0.6091001 2.4985032
sample estimates:
odds ratio 
   1.23003 </code></pre>
<p>Als Ausgabe erhalten wir das Odds Ratio mit 95% Konfidenzintervall und einen <em>p</em>-Wert. In unserem Beispiel ist dieser mit 0.6195 größer als das übliche <span class="math inline">\(\alpha\)</span>-Niveau von 0.05 und somit statistisch nicht signifikant. Es findet sich folglich keine Abhängigkeit zwischen dem Krankenhausaufenthalt und dem biologischen Geschlecht wieder. Effektstärken erhalten wir mit Funktionen aus dem <code>effectsize</code> Package. Im Falle einer <span class="math inline">\(2 \times 2\)</span> Tafel ist <span class="math inline">\(\phi\)</span> als Zusammenhangsmaß empfohlen, welches durch die Funktion <code>phi()</code> implementiert ist.</p>
<div class="sourceCode" id="cb560"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb560-1"><a href="inductive.html#cb560-1" tabindex="-1"></a><span class="fu">phi</span>(tbl1, <span class="at">adjust =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre class="bordercode"><code>Phi  |       95% CI
-------------------
0.03 | [0.00, 1.00]

- One-sided CIs: upper bound fixed at [1.00].</code></pre>
<p>Der marginale Effekt nahe Null passt zu unserem nicht-signifikanten Hypothesentest. Alternativ könnten wir bspw. auch Pearson’s C mit der Funktion <code>pearsons_c()</code> berechnen. Das relative Risiko erhalten wir durch <code>riskratio()</code> ebenfalls aus dem <code>effectsize</code> Package.</p>
<div class="sourceCode" id="cb562"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb562-1"><a href="inductive.html#cb562-1" tabindex="-1"></a><span class="fu">riskratio</span>(tbl1)</span></code></pre></div>
<pre class="bordercode"><code>Risk ratio |       95% CI
-------------------------
1.11       | [0.79, 1.56]</code></pre>
</div>
<div id="chi" class="section level3 hasAnchor" number="9.6.2">
<h3><span class="header-section-number">9.6.2</span> Chi Quadrat Tests<a href="inductive.html#chi" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Für dieses Kapitel muss das <code>effectsize</code> Package installiert und geladen sein.</p>
<div class="sourceCode" id="cb564"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb564-1"><a href="inductive.html#cb564-1" tabindex="-1"></a><span class="fu">library</span>(effectsize)</span></code></pre></div>
<p>Bei größeren Stichproben verwenden wir zum Vergleich zweier kategorialer Merkmale den <span class="math inline">\(\chi^2\)</span> Test nach Pearson. Auch hier wird eine mögliche Abhängigkeit bzw. ein Zusammenhang zwischen den Merkmalen durch die Alternativhypothese überprüft. Der Vorteil des <span class="math inline">\(\chi^2\)</span> Tests ist die Anwendung auch auf größeren Tafeln als <span class="math inline">\(2 \times 2\)</span>, der Nachteil ist die fehlende Möglichkeit gerichtete Hypothesen zu überprüfen.</p>
<p>Der <span class="math inline">\(\chi^2\)</span> Test nach Pearson ist in R in Form der Funktion <code>chisq.test()</code> enthalten. Zunächst möchten wir einen möglichen Zusammenhang zwischen dem stationären Aufenthalt im Krankenhaus und dem biologischen Geschlecht untersuchen. Dafür nehmen wir die im vorherigen Kapitel erstelle Kontingenztafel namens <code>tbl1</code>.</p>
<div class="sourceCode" id="cb565"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb565-1"><a href="inductive.html#cb565-1" tabindex="-1"></a><span class="fu">chisq.test</span>(tbl1)</span></code></pre></div>
<pre class="bordercode"><code>
    Pearson&#39;s Chi-squared test with Yates&#39; continuity correction

data:  tbl1
X-squared = 0.21214, df = 1, p-value = 0.6451</code></pre>
<p>Das Ergebnis ist in diesem Fall fast identisch mit dem des exakten Fisher Tests (siehe Kapitel <a href="inductive.html#fisher">9.6.1</a>). Da die Funktion hier nicht direkt das Odds Ratio mit ausgibt, können wir diese mithilfe der Funktion <code>oddsratio()</code> aus dem <code>effectsize</code> Package berechnen. Als Alternativ wäre an dieser Stelle je nach Studiendesign auch das relative Risiko als Effektstärke denkbar (siehe Kapitel <a href="inductive.html#fisher">9.6.1</a>).</p>
<div class="sourceCode" id="cb567"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb567-1"><a href="inductive.html#cb567-1" tabindex="-1"></a><span class="fu">oddsratio</span>(tbl1)</span></code></pre></div>
<pre class="bordercode"><code>Odds ratio |       95% CI
-------------------------
1.23       | [0.64, 2.36]</code></pre>
<p>Wir können mit dem <span class="math inline">\(\chi^2\)</span> Test auch zwei kategoriale Merkmale mit mehr als zwei Ausprägungen untersuchen. Uns interessiert an dieser Stelle, ob ein stationäre Aufenthalt von der Behandlungsart abhängt. Dafür erstellen wir uns zuerst die zugehörige Kontingenztafel (siehe Kapitel <a href="descr.html#contigency">7.2</a>).</p>
<div class="sourceCode" id="cb569"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb569-1"><a href="inductive.html#cb569-1" tabindex="-1"></a>tbl2 <span class="ot">&lt;-</span> <span class="fu">table</span>(chemo<span class="sc">$</span>Behandlung, chemo<span class="sc">$</span>Stationaer)</span>
<span id="cb569-2"><a href="inductive.html#cb569-2" tabindex="-1"></a>tbl2</span></code></pre></div>
<pre class="bordercode"><code>            
               0   1
  Radiochemo 144   7
  Chemo      139  11
  Radio      127  22</code></pre>
<p>Anschließend verwenden wir, wie zuvor, die Funktion <code>chisq.test()</code> mit der Kreuztabelle als alleiniges Argument.</p>
<div class="sourceCode" id="cb571"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb571-1"><a href="inductive.html#cb571-1" tabindex="-1"></a><span class="fu">chisq.test</span>(tbl2)</span></code></pre></div>
<pre class="bordercode"><code>
    Pearson&#39;s Chi-squared test

data:  tbl2
X-squared = 10.174, df = 2, p-value = 0.006178</code></pre>
<p>Zurückgegeben wird die Teststatistik in Form des <span class="math inline">\(\chi^2\)</span>-Wertes, die Freiheitsgrade (<code>df</code>) und der <em>p</em>-Wert. In diesem Fall liegt ein Zusammenhang zwischen dem stationären Aufenthalt und der Behandlungsform vor, da der <em>p</em>-Wert mit 0.006178 kleiner als 0.05 ist. Welche Behandlung häufiger zu einem stationären Aufenthalt führt, vermögen wir aufgrund des <span class="math inline">\(\chi^2\)</span> Tests nicht zu sagen. Eine geeignete Effektstärke für Tafeln, die größer als <span class="math inline">\(2 \times 2\)</span> sind, bietet Cramers V (<code>cramers_v</code>) aus dem <code>effectsize</code> Package.</p>
<div class="sourceCode" id="cb573"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb573-1"><a href="inductive.html#cb573-1" tabindex="-1"></a><span class="fu">cramers_v</span>(tbl2)</span></code></pre></div>
<pre class="bordercode"><code>Cramer&#39;s V (adj.) |       95% CI
--------------------------------
0.13              | [0.00, 1.00]

- One-sided CIs: upper bound fixed at [1.00].</code></pre>
<p>Bei abhängigen (gepaarten) Merkmalen ist der <span class="math inline">\(\chi^2\)</span> Test nach McNemar die Methode der Wahl. Ein häufiger Anwendungsfall ist daher der Kontext einer Messung zu zwei verschiedenen Zeitpunkten oder mittels zwei verschiedenen Verfahren. Hier schauen wir uns an, ob die Qualität zwischen PCR-Test und Antigen-Schnelltest bei der Diagnostik des SARS-CoV-2 Virus nennenswert unterschiedlich ist. Der zugehörige Datensatz aus dem <a href="https://r-empirische-wissenschaften.de/">remp</a> heißt <code>covid</code>.</p>
<div class="sourceCode" id="cb575"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb575-1"><a href="inductive.html#cb575-1" tabindex="-1"></a>covid</span></code></pre></div>
<pre class="bordercode"><code>         Schnelltest
PCR       Positiv Negativ
  Positiv      35      14
  Negativ       8    2421</code></pre>
<p>Anschließend übergeben wir die Kontingenztafel der Funktion <code>mcnemar.test()</code>.</p>
<div class="sourceCode" id="cb577"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb577-1"><a href="inductive.html#cb577-1" tabindex="-1"></a><span class="fu">mcnemar.test</span>(covid) </span></code></pre></div>
<pre class="bordercode"><code>
    McNemar&#39;s Chi-squared test with continuity correction

data:  covid
McNemar&#39;s chi-squared = 1.1364, df = 1, p-value = 0.2864</code></pre>
<p>Da der <em>p</em>-Wert mit 0.2864 in diesem Fall größer als das in der Wissenschaft übliche <span class="math inline">\(\alpha\)</span>-Niveau von 0.05 ist, behalten wir die Nullhypothese bei. Es besteht also kein nennenswerter Unterschied zwischen beiden diagnostischen Verfahren, auch wenn der Antigen-Schnelltest offensichtlich 8 falsch positive und 14 falsch negative Ergebnisse produziert hat. Bei beiden Verfahren können wir mithilfe des <code>correct</code> Arguments die Korrekturen ausschalten.</p>
<p>Eine adäquate Effektstärke wäre in diesem Fall Cohens g, welche ebenfalls im <code>effectsize</code> Package implementiert ist.</p>
<div class="sourceCode" id="cb579"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb579-1"><a href="inductive.html#cb579-1" tabindex="-1"></a><span class="fu">cohens_g</span>(covid)</span></code></pre></div>
<pre class="bordercode"><code>Cohen&#39;s g |        95% CI
-------------------------
0.14      | [-0.07, 0.30]</code></pre>
<div class="idea">
<p>Durch die Quadrierung geht bei <span class="math inline">\(\chi^2\)</span> Tests jede Richtung verloren. Als Konsequenz können ausschließlich zweiseitige Hypothesen getestet werden. Bei kleinen bis moderaten Stichproben in Form von <span class="math inline">\(2 \times 2\)</span> Tafeln bietet der exakte Fisher Test eine Alternative für gerichtete Hypothesen.</p>
</div>
</div>
</div>
<div id="voraussetzung" class="section level2 hasAnchor" number="9.7">
<h2><span class="header-section-number">9.7</span> Voraussetzungen überprüfen<a href="inductive.html#voraussetzung" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="normalverteilung" class="section level3 hasAnchor" number="9.7.1">
<h3><span class="header-section-number">9.7.1</span> Normalverteilung<a href="inductive.html#normalverteilung" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Zur graphischen Überprüfung der Verteilungsannahmen muss das Package <code>ggfortify</code> installiert und geladen werden.</p>
<div class="sourceCode" id="cb581"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb581-1"><a href="inductive.html#cb581-1" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span></code></pre></div>
<p>Eine der gängigsten statistischen Methoden zur Überprüfung des Vorliegens einer Normalverteilung ist der Shapiro-Wilk Test. Dieser ist in Form der Funktion <code>shapiro.test()</code> direkt in R integriert. Als Argument übergeben wir die entsprechende Variable als Vektor (bzw. Wertereihe) mithilfe des Dollar-Operators (siehe Kapitel <a href="vars.html#dollar">4.5</a>). Die Leukozytenanzahl nach sechs Monaten Behandlung wurde in diversen Kapitels dieses Buches als normalverteilt angenommen. Nun können wir überprüfen, ob diese Annahme zutreffen war.</p>
<div class="sourceCode" id="cb582"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb582-1"><a href="inductive.html#cb582-1" tabindex="-1"></a><span class="fu">shapiro.test</span>(chemo<span class="sc">$</span>Leukos_t6)</span></code></pre></div>
<pre class="bordercode"><code>
    Shapiro-Wilk normality test

data:  chemo$Leukos_t6
W = 0.99747, p-value = 0.7284</code></pre>
<p>Der <em>p</em>-Wert ist mit 0.7284 größer als das gängige <span class="math inline">\(\alpha\)</span>-Niveau von 0.05, weswegen wir die Nullhypothese beibehalten und von normalverteilten Daten ausgehen können. Ein weiterer Anwendungsfall ist die Überprüfung der Normalverteilung der Residuen eines Regressionsmodells. Die Berechnung der Residuen erfolgt durch die in R enthaltene Funktion <code>residuals()</code>.</p>
<div class="sourceCode" id="cb584"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb584-1"><a href="inductive.html#cb584-1" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Leukos_t6 <span class="sc">~</span> Alter <span class="sc">+</span> Geschlecht, <span class="at">data =</span> chemo)</span>
<span id="cb584-2"><a href="inductive.html#cb584-2" tabindex="-1"></a>resi <span class="ot">&lt;-</span> <span class="fu">residuals</span>(model1)</span></code></pre></div>
<p>Anschließend übergeben wir die in <code>resi</code> gespeicherten Residuen der Funktion <code>shapiro.test()</code>. Auch hier können wir von einer Normalverteilung ausgehen, weil der <em>p</em>-Wert in Höhe von 0.6904 größer als 0.05 ist.</p>
<div class="sourceCode" id="cb585"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb585-1"><a href="inductive.html#cb585-1" tabindex="-1"></a><span class="fu">shapiro.test</span>(resi)</span></code></pre></div>
<pre class="bordercode"><code>
    Shapiro-Wilk normality test

data:  resi
W = 0.99734, p-value = 0.6904</code></pre>
<p>Eine Alternative der Hypothesentests zur Überprüfung der Normalverteilung stellen graphische Vergleiche der Verteilungen mithilfe eines Quantil-Quantil Plots dar. In Kapitel <a href="visual.html#qqplot">8.8</a> haben wir bereits die Darstellung eines Q-Q Plots für intervallskalierte Variablen gesehen. Auch Residuen wurden bereits mit der Funktion <code>autoplot()</code> aus dem Package <code>ggfortify</code> unter anderem auf Normalverteilung überprüft (siehe Kapitel <a href="visual.html#residuals">8.13.2</a>). In Abbildung <a href="inductive.html#fig:resid">9.2</a> werden die Quantile der standardisierten Residuen (y-Achse) mit den theoretischen Quantilen der Normalverteilung durch <code>autoplot()</code> verglichen. Solange die Werte auf der Diagonalen liegen, kann von einer Normalverteilung ausgegangen werden.</p>
<div class="sourceCode" id="cb587"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb587-1"><a href="inductive.html#cb587-1" tabindex="-1"></a><span class="fu">autoplot</span>(model1, <span class="at">which =</span> <span class="dv">2</span>, <span class="at">label.repel =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:resid"></span>
<img src="r-empirische-wissenschaften_files/figure-html/resid-1.svg" alt="Graphische Überprüfungen der Normalverteilung der Residuen" width="672" height="384" />
<p class="caption">
Abbildung 9.2: Graphische Überprüfungen der Normalverteilung der Residuen
</p>
</div>
<div class="idea">
<p>Die meisten kennengelernten Verfahren sind relativ robust gegenüber leichteren Verletzungen der Annahme der Normalverteilung. Hypothesentests wie der Shapiro-Wilk Test sind in solchen Szenarien sehr sensibel gegenüber Verletzungen und verwerfen daher unter Umständen zu häufig die Nullhypothese des Vorliegens einer Normalverteilung. Daher sollte in jedem Fall eine graphische Überprüfung mittels Q-Q Plots erfolgen.</p>
</div>
</div>
<div id="varianzhomogenitaet" class="section level3 hasAnchor" number="9.7.2">
<h3><span class="header-section-number">9.7.2</span> Varianzhomogenität und Homoskedastizität<a href="inductive.html#varianzhomogenitaet" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Für dieses Kapitel muss das <code>car</code> Package installiert und geladen werden.</p>
<div class="sourceCode" id="cb588"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb588-1"><a href="inductive.html#cb588-1" tabindex="-1"></a><span class="fu">library</span>(car)</span></code></pre></div>
<p>Viele parametrische statistische Verfahren können nur bei gegebener Varianzhomogenität fehlerfrei geschätzt werden. Zur Überprüfung der Varianzgleichheit zweier Gruppen verwenden wir den <em>F</em> Test, welcher durch die Funktion <code>var.test()</code> in R implementiert ist.</p>
<p>An dieser Stelle möchten wir die Varianz der Leukozytenanzahl nach sechs Monaten Therapie zwischen zwei biologischen Geschlechtern vergleichen. Dafür wird die intervallskalierte Variable auf die linke Seite der Tilde und die nominale auf die rechte Seite geschrieben. Beachte, dass nur zwei Gruppen verglichen werden können. Schließlich werden die beiden Varianzen direkt miteinander ins Verhältnis gesetzt. Ein <em>F</em>-Wert von 1 entspricht demnach einer Varianzhomogenität (Nullhypothese).</p>
<div class="sourceCode" id="cb589"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb589-1"><a href="inductive.html#cb589-1" tabindex="-1"></a><span class="fu">var.test</span>(Leukos_t6 <span class="sc">~</span> Geschlecht, <span class="at">data =</span> chemo)</span></code></pre></div>
<pre class="bordercode"><code>
    F test to compare two variances

data:  Leukos_t6 by Geschlecht
F = 0.85053, num df = 234, denom df = 214, p-value = 0.2256
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.6534313 1.1053574
sample estimates:
ratio of variances 
         0.8505318 </code></pre>
<p>Als Ergebnis erhalten wir den <em>F</em> Wert, die Freiheitsgrade, <em>p</em>-Wert und das 95% Konfidenzintervall. Da in diesem Fall die kleiner Varianz der Frauen (0.101) durch die der Männer (0.119) geteilt wird, erhalten wir einen <em>F</em>-Wert kleiner 1. Welche Gruppe im Zähler und welche im Nenner steht, kann explizit durch Umwandlung in einen Faktor kontrolliert werden (siehe Kapitel <a href="datenvorbereitung.html#datafactor">6.10</a>). Der <em>F</em>-Wert ist zwar kleiner als 1, allerdings nicht statistisch signifikant, da der <em>p</em>-Wert in Höhe von 0.2256 größer als das häufig gewählte <span class="math inline">\(\alpha\)</span>-Niveau von 0.05 ist. Die Nullhypothese der Varianzhomogenität wird demnach beibehalten.</p>
<p>Beim Vergleich der Varianz von drei oder mehr Gruppen können wir zwischen dem Levene Test und Bartlett Test wählen. Für den Levene Test verwenden wir die Funktion <code>leveneTest()</code> aus dem <code>car</code> Package. Beachte an dieser Stelle, die abweichende Schreibweise der Funktion mit einem Großbuchstaben beim Wort Test. Wir möchten nun überprüfen, ob die Varianz der Leukozytenanzahl zwischen den Behandlungsarten gleich ist. Dafür übergeben wir auf der linken Seite der Tilde erneut die intervallskalierte Variable und auf der rechten Seite das nominalskalierte Merkmal.</p>
<div class="sourceCode" id="cb591"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb591-1"><a href="inductive.html#cb591-1" tabindex="-1"></a><span class="fu">leveneTest</span>(Leukos_t6 <span class="sc">~</span> Behandlung, <span class="at">data =</span> chemo)</span></code></pre></div>
<pre class="bordercode"><code>Levene&#39;s Test for Homogeneity of Variance (center = median)
       Df F value Pr(&gt;F)
group   2  0.3454 0.7081
      447               </code></pre>
<p>Wir erhalten auch hier die Teststatistik eines <em>F</em>-Wertes, die Freiheitsgrade und den <em>p</em>-Wert. Da der <em>p</em>-Wert mit 0.7081 bei eine <span class="math inline">\(\alpha\)</span>-Niveau von 5% nicht statistisch signifikant ist, behalten wir auch hier die Nullhypothese der Varianzhomogenität bei.</p>
<p>Für die Durchführung des Bartlett Test ändert sich im Vergleich zum Levene Test nur der Funktionsaufruf zu <code>bartlett.test()</code>.</p>
<div class="sourceCode" id="cb593"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb593-1"><a href="inductive.html#cb593-1" tabindex="-1"></a><span class="fu">bartlett.test</span>(Leukos_t6 <span class="sc">~</span> Behandlung, <span class="at">data =</span> chemo)</span></code></pre></div>
<pre class="bordercode"><code>
    Bartlett test of homogeneity of variances

data:  Leukos_t6 by Behandlung
Bartlett&#39;s K-squared = 1.785, df = 2, p-value = 0.4096</code></pre>
<p>Hier kommen wir ebenfalls zur Schlussfolgerung vorliegender Varianzhomogenität, da der <em>p</em>-Wert von 0.4096 ebenfalls nicht statistisch signifikant ist.</p>
<p>Eine Voraussetzung für die Regressionsanalysen ist die Homoskedastizität, welche die Gleichheit der Varianz der Residuen über den gesamten Parameterraum beschreibt. Die beste Überprüfung erfolgt graphisch durch das Auftragen der Residuen gegen die vorhergesagten Werte. Homoskedastizität ist gegeben, solange die Werte gleichmäßig um die horizontale Nulllinie der y-Achse streuen. Die dafür verwendete Funktion <code>autoplot()</code> wurde bereits im Kapitel <a href="visual.html#residuals">8.13.2</a> vorgestellt.</p>
<div class="sourceCode" id="cb595"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb595-1"><a href="inductive.html#cb595-1" tabindex="-1"></a><span class="fu">autoplot</span>(model1, <span class="at">which =</span> <span class="dv">1</span>, <span class="at">label.repel =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:resid2"></span>
<img src="r-empirische-wissenschaften_files/figure-html/resid2-1.svg" alt="Graphische Überprüfungen der Homoskedastizität der Residuen." width="672" height="384" />
<p class="caption">
Abbildung 9.3: Graphische Überprüfungen der Homoskedastizität der Residuen.
</p>
</div>
<div class="idea">
<p>Bei Überprüfung der Varianzhomogenität von zwei Gruppen greifen wir auf den klassischen <em>F</em> Test zurück. Bei nominalen Merkmalen mit drei oder mehr Ausprägungen sind sowohl der Levene Test als auch der Bartlett Test Methoden der ersten Wahl. Im Kontext von Regressionsanalysen kann die Varianzhomogenität der Residuen (Homoskedastizität) am besten graphisch überprüft werden (siehe Abbildung <a href="inductive.html#fig:resid2">9.3</a>).</p>
</div>
</div>
</div>
<div id="broom" class="section level2 hasAnchor" number="9.8">
<h2><span class="header-section-number">9.8</span> Ergebnisse formatieren<a href="inductive.html#broom" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Für das Umformatieren in Tabellenform muss das <code>broom</code> Package installiert und geladen sein.</p>
<div class="sourceCode" id="cb596"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb596-1"><a href="inductive.html#cb596-1" tabindex="-1"></a><span class="fu">library</span>(broom)</span></code></pre></div>
<p>Als erstes Beispiel verwenden wir das lineare Regressionsmodell aus Kapitel <a href="inductive.html#linregression">9.5.1</a> und nennen die Ergebnisliste <code>model1</code>.</p>
<div class="sourceCode" id="cb597"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb597-1"><a href="inductive.html#cb597-1" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Leukos_t6 <span class="sc">~</span> Alter <span class="sc">+</span> Geschlecht, <span class="at">data =</span> chemo)</span></code></pre></div>
<p>Die wichtigsten Informationen werden mit der Funktion <code>tidy()</code> ausgegeben, welche als einziges Argument die Variable mit dem Modell benötigt. Die <span class="math inline">\(\beta\)</span>-Koeffizienten sind in der Spalte namens <code>estimate</code>. Die Spalte <code>statistic</code> bezieht sich auf die <em>t</em>-Werte basierend auf den z-Werten der Wald Tests. Die <em>p</em>-Werte werden leider in <code>tibbles</code> immer in wissenschaftlicher Notation dargestellt. Bei der Kovariate <code>Alter</code> ist der <em>p</em>-Wert 1.69e-2, also <span class="math inline">\(1.69 * 10^{-2}\)</span>, und entspricht somit der Zahl 0.0169. Äquivalent dazu ist der <em>p</em>-Wert für die Kovariate <code>Geschlecht</code> 0.102, weil dies eine andere Schreibweise für <span class="math inline">\(1.02 * 10^{-1}\)</span> darstellt, welches in R als 1.02e-1 angezeigt wird.</p>
<div class="sourceCode" id="cb598"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb598-1"><a href="inductive.html#cb598-1" tabindex="-1"></a><span class="fu">tidy</span>(model1)</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 3 × 5
  term        estimate std.error statistic   p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)  5.61      0.162       34.6  1.49e-128
2 Alter        0.00868   0.00362      2.40 1.69e-  2
3 Geschlechtm -0.0511    0.0312      -1.64 1.02e-  1</code></pre>
<p>Zusätzliche Informationen wie die Varianzaufklärung (<span class="math inline">\(R^2\)</span>) oder Informationskriterien in Form des AIC und BIC erhalten wir durch die Funktion <code>glance()</code>. Außerdem ist hier die Teststatistik (F-Wert) des globalen F-Tests als <code>statistic</code> mit zugehörigem <em>p</em>-Wert und Freiheitsgrad (<code>df</code>) ausgegeben. Auch hier muss nur das Modell als Argument übergeben werden.</p>
<div class="sourceCode" id="cb600"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb600-1"><a href="inductive.html#cb600-1" tabindex="-1"></a><span class="fu">glance</span>(model1)</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic p.value    df logLik   AIC   BIC deviance df.residual
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt;
1    0.0174        0.0130 0.329      3.95  0.0200     2  -137.  283.  299.     48.5         447
# ℹ 1 more variable: nobs &lt;int&gt;</code></pre>
<p>Die Funktion <code>augment()</code> gibt unter anderem die geschätzten (<code>.fitted</code>) Werte, Cooks Distanz (<code>.cooksd</code>) und die Residuen (<code>.resid</code>) zurück.</p>
<div class="sourceCode" id="cb602"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb602-1"><a href="inductive.html#cb602-1" tabindex="-1"></a><span class="fu">augment</span>(model1)</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 450 × 9
  Leukos_t6 Alter Geschlecht .fitted  .resid    .hat .sigma   .cooksd .std.resid
      &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
1      5.68    49 f             6.04 -0.360  0.00676  0.329 0.00273       -1.10 
2      6.64    46 f             6.01  0.626  0.00455  0.328 0.00553        1.91 
3      5.97    41 m             5.92  0.0505 0.00667  0.330 0.0000530      0.154
4      5.55    43 f             5.99 -0.438  0.00451  0.329 0.00268       -1.33 
# ℹ 446 more rows</code></pre>
<p>Wir betrachten an dieser Stelle noch ein weiteres Beispiel anhand der Ergebnisse des t-Tests aus Kapitel <a href="inductive.html#ttest">9.2.1</a>. Hier entspricht <code>estimate</code> der Mittelwertsdifferenz, <code>estimate1</code> die mittlere Leukozytenzahl der Frauen und <code>estimate2</code> die der Männer. In der Spalte <code>statistic</code> wird der t-Wert abgebildet und als <code>parameter</code> die Freiheitsgrade. Leider sind die Bezeichnungen nicht immer eindeutig, weswegen ein Vergleich mit der originalen Ausgabe empfohlen ist.</p>
<div class="sourceCode" id="cb604"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb604-1"><a href="inductive.html#cb604-1" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(Leukos_t6 <span class="sc">~</span> Geschlecht, <span class="at">data =</span> chemo, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb604-2"><a href="inductive.html#cb604-2" tabindex="-1"></a><span class="fu">tidy</span>(model2)</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 1 × 10
  estimate estimate1 estimate2 statistic p.value parameter conf.low conf.high method           
     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;            
1   0.0455      6.00      5.95      1.46   0.146       448  -0.0159     0.107 Two Sample t-test
# ℹ 1 more variable: alternative &lt;chr&gt;</code></pre>
<p>Die Funktion <code>glance()</code> gibt hier dasselbe Ergebnis zurück wie <code>tidy()</code> und <code>augment()</code> kann in diesem Fall nicht verwendet werden.</p>
<div class="idea">
<p>Während <code>tidy()</code> mit Ausnahme der Varianzanalyse mit Messwiederholung für alle hier vorgestellten statistischen Modellen funktioniert, können <code>glance()</code> und <code>augment()</code> nicht immer angewendet werden. Die aktuelle Liste der unterstützten Funktionen kann in der Dokumentation des <code>broom</code> Packages eingesehen werden.</p>
</div>
<div class="idea">
<p>Beachte, dass die genaue Ausgabe von <code>tidy()</code>, <code>glance()</code> und <code>augment()</code> je nach statistischem Modell unterschiedlich ist. So kann die Spalte <code>estimate</code> bei einem Modell für einen t-Wert stehen, während damit beim Betrachten einer Regression <span class="math inline">\(\beta\)</span>-Koeffizienten gemeint sind.</p>
</div>
<p>Da wir die Ergebnisse nun als <code>tibble</code> in Tabellenform vorliegen haben, kannst du diese im nächsten Schritt in das Textverarbeitungsprogramm deiner Wahl exportieren.</p>

</div>
</div>



</div>
<script data-goatcounter="https://remp.goatcounter.com/count" async src="https://gc.zgo.at/count.js"></script>
            </section>

          </div>
        </div>
      </div>
<a href="visual.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ergebnisse-exportieren.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"toc_depth": 3,
"info": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
