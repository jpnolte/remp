<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Kapitel 6 Datenvorbereitung | R für empirische Wissenschaften</title>
  <meta name="description" content="Das ist ein Test" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Kapitel 6 Datenvorbereitung | R für empirische Wissenschaften" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/logo.png" />
  <meta property="og:description" content="Das ist ein Test" />
  <meta name="github-repo" content="j3ypi/remp" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Kapitel 6 Datenvorbereitung | R für empirische Wissenschaften" />
  
  <meta name="twitter:description" content="Das ist ein Test" />
  <meta name="twitter:image" content="images/logo.png" />

<meta name="author" content="Jan Philipp Nolte" />


<meta name="date" content="2021-03-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="images/touch-icon.png" />
  <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="io.html"/>
<link rel="next" href="descr.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0CMQHQ9L4L"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-189972467-1');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { } /* Alert */
code span.an { } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { } /* ControlFlow */
code span.ch { color: #0e7a0e; } /* Char */
code span.cn { } /* Constant */
code span.co { } /* Comment */
code span.cv { color: #0e7a0e; } /* CommentVar */
code span.do { } /* Documentation */
code span.er { font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fu { color: #e65100; } /* Function */
code span.im { } /* Import */
code span.in { } /* Information */
code span.kw { color: #e65100; } /* Keyword */
code span.op { } /* Operator */
code span.ot { } /* Other */
code span.pp { } /* Preprocessor */
code span.sc { } /* SpecialChar */
code span.ss { } /* SpecialString */
code span.st { color: #0e7a0e; } /* String */
code span.va { } /* Variable */
code span.vs { color: #0e7a0e; } /* VerbatimString */
code span.wa { font-weight: bold; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="toc.css" type="text/css" />
<link rel="stylesheet" href="font-awesome.min.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="https://r-empirische-wissenschaften.de"> R für empirische Wissenschaften</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Vorwort</a></li>
<li class="part"><span><b>I Die ersten Schritte</b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Einleitung</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#für-wen-ist-dieses-buch"><i class="fa fa-check"></i><b>1.1</b> Für wen ist dieses Buch?</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#aufbau-und-bearbeitungsstrategie"><i class="fa fa-check"></i><b>1.2</b> Aufbau und Bearbeitungsstrategie</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#boxen-übungen-und-datensätze"><i class="fa fa-check"></i><b>1.3</b> Boxen, Übungen und Datensätze</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#books"><i class="fa fa-check"></i><b>1.4</b> Ergänzende Literatur</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="start.html"><a href="start.html"><i class="fa fa-check"></i><b>2</b> Startvoraussetzungen</a>
<ul>
<li class="chapter" data-level="2.1" data-path="start.html"><a href="start.html#installation-von-r-und-rstudio"><i class="fa fa-check"></i><b>2.1</b> Installation von R und RStudio</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="start.html"><a href="start.html#installr"><i class="fa fa-check"></i><b>2.1.1</b> Programmiersprache R</a></li>
<li class="chapter" data-level="2.1.2" data-path="start.html"><a href="start.html#rstudio"><i class="fa fa-check"></i><b>2.1.2</b> Programmierumgebung RStudio</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="start.html"><a href="start.html#aufbau"><i class="fa fa-check"></i><b>2.2</b> Aufbau von RStudio</a></li>
<li class="chapter" data-level="2.3" data-path="start.html"><a href="start.html#anpassung"><i class="fa fa-check"></i><b>2.3</b> RStudio anpassen</a></li>
<li class="chapter" data-level="2.4" data-path="start.html"><a href="start.html#funktionen-und-ihre-argumente"><i class="fa fa-check"></i><b>2.4</b> Funktionen und ihre Argumente</a></li>
<li class="chapter" data-level="2.5" data-path="start.html"><a href="start.html#packages"><i class="fa fa-check"></i><b>2.5</b> Packages (Erweiterungen)</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="start.html"><a href="start.html#installieren-und-laden"><i class="fa fa-check"></i><b>2.5.1</b> Installieren und laden</a></li>
<li class="chapter" data-level="2.5.2" data-path="start.html"><a href="start.html#notwendige-packages"><i class="fa fa-check"></i><b>2.5.2</b> Notwendige Packages</a></li>
<li class="chapter" data-level="2.5.3" data-path="start.html"><a href="start.html#namespace"><i class="fa fa-check"></i><b>2.5.3</b> Namespace</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="start.html"><a href="start.html#help"><i class="fa fa-check"></i><b>2.6</b> Fehler- und Warnmeldungen</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="start.html"><a href="start.html#der-unterschied"><i class="fa fa-check"></i><b>2.6.1</b> Der Unterschied</a></li>
<li class="chapter" data-level="2.6.2" data-path="start.html"><a href="start.html#hilfe"><i class="fa fa-check"></i><b>2.6.2</b> Wo bekomme ich Hilfe?</a></li>
<li class="chapter" data-level="2.6.3" data-path="start.html"><a href="start.html#fehler-beheben"><i class="fa fa-check"></i><b>2.6.3</b> Fehler beheben</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="start.html"><a href="start.html#historische-relikte"><i class="fa fa-check"></i><b>2.7</b> Historische Relikte</a></li>
</ul></li>
<li class="part"><span><b>II Vorbereitung</b></span></li>
<li class="chapter" data-level="3" data-path="project.html"><a href="project.html"><i class="fa fa-check"></i><b>3</b> Projektorientierung</a>
<ul>
<li class="chapter" data-level="3.1" data-path="project.html"><a href="project.html#das-problem"><i class="fa fa-check"></i><b>3.1</b> Das Problem</a></li>
<li class="chapter" data-level="3.2" data-path="project.html"><a href="project.html#r-projekte-erstellen"><i class="fa fa-check"></i><b>3.2</b> R Projekte erstellen</a></li>
<li class="chapter" data-level="3.3" data-path="project.html"><a href="project.html#here"><i class="fa fa-check"></i><b>3.3</b> Das <code>here</code> Package</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="vars.html"><a href="vars.html"><i class="fa fa-check"></i><b>4</b> Variablen</a>
<ul>
<li class="chapter" data-level="4.1" data-path="vars.html"><a href="vars.html#pfeil"><i class="fa fa-check"></i><b>4.1</b> Variablen speichern und verwenden</a></li>
<li class="chapter" data-level="4.2" data-path="vars.html"><a href="vars.html#datentypen"><i class="fa fa-check"></i><b>4.2</b> Grundlegende Datentypen</a></li>
<li class="chapter" data-level="4.3" data-path="vars.html"><a href="vars.html#datentypen-konvertieren"><i class="fa fa-check"></i><b>4.3</b> Datentypen konvertieren</a></li>
<li class="chapter" data-level="4.4" data-path="vars.html"><a href="vars.html#factor"><i class="fa fa-check"></i><b>4.4</b> Faktoren</a></li>
<li class="chapter" data-level="4.5" data-path="vars.html"><a href="vars.html#zeitdaten"><i class="fa fa-check"></i><b>4.5</b> Zeitdaten</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="io.html"><a href="io.html"><i class="fa fa-check"></i><b>5</b> Datensätze</a>
<ul>
<li class="chapter" data-level="5.1" data-path="io.html"><a href="io.html#einlesen-externer-dateien"><i class="fa fa-check"></i><b>5.1</b> Einlesen externer Dateien</a></li>
<li class="chapter" data-level="5.2" data-path="io.html"><a href="io.html#datensätze-aus-packages-laden"><i class="fa fa-check"></i><b>5.2</b> Datensätze aus Packages laden</a></li>
<li class="chapter" data-level="5.3" data-path="io.html"><a href="io.html#inR"><i class="fa fa-check"></i><b>5.3</b> Datensätze in R erstellen</a></li>
<li class="chapter" data-level="5.4" data-path="io.html"><a href="io.html#speichern-und-konvertieren"><i class="fa fa-check"></i><b>5.4</b> Speichern und Konvertieren</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html"><i class="fa fa-check"></i><b>6</b> Datenvorbereitung</a>
<ul>
<li class="chapter" data-level="6.1" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#tidyverse"><i class="fa fa-check"></i><b>6.1</b> Einführung</a></li>
<li class="chapter" data-level="6.2" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#select"><i class="fa fa-check"></i><b>6.2</b> <code>select()</code>, <code>rename()</code> und <code>relocate()</code></a></li>
<li class="chapter" data-level="6.3" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#filter"><i class="fa fa-check"></i><b>6.3</b> <code>filter()</code> und <code>arrange()</code></a></li>
<li class="chapter" data-level="6.4" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#mutate"><i class="fa fa-check"></i><b>6.4</b> <code>mutate()</code> und <code>across()</code></a></li>
<li class="chapter" data-level="6.5" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#function"><i class="fa fa-check"></i><b>6.5</b> Eigene Funktionen</a></li>
<li class="chapter" data-level="6.6" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#rowwise-und-c_across"><i class="fa fa-check"></i><b>6.6</b> <code>rowwise()</code> und <code>c_across()</code></a></li>
<li class="chapter" data-level="6.7" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#tidy"><i class="fa fa-check"></i><b>6.7</b> Breites und langes Datenformat</a></li>
<li class="chapter" data-level="6.8" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#spalten-trennen"><i class="fa fa-check"></i><b>6.8</b> Spalten trennen</a></li>
<li class="chapter" data-level="6.9" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#datensätze-zusammenführen"><i class="fa fa-check"></i><b>6.9</b> Datensätze zusammenführen</a></li>
<li class="chapter" data-level="6.10" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#datastring"><i class="fa fa-check"></i><b>6.10</b> Character Manipulation</a></li>
<li class="chapter" data-level="6.11" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#datafactor"><i class="fa fa-check"></i><b>6.11</b> Faktoren verändern</a></li>
<li class="chapter" data-level="6.12" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#datazeit"><i class="fa fa-check"></i><b>6.12</b> Mit Zeitdaten arbeiten</a></li>
<li class="chapter" data-level="6.13" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#binäre-antwortmatrix-erstellen"><i class="fa fa-check"></i><b>6.13</b> Binäre Antwortmatrix erstellen</a></li>
</ul></li>
<li class="part"><span><b>III Auswertung</b></span></li>
<li class="chapter" data-level="7" data-path="descr.html"><a href="descr.html"><i class="fa fa-check"></i><b>7</b> Deskriptive Statistik</a>
<ul>
<li class="chapter" data-level="7.1" data-path="descr.html"><a href="descr.html#verschiedene-lagemaße"><i class="fa fa-check"></i><b>7.1</b> Verschiedene Lagemaße</a></li>
<li class="chapter" data-level="7.2" data-path="descr.html"><a href="descr.html#umgang-mit-fehlenden-werten"><i class="fa fa-check"></i><b>7.2</b> Umgang mit fehlenden Werten</a></li>
<li class="chapter" data-level="7.3" data-path="descr.html"><a href="descr.html#contigency"><i class="fa fa-check"></i><b>7.3</b> Häufigkeiten und Kontingenztafeln</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="visual.html"><a href="visual.html"><i class="fa fa-check"></i><b>8</b> Visualisierungen</a>
<ul>
<li class="chapter" data-level="8.1" data-path="visual.html"><a href="visual.html#einführung"><i class="fa fa-check"></i><b>8.1</b> Einführung</a></li>
<li class="chapter" data-level="8.2" data-path="visual.html"><a href="visual.html#histogram"><i class="fa fa-check"></i><b>8.2</b> Histogramm und Dichte</a></li>
<li class="chapter" data-level="8.3" data-path="visual.html"><a href="visual.html#streudiagramm"><i class="fa fa-check"></i><b>8.3</b> Streudiagramm</a></li>
<li class="chapter" data-level="8.4" data-path="visual.html"><a href="visual.html#boxplot"><i class="fa fa-check"></i><b>8.4</b> Boxplot</a></li>
<li class="chapter" data-level="8.5" data-path="visual.html"><a href="visual.html#violin"><i class="fa fa-check"></i><b>8.5</b> Violin Plot</a></li>
<li class="chapter" data-level="8.6" data-path="visual.html"><a href="visual.html#barplot"><i class="fa fa-check"></i><b>8.6</b> Balkendiagramm</a></li>
<li class="chapter" data-level="8.7" data-path="visual.html"><a href="visual.html#anovaplot"><i class="fa fa-check"></i><b>8.7</b> Liniendiagramm</a></li>
<li class="chapter" data-level="8.8" data-path="visual.html"><a href="visual.html#kaplan-meier-kurve"><i class="fa fa-check"></i><b>8.8</b> Kaplan-Meier-Kurve</a></li>
<li class="chapter" data-level="8.9" data-path="visual.html"><a href="visual.html#odds"><i class="fa fa-check"></i><b>8.9</b> Odds Ratios</a></li>
<li class="chapter" data-level="8.10" data-path="visual.html"><a href="visual.html#q-q-plot"><i class="fa fa-check"></i><b>8.10</b> Q-Q Plot</a></li>
<li class="chapter" data-level="8.11" data-path="visual.html"><a href="visual.html#ellipsen"><i class="fa fa-check"></i><b>8.11</b> Ellipse</a></li>
<li class="chapter" data-level="8.12" data-path="visual.html"><a href="visual.html#morefactors"><i class="fa fa-check"></i><b>8.12</b> Mehrfaktorielle Abbildungen</a>
<ul>
<li class="chapter" data-level="8.12.1" data-path="visual.html"><a href="visual.html#groups"><i class="fa fa-check"></i><b>8.12.1</b> Gruppierungsargumente</a></li>
<li class="chapter" data-level="8.12.2" data-path="visual.html"><a href="visual.html#facets"><i class="fa fa-check"></i><b>8.12.2</b> Facets</a></li>
</ul></li>
<li class="chapter" data-level="8.13" data-path="visual.html"><a href="visual.html#patch"><i class="fa fa-check"></i><b>8.13</b> Anordnen mehrerer Graphen</a></li>
<li class="chapter" data-level="8.14" data-path="visual.html"><a href="visual.html#adapt"><i class="fa fa-check"></i><b>8.14</b> Anpassen des Aussehens</a></li>
<li class="chapter" data-level="8.15" data-path="visual.html"><a href="visual.html#ggsave"><i class="fa fa-check"></i><b>8.15</b> Speichern von Graphen</a></li>
<li class="chapter" data-level="8.16" data-path="visual.html"><a href="visual.html#example"><i class="fa fa-check"></i><b>8.16</b> Anwendungsbeispiel</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="inductive.html"><a href="inductive.html"><i class="fa fa-check"></i><b>9</b> Inferenzstatistik</a>
<ul>
<li class="chapter" data-level="9.1" data-path="inductive.html"><a href="inductive.html#einführung-1"><i class="fa fa-check"></i><b>9.1</b> Einführung</a></li>
<li class="chapter" data-level="9.2" data-path="inductive.html"><a href="inductive.html#normalverteilung-prüfen"><i class="fa fa-check"></i><b>9.2</b> Normalverteilung prüfen</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="inductive.html"><a href="inductive.html#shapiro-wilk-test"><i class="fa fa-check"></i><b>9.2.1</b> Shapiro-Wilk Test</a></li>
<li class="chapter" data-level="9.2.2" data-path="inductive.html"><a href="inductive.html#kolmogorov-smirnov-test"><i class="fa fa-check"></i><b>9.2.2</b> Kolmogorov-Smirnov Test</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="inductive.html"><a href="inductive.html#varianzhomogenität"><i class="fa fa-check"></i><b>9.3</b> Varianzhomogenität</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="inductive.html"><a href="inductive.html#f-test"><i class="fa fa-check"></i><b>9.3.1</b> <em>F</em> Test</a></li>
<li class="chapter" data-level="9.3.2" data-path="inductive.html"><a href="inductive.html#levene-test"><i class="fa fa-check"></i><b>9.3.2</b> Levene Test</a></li>
<li class="chapter" data-level="9.3.3" data-path="inductive.html"><a href="inductive.html#bartletts-test"><i class="fa fa-check"></i><b>9.3.3</b> Bartletts Test</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="inductive.html"><a href="inductive.html#ein--und-zweistichprobenszenarien"><i class="fa fa-check"></i><b>9.4</b> Ein- und Zweistichprobenszenarien</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="inductive.html"><a href="inductive.html#t-test-und-welch-test"><i class="fa fa-check"></i><b>9.4.1</b> <em>t</em> Test und Welch Test</a></li>
<li class="chapter" data-level="9.4.2" data-path="inductive.html"><a href="inductive.html#wilcoxon-test"><i class="fa fa-check"></i><b>9.4.2</b> Wilcoxon Test</a></li>
<li class="chapter" data-level="9.4.3" data-path="inductive.html"><a href="inductive.html#brunner-munzel-test"><i class="fa fa-check"></i><b>9.4.3</b> Brunner Munzel Test</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="inductive.html"><a href="inductive.html#unterschiede-mehrerer-gruppen"><i class="fa fa-check"></i><b>9.5</b> Unterschiede mehrerer Gruppen</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="inductive.html"><a href="inductive.html#aov"><i class="fa fa-check"></i><b>9.5.1</b> Varianzanalyse</a></li>
<li class="chapter" data-level="9.5.2" data-path="inductive.html"><a href="inductive.html#repeated"><i class="fa fa-check"></i><b>9.5.2</b> ANOVA mit Messwiederholung</a></li>
<li class="chapter" data-level="9.5.3" data-path="inductive.html"><a href="inductive.html#kruskal-wallis-test"><i class="fa fa-check"></i><b>9.5.3</b> Kruskal-Wallis Test</a></li>
<li class="chapter" data-level="9.5.4" data-path="inductive.html"><a href="inductive.html#friedman-test"><i class="fa fa-check"></i><b>9.5.4</b> Friedman Test</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="inductive.html"><a href="inductive.html#regressionsmodelle"><i class="fa fa-check"></i><b>9.6</b> Regressionsmodelle</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="inductive.html"><a href="inductive.html#linregression"><i class="fa fa-check"></i><b>9.6.1</b> Eindimensionale lineare Regression</a></li>
<li class="chapter" data-level="9.6.2" data-path="inductive.html"><a href="inductive.html#hierarchische-lineare-regression"><i class="fa fa-check"></i><b>9.6.2</b> Hierarchische lineare Regression</a></li>
<li class="chapter" data-level="9.6.3" data-path="inductive.html"><a href="inductive.html#logistische-regression"><i class="fa fa-check"></i><b>9.6.3</b> Logistische Regression</a></li>
<li class="chapter" data-level="9.6.4" data-path="inductive.html"><a href="inductive.html#baseline-logit-modell"><i class="fa fa-check"></i><b>9.6.4</b> Baseline Logit Modell</a></li>
<li class="chapter" data-level="9.6.5" data-path="inductive.html"><a href="inductive.html#kumulative-logit-modelle"><i class="fa fa-check"></i><b>9.6.5</b> Kumulative Logit Modelle</a></li>
<li class="chapter" data-level="9.6.6" data-path="inductive.html"><a href="inductive.html#cox-regression"><i class="fa fa-check"></i><b>9.6.6</b> Cox Regression</a></li>
<li class="chapter" data-level="9.6.7" data-path="inductive.html"><a href="inductive.html#zeitreihenmodelle"><i class="fa fa-check"></i><b>9.6.7</b> Zeitreihenmodelle</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="inductive.html"><a href="inductive.html#korrelationsanalysen"><i class="fa fa-check"></i><b>9.7</b> Korrelationsanalysen</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="inductive.html"><a href="inductive.html#korrelationstests"><i class="fa fa-check"></i><b>9.7.1</b> Korrelationstests</a></li>
<li class="chapter" data-level="9.7.2" data-path="inductive.html"><a href="inductive.html#korrelationstabellen"><i class="fa fa-check"></i><b>9.7.2</b> Korrelationstabellen</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="inductive.html"><a href="inductive.html#contingency"><i class="fa fa-check"></i><b>9.8</b> Kontingenztafeln</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="inductive.html"><a href="inductive.html#fisher"><i class="fa fa-check"></i><b>9.8.1</b> Fisher-Exact Test</a></li>
<li class="chapter" data-level="9.8.2" data-path="inductive.html"><a href="inductive.html#chi-quadrat-tests"><i class="fa fa-check"></i><b>9.8.2</b> Chi Quadrat-Tests</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="latente-variablenmodelle.html"><a href="latente-variablenmodelle.html"><i class="fa fa-check"></i><b>10</b> Latente Variablenmodelle</a>
<ul>
<li class="chapter" data-level="10.1" data-path="latente-variablenmodelle.html"><a href="latente-variablenmodelle.html#naive-hauptkomponentenanalyse"><i class="fa fa-check"></i><b>10.1</b> Naive Hauptkomponentenanalyse</a></li>
<li class="chapter" data-level="10.2" data-path="latente-variablenmodelle.html"><a href="latente-variablenmodelle.html#factanal"><i class="fa fa-check"></i><b>10.2</b> Explorative Faktorenanalyse</a></li>
<li class="chapter" data-level="10.3" data-path="latente-variablenmodelle.html"><a href="latente-variablenmodelle.html#kmeans"><i class="fa fa-check"></i><b>10.3</b> <em>k</em>-Means Clustering</a></li>
<li class="chapter" data-level="10.4" data-path="latente-variablenmodelle.html"><a href="latente-variablenmodelle.html#strukturgleichungsmodelle"><i class="fa fa-check"></i><b>10.4</b> Strukturgleichungsmodelle</a></li>
</ul></li>
<li class="part"><span><b>IV Vertiefung</b></span></li>
<li class="chapter" data-level="11" data-path="ergebnisse-exportieren.html"><a href="ergebnisse-exportieren.html"><i class="fa fa-check"></i><b>11</b> Ergebnisse exportieren</a>
<ul>
<li class="chapter" data-level="11.1" data-path="ergebnisse-exportieren.html"><a href="ergebnisse-exportieren.html#einführung-2"><i class="fa fa-check"></i><b>11.1</b> Einführung</a></li>
<li class="chapter" data-level="11.2" data-path="ergebnisse-exportieren.html"><a href="ergebnisse-exportieren.html#markdown"><i class="fa fa-check"></i><b>11.2</b> Berichte</a></li>
<li class="chapter" data-level="11.3" data-path="ergebnisse-exportieren.html"><a href="ergebnisse-exportieren.html#tabellen"><i class="fa fa-check"></i><b>11.3</b> Tabellen</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="ergebnisse-exportieren.html"><a href="ergebnisse-exportieren.html#word-pdf-und-html"><i class="fa fa-check"></i><b>11.3.1</b> Word, PDF und HTML</a></li>
<li class="chapter" data-level="11.3.2" data-path="ergebnisse-exportieren.html"><a href="ergebnisse-exportieren.html#latex"><i class="fa fa-check"></i><b>11.3.2</b> LaTeX</a></li>
<li class="chapter" data-level="11.3.3" data-path="ergebnisse-exportieren.html"><a href="ergebnisse-exportieren.html#komplexe-tabellen"><i class="fa fa-check"></i><b>11.3.3</b> Komplexe Tabellen</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="datatypes.html"><a href="datatypes.html"><i class="fa fa-check"></i><b>12</b> Datenstrukturen</a>
<ul>
<li class="chapter" data-level="12.1" data-path="datatypes.html"><a href="datatypes.html#vec"><i class="fa fa-check"></i><b>12.1</b> Vektor</a></li>
<li class="chapter" data-level="12.2" data-path="datatypes.html"><a href="datatypes.html#matrix"><i class="fa fa-check"></i><b>12.2</b> Matrix</a></li>
<li class="chapter" data-level="12.3" data-path="datatypes.html"><a href="datatypes.html#tibble"><i class="fa fa-check"></i><b>12.3</b> Data.frame und tibble</a></li>
<li class="chapter" data-level="12.4" data-path="datatypes.html"><a href="datatypes.html#lists"><i class="fa fa-check"></i><b>12.4</b> Liste</a></li>
<li class="chapter" data-level="12.5" data-path="datatypes.html"><a href="datatypes.html#umwandlung"><i class="fa fa-check"></i><b>12.5</b> Umwandlungen</a></li>
<li class="chapter" data-level="12.6" data-path="datatypes.html"><a href="datatypes.html#objektorientierung"><i class="fa fa-check"></i><b>12.6</b> Objektorientierung</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="iterationmain.html"><a href="iterationmain.html"><i class="fa fa-check"></i><b>13</b> Iterationen</a>
<ul>
<li class="chapter" data-level="13.1" data-path="iterationmain.html"><a href="iterationmain.html#iteration"><i class="fa fa-check"></i><b>13.1</b> Was sind iterative Prozesse?</a></li>
<li class="chapter" data-level="13.2" data-path="iterationmain.html"><a href="iterationmain.html#map"><i class="fa fa-check"></i><b>13.2</b> Listenbasierte Berechnungen</a></li>
<li class="chapter" data-level="13.3" data-path="iterationmain.html"><a href="iterationmain.html#nest"><i class="fa fa-check"></i><b>13.3</b> Einnisten</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>Appendix</a>
<ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#datensatzerläuterungen"><i class="fa fa-check"></i>Datensatzerläuterungen</a>
<ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#big-five"><i class="fa fa-check"></i>Big Five</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#tipp-wm"><i class="fa fa-check"></i>Tipp WM</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#indonesisch"><i class="fa fa-check"></i>Indonesisch</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#video"><i class="fa fa-check"></i>Video</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#artists"><i class="fa fa-check"></i>Artists</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#tracks"><i class="fa fa-check"></i>Tracks</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#fitness"><i class="fa fa-check"></i>Fitness</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#statistical-literacy"><i class="fa fa-check"></i>Statistical Literacy</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#übungsverzeichnis"><i class="fa fa-check"></i>Übungsverzeichnis</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#literaturverzeichnis"><i class="fa fa-check"></i>Literaturverzeichnis</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#verwendete-software-versionen"><i class="fa fa-check"></i>Verwendete Software Versionen</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R für empirische Wissenschaften</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="datenvorbereitung" class="section level1" number="6">
<h1><span class="header-section-number">Kapitel 6</span> Datenvorbereitung</h1>
<div id="tidyverse" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Einführung</h2>
<p>Die Datenvorbereitung oder auch Datenaufbereitung ist im Regelfall der mit Abstand aufwendigste Teil. Selten hat man nach der Datenerhebung bereits einen perfekt formatierten Datensatz, den man statistisch auswerten kann. Manche gehen sogar so weit, der Datenvorbereitung einen Anteil von über 90% der gesamten Bearbeitungszeit zuzuschreiben. Mit den Funktionen des <code>tidyverse</code> ist dies heutzutage glücklicherweise leicht zu bewerkstelligen.</p>
<p>Das <code>tidyverse</code> ist ein Sammelsurium an Packages, die die gleiche Philosophie teilen. Dabei steht der Name <strong>tidy</strong> uni<strong>verse</strong>, also eine Art aufgeräumtes Universum. Beim Laden des <code>tidyverse</code> werden die acht in Abbildung <a href="datenvorbereitung.html#fig:tidyverse">6.1</a> illustrierten Packages gemeinsam bereitgestellt. Damit spart man sich im Prinzip nur das einzelne Aufrufen der acht Packages. Man könnte stattdessen auch jedes Package einzeln laden.</p>
<div class="figure" style="text-align: center"><span id="fig:tidyverse"></span>
<img src="images/tidyverse.png" alt="Übersicht über die Packages im tidyverse." width="80%" />
<p class="caption">
Abbildung 6.1: Übersicht über die Packages im tidyverse.
</p>
</div>
<p>Ausgeführt in R sieht das wie folgt aus. Unter <em>Conflicts</em> werden Funktionen genannt, die den selben Namen wie <code>base R</code> Funktionen haben und die von hier an überschrieben werden.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb70-1"><a href="datenvorbereitung.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<div class="sourceCode" id="cb71"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb71-1"><a href="datenvorbereitung.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="sc">--</span> Attaching packages <span class="sc">------------------</span> tidyverse <span class="dv">1</span>.<span class="fl">3.0</span> <span class="sc">--</span></span>
<span id="cb71-2"><a href="datenvorbereitung.html#cb71-2" aria-hidden="true" tabindex="-1"></a>v ggplot2 <span class="dv">3</span>.<span class="fl">3.2</span>     v purrr   <span class="dv">0</span>.<span class="fl">3.4</span></span>
<span id="cb71-3"><a href="datenvorbereitung.html#cb71-3" aria-hidden="true" tabindex="-1"></a>v tibble  <span class="dv">3</span>.<span class="fl">0.4</span>     v dplyr   <span class="dv">1</span>.<span class="fl">0.2</span></span>
<span id="cb71-4"><a href="datenvorbereitung.html#cb71-4" aria-hidden="true" tabindex="-1"></a>v tidyr   <span class="dv">1</span>.<span class="fl">1.2</span>     v stringr <span class="dv">1</span>.<span class="fl">4.0</span></span>
<span id="cb71-5"><a href="datenvorbereitung.html#cb71-5" aria-hidden="true" tabindex="-1"></a>v readr   <span class="dv">1</span>.<span class="fl">4.0</span>     v forcats <span class="dv">0</span>.<span class="fl">5.0</span></span>
<span id="cb71-6"><a href="datenvorbereitung.html#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="sc">--</span> Conflicts <span class="sc">---------------------</span> <span class="fu">tidyverse_conflicts</span>() <span class="sc">--</span></span>
<span id="cb71-7"><a href="datenvorbereitung.html#cb71-7" aria-hidden="true" tabindex="-1"></a>x dplyr<span class="sc">::</span><span class="fu">filter</span>() masks stats<span class="sc">::</span><span class="fu">filter</span>()</span>
<span id="cb71-8"><a href="datenvorbereitung.html#cb71-8" aria-hidden="true" tabindex="-1"></a>x dplyr<span class="sc">::</span><span class="fu">lag</span>()    masks stats<span class="sc">::</span><span class="fu">lag</span>()</span></code></pre></div>
<ul>
<li><code>ggplot2</code> bietet ein mächtiges Framework zum Erstellen von Visualisierungen (siehe Kapitel <a href="visual.html#visual">8</a>).</li>
<li><code>tibble</code> erweitert das klassische Format eines Datensatzes (früher <code>data.frame</code>) (siehe Kapitel <a href="datatypes.html#tibble">12.3</a>).</li>
<li><code>tidyr</code> stellt vor allem zwei zentrale Funktionen zum Wechsel zwischen langem und breiten Dateiformat dar (siehe Kapitel <a href="datenvorbereitung.html#tidy">6.7</a>).</li>
<li><code>readr</code> bietet verschiedene Funktionen zum Einlesen. Wir werden im Rahmen dieses Buches nur indirekt durch das <code>rio</code> Package darauf zurückgreifen (siehe Kapitel <a href="io.html#io">5</a>).</li>
<li><code>purrr</code> für verschiedene Funktionen für iterative Prozesse (siehe Kapitel <a href="iterationmain.html#iterationmain">13</a>).</li>
<li><code>dplyr</code> stellt diverse Funktionen zur Datenvorbereitung vor und stellt den Hauptteil dieses Kapitel dar.</li>
<li><code>stringr</code> zur Veränderung von Charactern, also sogenannten Buchstabenfolgen (siehe Kapitel <a href="datenvorbereitung.html#datastring">6.10</a>). Dabei ist<code>string</code> ein anderes Wort für Characters.</li>
<li><code>forcats</code> zur Manipulation von Faktoren (siehe Kapitel <a href="datenvorbereitung.html#datafactor">6.11</a>). Der Name kommt von <em>for categoricals</em> und bietet folglich Funktionen für kategorische Variablen.</li>
</ul>
<p>Nicht mit dem <code>tidyverse</code> geladen, aber dennoch gut kombinierbar sind außerdem</p>
<ul>
<li><code>lubridate</code> zur Manipulation von Zeitdaten (siehe Kapitel <a href="datenvorbereitung.html#datazeit">6.12</a>).</li>
<li><code>inductive</code> für die gängigsten inferenzstatistischen Verfahren (siehe Kapitel <a href="inductive.html#inductive">9</a>).</li>
</ul>
<p>Die in diesem Kapitel eingeführten Funktionen zur Datenaufbereitung sind in sich konsistent. Man muss das Prinzip also nur einmal verstehen, um sämtliche Funktionen anwenden zu können. Dabei sind diese durch die ausdrucksstarke Namensgebung beinahe schon selbsterklärend. Schauen wir uns mal eine typische Aneinanderreihung von Befehlen an:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb72-1"><a href="datenvorbereitung.html#cb72-1" aria-hidden="true" tabindex="-1"></a>big5 <span class="sc">%&gt;%</span> </span>
<span id="cb72-2"><a href="datenvorbereitung.html#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Geschlecht, Extraversion) <span class="sc">%&gt;%</span> </span>
<span id="cb72-3"><a href="datenvorbereitung.html#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Geschlecht <span class="sc">==</span> <span class="st">&quot;m&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb72-4"><a href="datenvorbereitung.html#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Extraversion_lg =</span> <span class="fu">log</span>(Extraversion))</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 82 x 3
  Geschlecht Extraversion Extraversion_lg
  &lt;chr&gt;             &lt;dbl&gt;           &lt;dbl&gt;
1 m                   3              1.10
2 m                   3.4            1.22
3 m                   3.3            1.19
4 m                   3.5            1.25
# ... with 78 more rows</code></pre>
<p>Gelesen würde es wie folgt:</p>
<ul>
<li><p>Man nehme den Datensatz <code>big5</code> <code>UND DANN</code></p>
<ul>
<li>wähle die Spalten <code>Geschlecht</code>, <code>Extraversion</code> <code>UND DANN</code></li>
<li>filtere die Spalten, in denen Geschlecht gleich “m” (für männlich) ist <code>UND DANN</code></li>
<li>mutiere oder verändere die (neue) Spalte <code>Extraversion_lg</code> durch die logarithmierten Werte der Extraversion</li>
</ul></li>
</ul>
<p>Die anderen Funktionen sind ähnlich intuitiv und nahe an der englischen Sprache benannt. Besonders ist an dieser Stelle das kryptische Symbol Prozent-Größer als-Prozent (<code>%&gt;%</code>). Dieses Symbol können wir nur nach Laden des <code>tidyverse</code> (oder genauer <code>magrittr</code>) verwenden. Es macht dabei nichts anderes als die Übergabe oder das Weiterreichen des modifizierten Datensatzes an die nächste Funktion. Dies ist nur möglich, da das erste Argument der hier behandelten Funktionen immer der Datensatzname ist. Daher können wir uns hier den Namen des Datensatzes sparen. In dem obigen Beispiel werden zuerst zwei der Spalten ausgewählt. Dann wird das Ergebnis dieses Befehls – also der Datensatz mit den zwei Spalten – im nächsten Schritt der Funktion <code>filter()</code> übergeben.</p>
<p>Dieses Verbindungssymbol <code>%&gt;%</code> wird Pipe genannt. Es kann mit dem Shortcut <code>strg + shift + M</code> beziehungsweise <code>cmd + shift + M</code> direkt erstellt werden. Die Verwendung der Pipe hat zwei große Vorteile:</p>
<ol style="list-style-type: decimal">
<li>Die Verschachtelung mehrerer Funktionen ineinander wird verhindert.</li>
<li>Wir müssen nicht jedes Ergebnis der verschiedenen Funktionen einzeln zwischenspeichern.</li>
</ol>
<p>Trotzdem müssen wir das Ergebnis dieser aneinandergeketteten Funktion natürlich irgendwann mit dem Zuweisungspfeil speichern.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb74-1"><a href="datenvorbereitung.html#cb74-1" aria-hidden="true" tabindex="-1"></a>daten <span class="ot">&lt;-</span> big5 <span class="sc">%&gt;%</span> </span>
<span id="cb74-2"><a href="datenvorbereitung.html#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Geschlecht, Extraversion) <span class="sc">%&gt;%</span> </span>
<span id="cb74-3"><a href="datenvorbereitung.html#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Geschlecht <span class="sc">==</span> <span class="st">&quot;m&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb74-4"><a href="datenvorbereitung.html#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Extraversion_lg =</span> <span class="fu">log</span>(Extraversion))</span></code></pre></div>
<div class="idea">
<p>Beachte, dass sämtliche Änderungen, die du am Datensatz vollziehst, erst gespeichert werden, wenn du sie mit dem Zuweisungspfeil (siehe Kapitel <a href="vars.html#pfeil">4.1</a>) einer Variable zuweist. Wenn dieser Variablenname bereits vergeben ist (z.B. der bisherige Datensatzname) wird dieser <strong>überschrieben</strong>. Um das rückgängig zu machen, muss der Datensatz dann einfach wieder neu eingelesen werden. Es empfiehlt sich bei einschneidenden Änderungen einen neuen Variablennamen zu verwenden.</p>
</div>
<div class="idea">
<p>Ein zentrales Konzept ist die sogenannte Pipe (<code>%&gt;%</code>), die verschiedenste Funktionsaufrufe aneinanderbinden kann. Dabei wird der Datensatz an die nächste Funktion weitergeben.</p>
</div>
</div>
<div id="select" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> <code>select()</code>, <code>rename()</code> und <code>relocate()</code></h2>
<p>Die Funktionen in diesem Kapitel beschäftigen sich mit der Auswahl, Umbenennung und Umordnung von <strong>Spalten</strong>. Wir haben die Funktion <code>select()</code> bereits im vorherigen Kapitel kennengelernt. Es können also beliebig viele Spalten ausgewählt werden. Dies ist vor allem sehr nützlich, wenn der Datensatz sehr groß ist und man übersichtlich nur die Spalten haben möchte, die zur Auswertung verwendet werden. Zur Auswahl einer Spalte muss nur der Name (ohne Anführungszeichen) übergeben werden. Man kann auch direkt in der Funktion die Spalte umbenennen. Dabei muss auf der linken Seite des Gleichheitszeichen der neue Name stehen.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb75-1"><a href="datenvorbereitung.html#cb75-1" aria-hidden="true" tabindex="-1"></a>big5 <span class="sc">%&gt;%</span> </span>
<span id="cb75-2"><a href="datenvorbereitung.html#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Extraversion, <span class="at">Neuro =</span> Neurotizismus)</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 200 x 2
  Extraversion Neuro
         &lt;dbl&gt; &lt;dbl&gt;
1          3     1.9
2          3.1   3.4
3          3.4   2.4
4          3.3   4.2
# ... with 196 more rows</code></pre>
<p>schreiben. Zur Auswahl der Spalten von <code>Extraversion</code> <strong>bis</strong> <code>O2</code> verwendet man einen Doppelpunkt.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb77-1"><a href="datenvorbereitung.html#cb77-1" aria-hidden="true" tabindex="-1"></a>big5 <span class="sc">%&gt;%</span> </span>
<span id="cb77-2"><a href="datenvorbereitung.html#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Extraversion<span class="sc">:</span>O2)</span></code></pre></div>
<p>Möchte man nur die Spalte <code>Geschlecht</code> entfernen und den Rest ausgeben lassen, erreicht man dies mit einem Minus vor dem Spaltennamen. Bei mehreren zu entfernenden Spalten müsste man diese in Klammern rahmen (z.B. <code>-(Extraversion:O2</code>)).</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb78-1"><a href="datenvorbereitung.html#cb78-1" aria-hidden="true" tabindex="-1"></a>big5 <span class="sc">%&gt;%</span> </span>
<span id="cb78-2"><a href="datenvorbereitung.html#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Geschlecht)</span></code></pre></div>
<p>Darüber hinaus können wir so genannte Helferfunktionen verwenden. Diese können nur in Kombination mit einer anderen Funktion verwendet werden. Ein nützliches Beispiel ist <code>where()</code>. So können beispielsweise alle numerischen Spalten ausgewählt werden.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb79-1"><a href="datenvorbereitung.html#cb79-1" aria-hidden="true" tabindex="-1"></a>big5 <span class="sc">%&gt;%</span> </span>
<span id="cb79-2"><a href="datenvorbereitung.html#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric))</span></code></pre></div>
<p>Eine weitere nützliche Helferfunktion ist <code>starts_with()</code>. So könnte man in diesem Fall beispielsweise alle Fragen zum Persönlichkeitsfaktor Offenheit auswählen, da diese alle mit dem Buchstaben <code>O</code> beginnen.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb80-1"><a href="datenvorbereitung.html#cb80-1" aria-hidden="true" tabindex="-1"></a>big5 <span class="sc">%&gt;%</span> </span>
<span id="cb80-2"><a href="datenvorbereitung.html#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">&quot;O&quot;</span>))</span></code></pre></div>
<p>Außerdem nützlich sind <code>ends_with()</code> und <code>contains()</code>. Wenn man hingegen die Spalten nur umbenennen und dabei den gesamten Datensatz behalten möchte, muss man <code>rename()</code> verwenden. Die Syntax des Umbenennens bleibt dabei gleich.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb81-1"><a href="datenvorbereitung.html#cb81-1" aria-hidden="true" tabindex="-1"></a>big5 <span class="sc">%&gt;%</span> </span>
<span id="cb81-2"><a href="datenvorbereitung.html#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Sex =</span> Geschlecht)</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 200 x 7
  Alter Sex   Extraversion Neurotizismus    O1    O2    O3
  &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1    36 m              3             1.9     5     1     5
2    30 f              3.1           3.4     5     3     5
3    23 m              3.4           2.4     3     3     5
4    54 m              3.3           4.2     2     5     3
# ... with 196 more rows</code></pre>
<div class="idea">
<p>Während beide Funktionen Spalten umbenennen können, gibt <code>select()</code> nur die ausgewählten Spalten und <code>rename()</code> hingegen alle Spalten zurück.</p>
</div>
<p>Außerdem können Funktionen zur Umbenennung von Spalten verwendet werden. Dafür müssen wir <code>rename_with()</code> einfach nur die Funktion (ohne Klammern) übergeben. In diesem Beispiel werden alle Buchstaben der Spaltennamen in Großbuchstaben verändert.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb83-1"><a href="datenvorbereitung.html#cb83-1" aria-hidden="true" tabindex="-1"></a>big5 <span class="sc">%&gt;%</span> </span>
<span id="cb83-2"><a href="datenvorbereitung.html#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(toupper)</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 200 x 7
  ALTER GESCHLECHT EXTRAVERSION NEUROTIZISMUS    O1    O2    O3
  &lt;dbl&gt; &lt;chr&gt;             &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1    36 m                   3             1.9     5     1     5
2    30 f                   3.1           3.4     5     3     5
3    23 m                   3.4           2.4     3     3     5
4    54 m                   3.3           4.2     2     5     3
# ... with 196 more rows</code></pre>
<p>Gerade bei sehr großen Datensätzen mit vielen Spalten ist die Funktion <code>relocate()</code> äußerst nützlich. Eine neue Spalte wird zum Beispiel immer ans Ende des Datensatzes angefügt. Um diese trotzdem betrachten zu können, übergeben wir den Spaltennamen einfach unserer Funktion.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb85-1"><a href="datenvorbereitung.html#cb85-1" aria-hidden="true" tabindex="-1"></a>big5 <span class="sc">%&gt;%</span> </span>
<span id="cb85-2"><a href="datenvorbereitung.html#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(O1)</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 200 x 7
     O1 Alter Geschlecht Extraversion Neurotizismus    O2    O3
  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;             &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     5    36 m                   3             1.9     1     5
2     5    30 f                   3.1           3.4     3     5
3     3    23 m                   3.4           2.4     3     5
4     2    54 m                   3.3           4.2     5     3
# ... with 196 more rows</code></pre>
<p>Wenn die Spalte nicht direkt am Anfang, sondern nach einer bestimmten anderen Spalte eingeordnet werden soll, können wir dies mit dem <code>.after</code> Argument festlegen. Hier würde die Spalte <code>O1</code> hinter der Spalte <code>Alter</code> ausgegeben werden.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb87-1"><a href="datenvorbereitung.html#cb87-1" aria-hidden="true" tabindex="-1"></a>big5 <span class="sc">%&gt;%</span> </span>
<span id="cb87-2"><a href="datenvorbereitung.html#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(O1, <span class="at">.after =</span> Alter)</span></code></pre></div>
<p>Auch hier können wir wieder Helferfunktionen wie <code>where()</code> verwenden. Man könnte beispielsweise alle numerischen Spalten hinter alle Character Spalten anfügen.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb88-1"><a href="datenvorbereitung.html#cb88-1" aria-hidden="true" tabindex="-1"></a>big5 <span class="sc">%&gt;%</span> </span>
<span id="cb88-2"><a href="datenvorbereitung.html#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="fu">where</span>(is.numeric), <span class="at">.after =</span> <span class="fu">where</span>(is.character))</span></code></pre></div>
<p>Eine weitere nützliche Funktion bei sehr breiten Datensätzen mit vielen Spalten ist <code>names()</code>. So können wir auf einem Blick alle Spaltennamen ausgegeben bekommen.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb89-1"><a href="datenvorbereitung.html#cb89-1" aria-hidden="true" tabindex="-1"></a>big5 <span class="sc">%&gt;%</span> </span>
<span id="cb89-2"><a href="datenvorbereitung.html#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>()</span></code></pre></div>
<pre class="bordercode"><code>[1] &quot;Alter&quot;         &quot;Geschlecht&quot;    &quot;Extraversion&quot;  &quot;Neurotizismus&quot; &quot;O1&quot;            &quot;O2&quot;           
[7] &quot;O3&quot;           </code></pre>
<p>Von Zeilennamen (<code>rownames()</code>) sollte hingegen grundsätzlich Abstand genommen werden. Falls der Datensatz Zeilennamen enthält, die tatsächlich von Bedeutung sind, sollte man diese mit der Funktion <code>rownames_to_column("Spaltenname")</code> aus dem <code>tibble</code> Package in eine eigene Spalte befördern.</p>
<div class="exercise2">
<p>Das ist ein Platzhalter für eine Übung. Starte die Übung mit <code>hands_on("test")</code>.</p>
</div>
</div>
<div id="filter" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> <code>filter()</code> und <code>arrange()</code></h2>
<p>Anders als im vorherigen Kapitel beschäftigen sich diese beiden Funktionen mit der Auswahl und Umordnung von <strong>Zeilen</strong>. Der Funktion <code>filter()</code> muss dabei ein logischer Ausdruck übergeben werden. Das Ergebnis der Abfrage muss also immer <code>TRUE</code> oder <code>FALSE</code> zurückgeben können (siehe Kapitel <a href="vars.html#datentypen">4.2</a>). Zur Auswahl aller männlichen Probanden würde man <code>Geschlecht == "m"</code> schreiben. Beachte an dieser Stelle das doppelte Gleichheitszeichen.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb91-1"><a href="datenvorbereitung.html#cb91-1" aria-hidden="true" tabindex="-1"></a>big5 <span class="sc">%&gt;%</span> </span>
<span id="cb91-2"><a href="datenvorbereitung.html#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Geschlecht <span class="sc">==</span> <span class="st">&quot;m&quot;</span>)</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 82 x 7
  Alter Geschlecht Extraversion Neurotizismus    O1    O2    O3
  &lt;dbl&gt; &lt;chr&gt;             &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1    36 m                   3             1.9     5     1     5
2    23 m                   3.4           2.4     3     3     5
3    54 m                   3.3           4.2     2     5     3
4    32 m                   3.5           3.1     3     1     5
# ... with 78 more rows</code></pre>
<p>Um Zeilen neu anzuordnen, benutzt man <code>arrange()</code>. Wenn die Zeilen nach aufsteigendem Alter sortiert werden sollen, muss man lediglich den Spaltennamen übergeben.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb93-1"><a href="datenvorbereitung.html#cb93-1" aria-hidden="true" tabindex="-1"></a>big5 <span class="sc">%&gt;%</span> </span>
<span id="cb93-2"><a href="datenvorbereitung.html#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Alter)</span></code></pre></div>
<p>Für eine absteigende Anordnung kann man sich die Funktion <code>desc()</code> zur Hilfe nehmen.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb94-1"><a href="datenvorbereitung.html#cb94-1" aria-hidden="true" tabindex="-1"></a>big5 <span class="sc">%&gt;%</span> </span>
<span id="cb94-2"><a href="datenvorbereitung.html#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Alter))</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 200 x 7
  Alter Geschlecht Extraversion Neurotizismus    O1    O2    O3
  &lt;dbl&gt; &lt;chr&gt;             &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1  1995 f                   2.5           3.7     4     1     4
2  1964 f                   3.2           2.3     5     1     5
3    60 f                   3             2.7     5     1     5
4    59 m                   2.7           2.3     5     1     5
# ... with 196 more rows</code></pre>
<p>So sehen wir hier beispielsweise zwei falsch eingetragene Alterswerte. Hier haben zwei Probanden nicht das Alter sondern das jeweilige Geburtsjahr in den Datensatz eingetragen. Das müsste man vor einer Auswertung natürlich noch einsprechend korrigieren.</p>
<div class="exercise2">
<p>Das ist ein Platzhalter für eine Übung. Starte die Übung mit <code>hands_on("test")</code>.</p>
</div>
</div>
<div id="mutate" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> <code>mutate()</code> und <code>across()</code></h2>
<p>Die Funktion <code>mutate()</code> ist eine sehr divers einsetzbare Funktion zum Verändern bestehender oder Hinzufügen neuer Spalten. Dabei wird der neue oder bereits bestehende Spaltennamen auf die linke Seite des Gleichheitszeichens geschrieben. Auf der rechten Seite kann so ziemlich alles stehen, solange die Funktion eine Spalte zurückgibt, die genauso lang ist wie der Datensatz. Man könnte hier zum Beispiel nicht den Mittelwert berechnen, da dabei nur ein Wert zurückgeben werden würde. Mit der Funktion <code>log()</code> logarithmieren wir hingegen jeden einzelnen der Extraversionswerte, sodass wir 200 Werte erhalten – also genau so viele, wie wir Zeilen haben.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb96-1"><a href="datenvorbereitung.html#cb96-1" aria-hidden="true" tabindex="-1"></a>big5 <span class="sc">%&gt;%</span> </span>
<span id="cb96-2"><a href="datenvorbereitung.html#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Extraversion_lg =</span> <span class="fu">log</span>(Extraversion))</span></code></pre></div>
<p>Innerhalb eines <code>mutate()</code> Aufrufes können auch gleich mehrere Spalten neu erstellt oder verändert werden. Die verschiedenen Spalten müssen dabei lediglich mit einem Komma getrennt werden. Hier berechnen wir beispielsweise die logarithmische mittlere Ausprägung von Extraversion und Neurotizismus. Der Abstand der öffnenden Klammer oben und schließenden Klammer unten ist aus funktioneller Sicht nicht relevant. Es ist allerdings im Sinne der Lesbarkeit bei vielen Argumenten sinnvoller, die Befehle auf mehrere Zeilen aufzuteilen. Um unser Ergebnis zu betrachten, ordnen wir noch unsere neuen mit <code>lg</code> endenden Spalten nach vorne an.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb97-1"><a href="datenvorbereitung.html#cb97-1" aria-hidden="true" tabindex="-1"></a>big5 <span class="sc">%&gt;%</span> </span>
<span id="cb97-2"><a href="datenvorbereitung.html#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb97-3"><a href="datenvorbereitung.html#cb97-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Extraversion_lg =</span> <span class="fu">log</span>(Extraversion),</span>
<span id="cb97-4"><a href="datenvorbereitung.html#cb97-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Neurotizismus_lg =</span> <span class="fu">log</span>(Neurotizismus)</span>
<span id="cb97-5"><a href="datenvorbereitung.html#cb97-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb97-6"><a href="datenvorbereitung.html#cb97-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="fu">ends_with</span>(<span class="st">&quot;lg&quot;</span>))</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 200 x 9
  Extraversion_lg Neurotizismus_lg Alter Geschlecht Extraversion Neurotizismus    O1    O2
            &lt;dbl&gt;            &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;             &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1            1.10            0.642    36 m                   3             1.9     5     1
2            1.13            1.22     30 f                   3.1           3.4     5     3
3            1.22            0.875    23 m                   3.4           2.4     3     3
4            1.19            1.44     54 m                   3.3           4.2     2     5
# ... with 196 more rows, and 1 more variable: O3 &lt;dbl&gt;</code></pre>
<p>Bei zwei Spalten ist das obige Beispiel eine praktische Möglichkeit zum Logarithmieren. Wenn du eine Funktion über mehrere Spalten anwenden möchten, solltest du hingegen zusätzlich auf <code>across()</code> (engl. für herüber) zurückgreifen. Wir wollen schließlich eine Funktion <strong>über</strong> mehrere Spalten anwenden. Die Auswahl der Spalten erfolgt dabei innerhalb von <code>across()</code> genau wie bei <code>select()</code> (siehe Kapitel <a href="datenvorbereitung.html#select">6.2</a>). Man kann beispielsweise den Doppelpunkt zur Auswahl eines Bereichs verwenden. An dieser Stelle müssen wir einmal genau hingucken, wo welche Klammer aufhört und endet. Denn die Funktion <code>log()</code> ist noch immer <strong>innerhalb</strong> von <code>across()</code>.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb99-1"><a href="datenvorbereitung.html#cb99-1" aria-hidden="true" tabindex="-1"></a>big5 <span class="sc">%&gt;%</span> </span>
<span id="cb99-2"><a href="datenvorbereitung.html#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(Extraversion<span class="sc">:</span>Neurotizismus, log))</span></code></pre></div>
<p>Dies wird noch etwas klarer, wenn wir einmal exemplarisch die Namen der jeweiligen Argumente von <code>across()</code> auftragen. Mit <code>.cols</code> wählen wir die Spalten aus und dem <code>.fns</code> Argument übergibt man die anzuwendende Funktion. Außerdem können wir an dieser Stelle noch das <code>.names</code> Argument verwenden. Wie Dir vielleicht bereits aufgefallen ist, werden sonst die bisherigen Werte der ausgewählten Spalten nur überschrieben und keine neuen erstellt. Mit <code>.names</code> können wir die neuen Spaltennamen festlegen. Beachte dabei die geschweiften Klammern um <code>.cols</code> innerhalb des <code>.names</code> Argumentes, die notwendig sind, um auf den jeweiligen Namen der Spalte zurückzugreifen. Diesem Spaltennamen wird dann der Suffix <code>_lg</code> angehangen.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb100-1"><a href="datenvorbereitung.html#cb100-1" aria-hidden="true" tabindex="-1"></a>big5 <span class="sc">%&gt;%</span> </span>
<span id="cb100-2"><a href="datenvorbereitung.html#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(</span>
<span id="cb100-3"><a href="datenvorbereitung.html#cb100-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">.cols =</span> Extraversion<span class="sc">:</span>Neurotizismus,</span>
<span id="cb100-4"><a href="datenvorbereitung.html#cb100-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">.fns =</span> log,</span>
<span id="cb100-5"><a href="datenvorbereitung.html#cb100-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">.names =</span> <span class="st">&quot;{.col}_lg&quot;</span>)</span>
<span id="cb100-6"><a href="datenvorbereitung.html#cb100-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="warning">
<p>Die auf mehrere Spalten anzuwendende Funktion muss innerhalb von <code>across()</code> übergeben werden. Falls ein Fehler auftritt, ist dieser Regel auf falsche Positionierung der Klammern zurückzuführen.</p>
</div>
<p>Der übersichtshalber lassen wir diese Argumente allerdings für einfachere Anwendungsfälle im Verlaufe des Buches weg. Ein weiterer Unterschied besteht in der manuellen Auswahl einzelner Spalten. Hier müssen wir die einzelnen Spalten im Gegensatz zur Anwendung bei <code>select()</code> innerhalb von <code>c()</code> schreiben.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb101-1"><a href="datenvorbereitung.html#cb101-1" aria-hidden="true" tabindex="-1"></a>big5 <span class="sc">%&gt;%</span> </span>
<span id="cb101-2"><a href="datenvorbereitung.html#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(Extraversion, Neurotizismus), log))</span></code></pre></div>
<p>Auch hier können wir die bereits in Kapitel <a href="datenvorbereitung.html#select">6.2</a> besprochenen Helferfunktionen wie <code>where()</code> verwenden.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb102-1"><a href="datenvorbereitung.html#cb102-1" aria-hidden="true" tabindex="-1"></a>big5 <span class="sc">%&gt;%</span> </span>
<span id="cb102-2"><a href="datenvorbereitung.html#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), log))</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 200 x 7
  Alter Geschlecht Extraversion Neurotizismus    O1    O2    O3
  &lt;dbl&gt; &lt;chr&gt;             &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1  3.58 m                  1.10         0.642 1.61   0     1.61
2  3.40 f                  1.13         1.22  1.61   1.10  1.61
3  3.14 m                  1.22         0.875 1.10   1.10  1.61
4  3.99 m                  1.19         1.44  0.693  1.61  1.10
# ... with 196 more rows</code></pre>
<p>Wenn wir beispielsweise eine bestehende Spalte auf bestimmte Art und Weise verändern wollen, <strong>wenn</strong> eine Bedingung zutrifft, erreichen wir dies mit der Funktion <code>if_else()</code>. Wir haben in Kapitel <a href="datenvorbereitung.html#filter">6.3</a> gesehen, dass zwei Probanden ihr Geburtsjahr anstelle des Alters in Jahren angegeben haben. Wenn unsere Bedingung (<code>condition</code>) zutrifft, also das Alter in Jahren größer als 120 ist, soll das Jahr der Erhebung (<code>2020</code>) Minus das Alter gerechnet werden. Ansonsten (<code>else</code> beziehungsweise <code>false</code>) wird nur das unveränderte Alter zurückgegeben. Anschließend überprüfen wir noch unsere Berechnung, indem wir das Alter wieder absteigend anordnen.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb104-1"><a href="datenvorbereitung.html#cb104-1" aria-hidden="true" tabindex="-1"></a>big5 <span class="sc">%&gt;%</span> </span>
<span id="cb104-2"><a href="datenvorbereitung.html#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Alter =</span> <span class="fu">if_else</span>(</span>
<span id="cb104-3"><a href="datenvorbereitung.html#cb104-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">condition =</span> Alter <span class="sc">&gt;</span> <span class="dv">120</span>, </span>
<span id="cb104-4"><a href="datenvorbereitung.html#cb104-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">true =</span> <span class="dv">2020</span> <span class="sc">-</span> Alter, </span>
<span id="cb104-5"><a href="datenvorbereitung.html#cb104-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">false =</span> Alter)</span>
<span id="cb104-6"><a href="datenvorbereitung.html#cb104-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb104-7"><a href="datenvorbereitung.html#cb104-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Alter))</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 200 x 7
  Alter Geschlecht Extraversion Neurotizismus    O1    O2    O3
  &lt;dbl&gt; &lt;chr&gt;             &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1    60 f                   3             2.7     5     1     5
2    59 m                   2.7           2.3     5     1     5
3    59 m                   2.8           1.6     4     2     5
4    58 m                   2.3           2.9     5     1     4
# ... with 196 more rows</code></pre>
<p>Bei mehr als zwei Bedingungen können wir stattdessen die Funktion <code>case_when()</code> verwenden. Auf der linken Seite der Tilde (<code>~</code>) ist dabei immer die Bedingung angegeben. Auf der rechten Seite hingegen ist die Ausgabe, wenn die zugehörige Bedingung auf der linken Seite zutreffen sollte. Allen Werten, auf die keine der explizit genannten Bedingungen zutrifft, wird <code>NA</code> (Akronym für <strong>N</strong>ot <strong>A</strong>vailable, engl. für nicht vorhanden) zugewiesen. Dies kann man anpassen, indem man am Ende noch <code>TRUE</code> als Bedingung hinzufügt. In diesem Beispiel müssen alle, die bisher keiner Bedingung zugeordnet sind, der ältesten Altersgruppe angehören. Am Ende ordnen wir unsere neu erstellte Spalte zum Kontrollieren unserer Berechnung noch nach vorne.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb106-1"><a href="datenvorbereitung.html#cb106-1" aria-hidden="true" tabindex="-1"></a>big5 <span class="sc">%&gt;%</span> </span>
<span id="cb106-2"><a href="datenvorbereitung.html#cb106-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Gruppe =</span> <span class="fu">case_when</span>(</span>
<span id="cb106-3"><a href="datenvorbereitung.html#cb106-3" aria-hidden="true" tabindex="-1"></a>    Alter <span class="sc">&lt;=</span> <span class="dv">25</span> <span class="sc">~</span> <span class="st">&quot;Jungspund&quot;</span>,</span>
<span id="cb106-4"><a href="datenvorbereitung.html#cb106-4" aria-hidden="true" tabindex="-1"></a>    Alter <span class="sc">&gt;</span> <span class="dv">25</span> <span class="sc">&amp;</span> Alter <span class="sc">&lt;=</span> <span class="dv">45</span>  <span class="sc">~</span> <span class="st">&quot;Mittel&quot;</span>,</span>
<span id="cb106-5"><a href="datenvorbereitung.html#cb106-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">between</span>(Alter, <span class="dv">46</span>, <span class="dv">65</span>) <span class="sc">~</span> <span class="st">&quot;Erfahren&quot;</span>,</span>
<span id="cb106-6"><a href="datenvorbereitung.html#cb106-6" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Weise&quot;</span>)</span>
<span id="cb106-7"><a href="datenvorbereitung.html#cb106-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb106-8"><a href="datenvorbereitung.html#cb106-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Gruppe)</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 200 x 8
  Gruppe    Alter Geschlecht Extraversion Neurotizismus    O1    O2    O3
  &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;             &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Mittel       36 m                   3             1.9     5     1     5
2 Mittel       30 f                   3.1           3.4     5     3     5
3 Jungspund    23 m                   3.4           2.4     3     3     5
4 Erfahren     54 m                   3.3           4.2     2     5     3
# ... with 196 more rows</code></pre>
<p>Die Helferfunktion <code>between()</code> ist eine übersichtliche Alternative zum kombinierten logischen Begriff eine Zeile darüber. Wichtig ist an dieser Stelle, dass der Datentyp auf der linken Seite immer logisch sein muss. Auf der rechten Seite der Tilde muss es immer der gleiche Datentyp sein. Wenn wir also wie hier den Datentyp Character haben, muss bei allen diesen Zuweisungen auf der rechten Seite der Datentyp übereinstimmen.</p>
<p>Ein weiterer praktischer Anwendungsfall ist die Umkodierung von von einzelnen Fragen. Angenommen, wir messen auf einer Skala von 1 (trifft gar nicht zu) bis 5 (trifft vollkommen zu) die Ausprägung der Offenheit für neue Erfahrungen. Um Verzerrungen zu vermeiden, sind in einem derartigen Fragebogen immer einige Items verneint gestellt. Normalerweise würde beispielsweise fragen, ob man gerne neue Sportarten ausprobiert. Würden wir allerdings fragen, ob man <strong>nicht</strong> gerne neue Sportarten ausprobiert, trifft unsere Skala natürlich nicht mehr zu. Jetzt wäre 5 (trifft gar nicht zu) und 1 (trifft vollkommen zu). Stellen wir uns vor, dies würde für das Item <code>O1</code> zutreffen. Zum Vergleich erstellen wir eine neue Spalte namens <code>O1_new</code>, welche die umkodierten Werte enthält.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb108-1"><a href="datenvorbereitung.html#cb108-1" aria-hidden="true" tabindex="-1"></a>big5 <span class="sc">%&gt;%</span> </span>
<span id="cb108-2"><a href="datenvorbereitung.html#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(O1) <span class="sc">%&gt;%</span> </span>
<span id="cb108-3"><a href="datenvorbereitung.html#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">O1_new =</span> <span class="fu">case_when</span>(</span>
<span id="cb108-4"><a href="datenvorbereitung.html#cb108-4" aria-hidden="true" tabindex="-1"></a>    O1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb108-5"><a href="datenvorbereitung.html#cb108-5" aria-hidden="true" tabindex="-1"></a>    O1 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb108-6"><a href="datenvorbereitung.html#cb108-6" aria-hidden="true" tabindex="-1"></a>    O1 <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb108-7"><a href="datenvorbereitung.html#cb108-7" aria-hidden="true" tabindex="-1"></a>    O1 <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb108-8"><a href="datenvorbereitung.html#cb108-8" aria-hidden="true" tabindex="-1"></a>    O1 <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb108-9"><a href="datenvorbereitung.html#cb108-9" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 200 x 2
     O1 O1_new
  &lt;dbl&gt;  &lt;dbl&gt;
1     5      1
2     5      1
3     3      3
4     2      4
# ... with 196 more rows</code></pre>
<p>Immer wenn die Spalte <code>O1</code> den Werte 1 hat, wird eine 5 daraus gemacht und immer wenn eine 2 angekreuzt wurde, diese mit einer 4 ersetzt. Die 3 können wir so belassen und die 4 und 5 wandeln wir auf die gleiche Art und Weise um. Beachte auch hier, dass wir auf der linken Seite immer eine logische Abfrage und rechts den selben Datentyp (hier Double) vorliegen haben.</p>
<div class="exercise2">
<p>Das ist ein Platzhalter für eine Übung. Starte die Übung mit <code>hands_on("test")</code>.</p>
</div>
</div>
<div id="function" class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> Eigene Funktionen</h2>
<p>Obwohl direkt in R oder in zusätzlichen Packages bereits eine Vielzahl von Funktionen enthalten sind, braucht man doch immer wieder eigene Funktionen für spezifische Anwendungsfälle. Dies versuchen wir anhand einer Funktion zu illustrieren, die den Logarithmus einer der Funktion übergebenen Zahl mit zwei summiert. Diese Funktion sei <code>new_log()</code> genannt. Eine Funktion wird mit <code>function()</code> erstellt. Innerhalb der runden Klammern können wir mit einem Komma getrennt beliebig viele Argumente festlegen. An dieser Stelle nehmen wir nur <code>x</code>. Der Name dieses Arguments ist grundsätzlich egal, solange er wie hier in dem Beispiel sowohl innerhalb von <code>function()</code> als auch in <code>log()</code> miteinander übereinstimmt. Die eigentliche Berechnung findet innerhalb der geschweiften Klammern statt. Es ist wichtig, dass wir einmal vor Benutzung diese Funktion durch Ausführen (<code>strg</code> + <code>enter</code>) lokal speichern.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb110-1"><a href="datenvorbereitung.html#cb110-1" aria-hidden="true" tabindex="-1"></a>new_log <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb110-2"><a href="datenvorbereitung.html#cb110-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log</span>(x) <span class="sc">+</span> <span class="dv">2</span></span>
<span id="cb110-3"><a href="datenvorbereitung.html#cb110-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="idea">
<p>Eigene Funktionen müssen genau wie Packages nach Neustart von R immer wieder neu geladen werden. Dies erreicht man beispielsweise durch einfaches Ausführen des obigen Befehls. Es gibt in der Hinsicht also keinen Unterschied zum Speichern gewöhnlicher Variablen.</p>
</div>
<p>Eine Funktion mit zwei Argumenten, wenn wir beispielsweise zusätzlich noch die Höhe der Zahl innerhalb der Funktion anpassen möchten, könnte wie folgt aussehen.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb111-1"><a href="datenvorbereitung.html#cb111-1" aria-hidden="true" tabindex="-1"></a>new_log <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">zahl =</span> <span class="dv">2</span>) {</span>
<span id="cb111-2"><a href="datenvorbereitung.html#cb111-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">log</span>(x) <span class="sc">+</span> zahl</span>
<span id="cb111-3"><a href="datenvorbereitung.html#cb111-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Nun könnte man als zweites Argument die zu addierende Zahl modifizieren. Innerhalb der runden Klammern steht <code>zahl = 2</code>, um den Standardwert von <code>zahl</code> zu definieren. Würden wir das Argument dann beim Anwenden weglassen, würde 2 addiert werden. Nur wenn man die Zahl verändern wollen würde, müsste man das der Funktion <code>new_log()</code> das Argument <code>zahl</code> übergeben.</p>
<p>Erst einmal erstellt, können die eigenen Funktionen nun wie im vorherigen Kapitel bereits gelernt direkt in <code>mutate()</code> angewendet werden.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb112-1"><a href="datenvorbereitung.html#cb112-1" aria-hidden="true" tabindex="-1"></a>big5 <span class="sc">%&gt;%</span> </span>
<span id="cb112-2"><a href="datenvorbereitung.html#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(Extraversion<span class="sc">:</span>Neurotizismus, new_log))</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 200 x 7
  Alter Geschlecht Extraversion Neurotizismus    O1    O2    O3
  &lt;dbl&gt; &lt;chr&gt;             &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1    36 m                  3.10          2.64     5     1     5
2    30 f                  3.13          3.22     5     3     5
3    23 m                  3.22          2.88     3     3     5
4    54 m                  3.19          3.44     2     5     3
# ... with 196 more rows</code></pre>
<p>Eine besondere Art, diese eigenen Funktionen zu definieren, sind sogenannte Lambda Funktionen. Diese sind anonyme Funktionen, die keinen Funktionsnamen erhalten und daher auch nur an der definierten Stelle verwendet werden können. Dabei sind zwei Sachen hervorzuheben. Auf der einen Seite muss man immer eine Tilde (<code>~</code>) führend hinzufügen. Auf der anderen Seite ändert sich auch der Name des Arguments innerhalb von <code>log()</code>. Schließlich haben wir hier keine Namen der Argumente (im Beispiel oben waren das <code>x</code> und <code>zahl</code>) festgelegt. Das zu übergebende Argument ist an dieser Stelle die jeweilige Spalte des Datensatzes. Diese wird unabhängig vom Kontext mit <code>.x</code> festgelegt (beachte den führenden Punkt).</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb114-1"><a href="datenvorbereitung.html#cb114-1" aria-hidden="true" tabindex="-1"></a>big5 <span class="sc">%&gt;%</span> </span>
<span id="cb114-2"><a href="datenvorbereitung.html#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(Extraversion<span class="sc">:</span>Neurotizismus, <span class="sc">~</span> <span class="fu">log</span>(.x) <span class="sc">+</span> <span class="dv">2</span>))</span></code></pre></div>
<div class="idea">
<p>Lambda Funktionen sind eine praktische Möglichkeit, schnell eigene wenig komplexe Funktionen zu erstellen, die man nur an einer Stelle benötigt. So spart man sich das eigenständige Erstellen einer neuen Funktion. Für komplexere Anwendungen ist jedoch das Erstellen einer eigenen Funktion mit <code>function() {}</code> der übersichtlichere und damit empfohlene Weg.</p>
</div>
<p>Mithilfe der Lambda Funktionen könnten wir jetzt auf einen Schlag nicht nur ein Item umkodieren, sondern so viele wie wir wollen. Wir erinnern uns, ein Item könnten wir mithilfe von <code>case_when()</code> umkodieren.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb115-1"><a href="datenvorbereitung.html#cb115-1" aria-hidden="true" tabindex="-1"></a>big5 <span class="sc">%&gt;%</span> </span>
<span id="cb115-2"><a href="datenvorbereitung.html#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(O1) <span class="sc">%&gt;%</span> </span>
<span id="cb115-3"><a href="datenvorbereitung.html#cb115-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">O1_new =</span> <span class="fu">case_when</span>(</span>
<span id="cb115-4"><a href="datenvorbereitung.html#cb115-4" aria-hidden="true" tabindex="-1"></a>    O1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb115-5"><a href="datenvorbereitung.html#cb115-5" aria-hidden="true" tabindex="-1"></a>    O1 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb115-6"><a href="datenvorbereitung.html#cb115-6" aria-hidden="true" tabindex="-1"></a>    O1 <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb115-7"><a href="datenvorbereitung.html#cb115-7" aria-hidden="true" tabindex="-1"></a>    O1 <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb115-8"><a href="datenvorbereitung.html#cb115-8" aria-hidden="true" tabindex="-1"></a>    O1 <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb115-9"><a href="datenvorbereitung.html#cb115-9" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>Möchten wir nun auf einen Schlag die Spalten <code>o1</code>, <code>O4</code> und <code>O6</code> umkodieren, könnten wir dies wie gewohnt mit <code>across()</code> erreichen. Was sich nun durch die Lambda Funktion ändern, ist zum einen die Tilde und zum anderen ersetzt unser Platzhalter Argument <code>.x</code> den Spaltennamen aus dem vorherigen Beispiel.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb116-1"><a href="datenvorbereitung.html#cb116-1" aria-hidden="true" tabindex="-1"></a>big5 <span class="sc">%&gt;%</span>  </span>
<span id="cb116-2"><a href="datenvorbereitung.html#cb116-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(O1, O3), <span class="sc">~</span> <span class="fu">case_when</span>(</span>
<span id="cb116-3"><a href="datenvorbereitung.html#cb116-3" aria-hidden="true" tabindex="-1"></a>    .x <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb116-4"><a href="datenvorbereitung.html#cb116-4" aria-hidden="true" tabindex="-1"></a>    .x <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb116-5"><a href="datenvorbereitung.html#cb116-5" aria-hidden="true" tabindex="-1"></a>    .x <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb116-6"><a href="datenvorbereitung.html#cb116-6" aria-hidden="true" tabindex="-1"></a>    .x <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb116-7"><a href="datenvorbereitung.html#cb116-7" aria-hidden="true" tabindex="-1"></a>    .x <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb116-8"><a href="datenvorbereitung.html#cb116-8" aria-hidden="true" tabindex="-1"></a>  ))</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 200 x 7
  Alter Geschlecht Extraversion Neurotizismus    O1    O2    O3
  &lt;dbl&gt; &lt;chr&gt;             &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1    36 m                   3             1.9     1     1     1
2    30 f                   3.1           3.4     1     3     1
3    23 m                   3.4           2.4     3     3     1
4    54 m                   3.3           4.2     4     5     3
# ... with 196 more rows</code></pre>
<p>Beachte an dieser Stelle, dass die schließende Klammer von <code>across()</code> erst hinter dem vollständigen Funktionsaufruf von <code>case_when()</code> geschrieben werden muss.</p>
<div class="exercise2">
<p>Das ist ein Platzhalter für eine Übung. Starte die Übung mit <code>hands_on("test")</code>.</p>
</div>
</div>
<div id="rowwise-und-c_across" class="section level2" number="6.6">
<h2><span class="header-section-number">6.6</span> <code>rowwise()</code> und <code>c_across()</code></h2>
<p>In Kapitel <a href="datenvorbereitung.html#mutate">6.4</a> haben wir bereits kennengelernt, wie man durch das Anwenden von Funktionen auf eine oder mehre Spalten eben diese verändert. Allerdings kann man mit dem bisherigen Wissen noch keine Berechnung in Abhängigkeit von den jeweiligen Zeilen durchführen. Dies ist allerdings gar kein seltener Anwendungsfall. Zum Beispiel möchte man die Mittelwerte bestimmter Spalten <strong>pro Person</strong> ausrechnen. Dafür gibt es die Funktionen <code>rowwise()</code> und <code>c_across()</code>, die miteinander kombiniert werden müssen.</p>
<p>Wir möchten an dieser Stelle den Mittelwert pro Person für Offenheit berechnen. Dieser ergibt sich aus drei einzelnen Fragen zur Offenheit (<code>O1</code>, <code>O2</code>, <code>O3</code>). Zuerst müssen wir die Funktion <code>rowwise()</code> aufrufen. Schließlich müssen wir R erst einmal signalisieren, dass wir die folgende Funktion nun pro Zeile (oder zeilenweise) anwenden möchten. Innerhalb von <code>mutate()</code> müssen unsere drei Fragen zur Offenheit nun der Funktion <code>c_across()</code> übergeben werden. Beachte das Präfix <code>c_</code> an dieser Stelle. Zur Kontrolle holen wir uns die neu erstellte Spalte namens Offenheit wieder an den Anfang des Datensatzes.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb118-1"><a href="datenvorbereitung.html#cb118-1" aria-hidden="true" tabindex="-1"></a>big5 <span class="sc">%&gt;%</span> </span>
<span id="cb118-2"><a href="datenvorbereitung.html#cb118-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb118-3"><a href="datenvorbereitung.html#cb118-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Offenheit =</span> <span class="fu">mean</span>(<span class="fu">c_across</span>(O1<span class="sc">:</span>O3))) <span class="sc">%&gt;%</span> </span>
<span id="cb118-4"><a href="datenvorbereitung.html#cb118-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Offenheit)</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 200 x 8
# Rowwise: 
  Offenheit Alter Geschlecht Extraversion Neurotizismus    O1    O2    O3
      &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;             &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1      3.67    36 m                   3             1.9     5     1     5
2      4.33    30 f                   3.1           3.4     5     3     5
3      3.67    23 m                   3.4           2.4     3     3     5
4      3.33    54 m                   3.3           4.2     2     5     3
# ... with 196 more rows</code></pre>
<p>Hinter die Spaltenauswahl mithilfe von <code>c_across()</code> können wir mit einem Komma getrennt wie gewohnt weitere Argumente der jeweiligen Funktion übergeben. Hier sei exemplarisch die Entfernung fehlender Werte mit <code>na.rm = TRUE</code> illustriert.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb120-1"><a href="datenvorbereitung.html#cb120-1" aria-hidden="true" tabindex="-1"></a>big5 <span class="sc">%&gt;%</span> </span>
<span id="cb120-2"><a href="datenvorbereitung.html#cb120-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb120-3"><a href="datenvorbereitung.html#cb120-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Offenheit =</span> <span class="fu">mean</span>(<span class="fu">c_across</span>(O1<span class="sc">:</span>O3), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<div class="exercise2">
<p>Das ist ein Platzhalter für eine Übung. Starte die Übung mit <code>hands_on("test")</code>.</p>
</div>
</div>
<div id="tidy" class="section level2" number="6.7">
<h2><span class="header-section-number">6.7</span> Breites und langes Datenformat</h2>
<p>Grundsätzlich kann man ein breites von einem sogenannten langen Datenformat unterscheiden. Im breiten Datensatz ist jede Spalte eine Variable, jede Zeile eine Beobachtung und jede Zelle ein Wert. Für die meisten Fälle ist das unser gewünschtes Datenformat. In Abbildung <a href="datenvorbereitung.html#fig:wideintro">6.2</a> ist ein einfaches Beispiel für einen breiten Datensatz mit drei Personen und zwei Variablen.</p>
<div class="figure" style="text-align: center"><span id="fig:wideintro"></span>
<img src="images/wide_intro.png" alt="Breites Datenformat mit drei Personen und zwei Variablen." width="40%" />
<p class="caption">
Abbildung 6.2: Breites Datenformat mit drei Personen und zwei Variablen.
</p>
</div>
<p>Für das Erstellen mehrfaktorieller Abbildungen und hierarchischer statistischer Modellierung benötigen wir allerdings das lange Datenformat. In Abbildung <a href="datenvorbereitung.html#fig:longintro">6.3</a> ist das lange Äquivalent zum gerade besprochenen breiten Datenbeispiel.</p>
<div class="figure" style="text-align: center"><span id="fig:longintro"></span>
<img src="images/long_intro.png" alt="Langes Datenformat mit Persönlichkeitsfaktor als Innersubjektfaktor." width="50%" />
<p class="caption">
Abbildung 6.3: Langes Datenformat mit Persönlichkeitsfaktor als Innersubjektfaktor.
</p>
</div>
<p>Schauen wir uns nun an, wie wir dies intuitiv mithilfe des <code>tidyr</code> Packages erreichen können. Mit <code>pivot_longer()</code> (engl. für Drehpunkt länger) können wir einen breiten ins lange Datenformat bringen. Auf der anderen Seite nutzen wir <code>pivot_wider()</code> für die Transformation vom langen ins breite Datenformat. Erster Funktion findet deutlich häufiger Anwendung.</p>
<p>Für das Umformatieren ins lange Datenformat ist es essentiell wichtig, einen eindeutigen Personenidentifikator im breiten Datensatz zu haben. Ansonsten wird es nicht funktionieren. Hier entscheiden wir uns einfach für die Zeilennummer, die wir mit der Funktion <code>row_number()</code> in die Spalte <code>VPN</code> (Akronym für <strong>V</strong>ersuchs<strong>p</strong>ersonen<strong>n</strong>ummer) schreiben.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb121-1"><a href="datenvorbereitung.html#cb121-1" aria-hidden="true" tabindex="-1"></a>wide_big5 <span class="ot">&lt;-</span> big5 <span class="sc">%&gt;%</span> </span>
<span id="cb121-2"><a href="datenvorbereitung.html#cb121-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">VPN =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb121-3"><a href="datenvorbereitung.html#cb121-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(VPN, Geschlecht, Extraversion, Neurotizismus) </span>
<span id="cb121-4"><a href="datenvorbereitung.html#cb121-4" aria-hidden="true" tabindex="-1"></a>wide_big5</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 200 x 4
    VPN Geschlecht Extraversion Neurotizismus
  &lt;int&gt; &lt;chr&gt;             &lt;dbl&gt;         &lt;dbl&gt;
1     1 m                   3             1.9
2     2 f                   3.1           3.4
3     3 m                   3.4           2.4
4     4 m                   3.3           4.2
# ... with 196 more rows</code></pre>
<p>Nun müssen wir in der Funktion <code>pivot_longer()</code> nur noch die gewünschten Spalten auswählen. Im obigen Beispiel wären das Extraversion und Neurotizismus. Beachte, dass wie bei <code>across()</code> auch hier die Spalten bei einzelner Auswahl der Funktion innerhalb von <code>c()</code> übergeben werden müssen. Nun müssen wir noch definieren, wie unsere beiden neuen Spalten heißen sollen. Schließlich kommen in eine Spalte unsere Werte (<code>values_to</code>) und in eine andere Spalte die Spaltennamen (<code>names_to</code>), welche hier die Persönlichkeitsfaktoren sind. Hier entscheiden wir uns für die Namen <code>"Auspraegung"</code> und <code>"Faktor"</code>. Die Namen müssen hier unbedingt in Anführungszeichen geschrieben werden, da die Spalten noch nicht existieren. Das Ergebnis speichern wir an dieser Stelle als <code>long_big5</code> ab.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb123-1"><a href="datenvorbereitung.html#cb123-1" aria-hidden="true" tabindex="-1"></a>long_big5 <span class="ot">&lt;-</span> wide_big5 <span class="sc">%&gt;%</span> </span>
<span id="cb123-2"><a href="datenvorbereitung.html#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb123-3"><a href="datenvorbereitung.html#cb123-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(Extraversion, Neurotizismus),</span>
<span id="cb123-4"><a href="datenvorbereitung.html#cb123-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;Auspraegung&quot;</span>,</span>
<span id="cb123-5"><a href="datenvorbereitung.html#cb123-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;Faktor&quot;</span></span>
<span id="cb123-6"><a href="datenvorbereitung.html#cb123-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb123-7"><a href="datenvorbereitung.html#cb123-7" aria-hidden="true" tabindex="-1"></a>long_big5</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 400 x 4
    VPN Geschlecht Faktor        Auspraegung
  &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;               &lt;dbl&gt;
1     1 m          Extraversion          3  
2     1 m          Neurotizismus         1.9
3     2 f          Extraversion          3.1
4     2 f          Neurotizismus         3.4
# ... with 396 more rows</code></pre>
<p>Zur Auswahl der Spalten können die selben Helferfunktionen verwendet werden wie in Kapitel <a href="datenvorbereitung.html#select">6.2</a> beschrieben (z.B. <code>starts_with()</code>, <code>ends_with()</code> oder <code>everything()</code>). Umgekehrt können wir mithilfe von <code>pivot_wider()</code> den Datensatz <code>long_big5</code> wieder ins breite Datenformat bringen. Dafür müssen wir hier nur festlegen, aus welcher Spalte die Werte (<code>values_from</code>) und woher die Spaltennamen (<code>names_from</code>) kommen sollen. Hier benötigen wir keine Anführungszeichen, da die Spalten bereits in unserem Datensatz enthalten sind.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb125-1"><a href="datenvorbereitung.html#cb125-1" aria-hidden="true" tabindex="-1"></a>long_big5 <span class="sc">%&gt;%</span> </span>
<span id="cb125-2"><a href="datenvorbereitung.html#cb125-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb125-3"><a href="datenvorbereitung.html#cb125-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Auspraegung,</span>
<span id="cb125-4"><a href="datenvorbereitung.html#cb125-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> Faktor</span>
<span id="cb125-5"><a href="datenvorbereitung.html#cb125-5" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 200 x 4
    VPN Geschlecht Extraversion Neurotizismus
  &lt;int&gt; &lt;chr&gt;             &lt;dbl&gt;         &lt;dbl&gt;
1     1 m                   3             1.9
2     2 f                   3.1           3.4
3     3 m                   3.4           2.4
4     4 m                   3.3           4.2
# ... with 196 more rows</code></pre>
<div class="idea">
<p>Als grobe Daumenregel kann man sich merken, dass man nicht vorhandene Spalten mit Anführungszeichen übergeben muss. Auf bereits im Datensatz vorhandene Spalten kann man hingegen im Regelfall ohne Anführungszeichen zugreifen.</p>
</div>
<div class="exercise2">
<p>Das ist ein Platzhalter für eine Übung. Starte die Übung mit <code>hands_on("test")</code>.</p>
</div>
</div>
<div id="spalten-trennen" class="section level2" number="6.8">
<h2><span class="header-section-number">6.8</span> Spalten trennen</h2>
<p>Mit der Funktion <code>separate()</code> können Spalten getrennt werden. Dies ist vor allem praktisch, wenn der Datensatz im langen Format vorliegt. Exemplarisch sei hier der im <code>remp</code> Package enthaltene Datensatz <code>big5_zeit</code> enthalten.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb127-1"><a href="datenvorbereitung.html#cb127-1" aria-hidden="true" tabindex="-1"></a>big5_zeit</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 5 x 5
    VPN Extrav_T1 Extrav_T2 NeurotFA NeurotFB
  &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1     1       3.2       3.3      2.8      3.2
2     2       1.7       1.5      4.1      3.2
3     3       2.8       2.7      3.2      2.8
4     4       4.7       4.2      1.7      2.4
# ... with 1 more row</code></pre>
<p>Um das hier bestehende Problem klarer zu machen, wandeln wir diesen erst einmal in ein langes Datenformat um.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb129-1"><a href="datenvorbereitung.html#cb129-1" aria-hidden="true" tabindex="-1"></a>zeit1 <span class="ot">&lt;-</span> big5_zeit <span class="sc">%&gt;%</span> </span>
<span id="cb129-2"><a href="datenvorbereitung.html#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>NeurotFA, <span class="sc">-</span>NeurotFB) <span class="sc">%&gt;%</span> </span>
<span id="cb129-3"><a href="datenvorbereitung.html#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb129-4"><a href="datenvorbereitung.html#cb129-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> Extrav_T1<span class="sc">:</span>Extrav_T2,</span>
<span id="cb129-5"><a href="datenvorbereitung.html#cb129-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;Faktor&quot;</span>,</span>
<span id="cb129-6"><a href="datenvorbereitung.html#cb129-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;Auspraegung&quot;</span></span>
<span id="cb129-7"><a href="datenvorbereitung.html#cb129-7" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb129-8"><a href="datenvorbereitung.html#cb129-8" aria-hidden="true" tabindex="-1"></a>zeit1</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 10 x 3
    VPN Faktor    Auspraegung
  &lt;int&gt; &lt;chr&gt;           &lt;dbl&gt;
1     1 Extrav_T1         3.2
2     1 Extrav_T2         3.3
3     2 Extrav_T1         1.7
4     2 Extrav_T2         1.5
# ... with 6 more rows</code></pre>
<p>Nun sehen wir, dass die Spalte <code>Faktor</code> zwei Informationen enthält. Einmal den Persönlichkeitsfaktor (<code>Extrav</code>) und einmal den entsprechenden Messzeitpunkt (<code>T1</code>, <code>T2</code>). Nun können wir der Funktion <code>separate()</code> die zu trennende Spalte übergeben. Außerdem müssen wir noch spezifizieren, in welche verschiedene Spalten wir hier trennen müssen (hier Faktor und Zeitpunkt). Getrennt sind die beiden Informationen durch einen Unterstrich (<code>_</code>). Dies können wir durch das <code>sep</code> (Akronym für <strong>Sep</strong>arator) festlegen. Hätten wir in der Spalte <code>Faktor</code> mehr als zwei Informationen durch mehrere Unterstriche getrennt, müssten wir dem Argument <code>into</code> entsprechend drei Spaltennamen übergeben.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb131-1"><a href="datenvorbereitung.html#cb131-1" aria-hidden="true" tabindex="-1"></a>zeit1 <span class="sc">%&gt;%</span> </span>
<span id="cb131-2"><a href="datenvorbereitung.html#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(</span>
<span id="cb131-3"><a href="datenvorbereitung.html#cb131-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> Faktor,</span>
<span id="cb131-4"><a href="datenvorbereitung.html#cb131-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;Faktor&quot;</span>, <span class="st">&quot;Zeitpunkt&quot;</span>),</span>
<span id="cb131-5"><a href="datenvorbereitung.html#cb131-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;_&quot;</span></span>
<span id="cb131-6"><a href="datenvorbereitung.html#cb131-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 10 x 4
    VPN Faktor Zeitpunkt Auspraegung
  &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;           &lt;dbl&gt;
1     1 Extrav T1                3.2
2     1 Extrav T2                3.3
3     2 Extrav T1                1.7
4     2 Extrav T2                1.5
# ... with 6 more rows</code></pre>
<p>Falls die Spalten nicht eindeutig durch einen Unterstrich, sondern beispielsweise durch Großschreibung voneinander getrennt werden sollen, kann man mit <code>sep</code> auch die Trennstelle (hier 6) festlegen.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb133-1"><a href="datenvorbereitung.html#cb133-1" aria-hidden="true" tabindex="-1"></a>big5_zeit <span class="sc">%&gt;%</span> </span>
<span id="cb133-2"><a href="datenvorbereitung.html#cb133-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Extrav_T1, <span class="sc">-</span>Extrav_T2) <span class="sc">%&gt;%</span> </span>
<span id="cb133-3"><a href="datenvorbereitung.html#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb133-4"><a href="datenvorbereitung.html#cb133-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> NeurotFA<span class="sc">:</span>NeurotFB,</span>
<span id="cb133-5"><a href="datenvorbereitung.html#cb133-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;Faktor&quot;</span>,</span>
<span id="cb133-6"><a href="datenvorbereitung.html#cb133-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;Auspraegung&quot;</span></span>
<span id="cb133-7"><a href="datenvorbereitung.html#cb133-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb133-8"><a href="datenvorbereitung.html#cb133-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(</span>
<span id="cb133-9"><a href="datenvorbereitung.html#cb133-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> Faktor,</span>
<span id="cb133-10"><a href="datenvorbereitung.html#cb133-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;Faktor&quot;</span>, <span class="st">&quot;Zeitpunkt&quot;</span>),</span>
<span id="cb133-11"><a href="datenvorbereitung.html#cb133-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep =</span> <span class="dv">6</span></span>
<span id="cb133-12"><a href="datenvorbereitung.html#cb133-12" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
</div>
<div id="datensätze-zusammenführen" class="section level2" number="6.9">
<h2><span class="header-section-number">6.9</span> Datensätze zusammenführen</h2>
<p><code>import(rbind = TRUE)</code>, <code>rbind()</code> <code>cbind()</code> <code>full_join()</code> <code>left_join()</code> <code>right_join()</code> <code>inner_join()</code></p>
</div>
<div id="datastring" class="section level2" number="6.10">
<h2><span class="header-section-number">6.10</span> Character Manipulation</h2>
<p>Oft muss man entweder die Spaltennamen oder die Inhalte verschiedener Spalten, die Characters enthalten in irgendeiner Form anpassen. In diesem Kapitel schauen wir uns an, wie man mit Funktionen aus <code>stringr</code> (enthalten im <code>tidyverse</code>) Character ersetzt (<code>str_replace()</code>), extrahiert (<code>str_extract()</code>) und entdeckt (<code>str_detect()</code>). Das Präfix <code>str</code> steht dabei für String – einem anderen Wort für Character.</p>
<p>Ein häufiges Ärgernis im Kontext von Programmiersprachen sind Umlaute, da verschiedene Zeichenkodierungen diese intern verschieden übersetzen, so dass auf anderen Betriebssystemen zu Kauderwelsch kommen kann. Schauen wir uns im Folgenden an, wie man Umlaute ersetzt. Es sei der Satz</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb134-1"><a href="datenvorbereitung.html#cb134-1" aria-hidden="true" tabindex="-1"></a>char <span class="ot">&lt;-</span> <span class="st">&quot;Österreich hat 28610 schräge Berge&quot;</span></span></code></pre></div>
<p>gegeben. Möchte man nun das <strong>eine</strong> <em>ä</em> mit <em>ae</em> ersetzen, verwendet man <code>str_replace()</code>.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb135-1"><a href="datenvorbereitung.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_replace</span>(</span>
<span id="cb135-2"><a href="datenvorbereitung.html#cb135-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">string =</span> char, </span>
<span id="cb135-3"><a href="datenvorbereitung.html#cb135-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">pattern =</span> <span class="st">&quot;ä&quot;</span>, </span>
<span id="cb135-4"><a href="datenvorbereitung.html#cb135-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">replacement =</span> <span class="st">&quot;ae&quot;</span></span>
<span id="cb135-5"><a href="datenvorbereitung.html#cb135-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre class="bordercode"><code>[1] &quot;Österreich hat 28610 schraege Berge&quot;</code></pre>
<p>Dabei muss der zu ersetzende Buchstabe immer zuerst eingegeben werden. Nun haben wir aber immer noch ein <em>ö</em> im Satz enthalten. Für mehr als eine Anpassung verwendet man <code>str_replace_all()</code>. Die Syntax ist leider etwas kontra intuitiv, wenn man bereits <code>select()</code> und <code>rename()</code> kennengelernt hat. Hier ist der <strong>alte</strong> Name auf der linken Seite der jeweiligen Gleichung.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb137-1"><a href="datenvorbereitung.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_replace_all</span>(</span>
<span id="cb137-2"><a href="datenvorbereitung.html#cb137-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">string =</span> char, </span>
<span id="cb137-3"><a href="datenvorbereitung.html#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;ä&quot;</span> <span class="ot">=</span> <span class="st">&quot;ae&quot;</span>, <span class="st">&quot;Ö&quot;</span> <span class="ot">=</span> <span class="st">&quot;Oe&quot;</span>)</span>
<span id="cb137-4"><a href="datenvorbereitung.html#cb137-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre class="bordercode"><code>[1] &quot;Oesterreich hat 28610 schraege Berge&quot;</code></pre>
<p>Aber wie geht man vor, wenn Spaltennamen Umlaute enthalten? Um dem auf den Grund zu gehen, erstellen wir uns einen neuen tibble (<a href="datatypes.html#tibble">12.3</a>), der die Preise für drei verschiedene Sägen in Österreich enthält.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb139-1"><a href="datenvorbereitung.html#cb139-1" aria-hidden="true" tabindex="-1"></a>umlaut <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb139-2"><a href="datenvorbereitung.html#cb139-2" aria-hidden="true" tabindex="-1"></a>  Säge <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Häxler&quot;</span>, <span class="st">&quot;Sünde3000&quot;</span>, <span class="st">&quot;Lölf4&quot;</span>),</span>
<span id="cb139-3"><a href="datenvorbereitung.html#cb139-3" aria-hidden="true" tabindex="-1"></a>  Ö<span class="at">sterreich =</span> <span class="fu">c</span>(<span class="fl">10.45</span>, <span class="fl">4.60</span>, <span class="fl">9.70</span>)</span>
<span id="cb139-4"><a href="datenvorbereitung.html#cb139-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb139-5"><a href="datenvorbereitung.html#cb139-5" aria-hidden="true" tabindex="-1"></a>umlaut</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 3 x 2
  Säge      Österreich
  &lt;chr&gt;          &lt;dbl&gt;
1 Häxler          10.4
2 Sünde3000        4.6
3 Lölf4            9.7</code></pre>
<p>Die Namen enthalten jeweils einen Umlaut. Beachte, dass ein Umlaut groß geschrieben ist und die Funktionen <em>case sensitive</em> sind. Das bedeutet, dass wir mit den Befehlen oben nur kleine Buchstaben ersetzen und nicht ihre großen Äquivalente. An dieser Stelle verwenden wir eine im Kapitel <a href="datenvorbereitung.html#function">6.5</a> bereits eingeführte so genannte Lambda Funktion.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb141-1"><a href="datenvorbereitung.html#cb141-1" aria-hidden="true" tabindex="-1"></a>umlaut <span class="sc">%&gt;%</span> </span>
<span id="cb141-2"><a href="datenvorbereitung.html#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), <span class="sc">~</span> <span class="fu">str_replace_all</span>(</span>
<span id="cb141-3"><a href="datenvorbereitung.html#cb141-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">string =</span> .x, </span>
<span id="cb141-4"><a href="datenvorbereitung.html#cb141-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;ä&quot;</span> <span class="ot">=</span> <span class="st">&quot;ae&quot;</span>,</span>
<span id="cb141-5"><a href="datenvorbereitung.html#cb141-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;ö&quot;</span> <span class="ot">=</span> <span class="st">&quot;oe&quot;</span>,</span>
<span id="cb141-6"><a href="datenvorbereitung.html#cb141-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;ü&quot;</span> <span class="ot">=</span> <span class="st">&quot;ue&quot;</span>,</span>
<span id="cb141-7"><a href="datenvorbereitung.html#cb141-7" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Ä&quot;</span> <span class="ot">=</span> <span class="st">&quot;Ae&quot;</span>,</span>
<span id="cb141-8"><a href="datenvorbereitung.html#cb141-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Ö&quot;</span> <span class="ot">=</span> <span class="st">&quot;Oe&quot;</span>,</span>
<span id="cb141-9"><a href="datenvorbereitung.html#cb141-9" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Ü&quot;</span> <span class="ot">=</span> <span class="st">&quot;Ue&quot;</span>)</span>
<span id="cb141-10"><a href="datenvorbereitung.html#cb141-10" aria-hidden="true" tabindex="-1"></a>  )))</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 3 x 2
  Säge       Österreich
  &lt;chr&gt;           &lt;dbl&gt;
1 Haexler          10.4
2 Suende3000        4.6
3 Loelf4            9.7</code></pre>
<p>Möchten wir alle Spaltennamen von Umlauten befreien, könnten wir dies mithilfe von <code>rename_with()</code> und <code>str_replace_all()</code> erreichen.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb143-1"><a href="datenvorbereitung.html#cb143-1" aria-hidden="true" tabindex="-1"></a>umlaut <span class="sc">%&gt;%</span> </span>
<span id="cb143-2"><a href="datenvorbereitung.html#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">str_replace_all</span>(</span>
<span id="cb143-3"><a href="datenvorbereitung.html#cb143-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">string =</span> .x, </span>
<span id="cb143-4"><a href="datenvorbereitung.html#cb143-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;ä&quot;</span> <span class="ot">=</span> <span class="st">&quot;ae&quot;</span>,</span>
<span id="cb143-5"><a href="datenvorbereitung.html#cb143-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;ö&quot;</span> <span class="ot">=</span> <span class="st">&quot;oe&quot;</span>,</span>
<span id="cb143-6"><a href="datenvorbereitung.html#cb143-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;ü&quot;</span> <span class="ot">=</span> <span class="st">&quot;ue&quot;</span>,</span>
<span id="cb143-7"><a href="datenvorbereitung.html#cb143-7" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Ä&quot;</span> <span class="ot">=</span> <span class="st">&quot;Ae&quot;</span>,</span>
<span id="cb143-8"><a href="datenvorbereitung.html#cb143-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Ö&quot;</span> <span class="ot">=</span> <span class="st">&quot;Oe&quot;</span>,</span>
<span id="cb143-9"><a href="datenvorbereitung.html#cb143-9" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Ü&quot;</span> <span class="ot">=</span> <span class="st">&quot;Ue&quot;</span>)</span>
<span id="cb143-10"><a href="datenvorbereitung.html#cb143-10" aria-hidden="true" tabindex="-1"></a>  ))</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 3 x 2
  Saege     Oesterreich
  &lt;chr&gt;           &lt;dbl&gt;
1 Häxler           10.4
2 Sünde3000         4.6
3 Lölf4             9.7</code></pre>
<p>Für das Extrahieren von Buchstaben oder Zahlen können wir <code>str_extract()</code> verwenden. Wir nehmen wieder unseren Beispielsatz von oben, der als <code>char</code> gespeichert ist. Wir könnten beispielsweise die Zahl herausfiltern, indem wir einen sogenannten Regex verwenden (Akronym für <strong>Reg</strong>ular <strong>Ex</strong>pression). Diese sind grundsätzlich sehr komplex und benötigen zur vernünftigen Einführung ein eigenes Buch. In der Praxis muss man in der Regel nur Online nach dem gewünschten Regex suchen, ohne selbst jeden Kniff und jedes Detail zu kennen. Um eine Zahl mit mehr als einer Ziffer herauszuholen, könnte man nach <code>"\\d+"</code> suchen. Der erste Backslash ist nur nötig, weil wir mit R arbeiten. Danach folgt ein weiterer Backslash sowie ein d (für <strong>d</strong>igit, engl. für Ziffer) und ein Plus zur Signalisierung, dass es sich hier auch um eine Zahl mit mehreren Ziffern handeln kann.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb145-1"><a href="datenvorbereitung.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(char, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">d+&quot;</span>)</span></code></pre></div>
<pre class="bordercode"><code>[1] &quot;28610&quot;</code></pre>
<p>Die Funktion <code>str_detect()</code> entdeckt bestimmte Buchstaben, Wörter oder ganze Regex. Dabei gibt die Funktion einen logischen Wert aus (<code>TRUE</code>, <code>FALSE</code>), wenn das Gesuchte gefunden oder nicht gefunden wurde. Das ist daher praktisch, da man diese Funktion für logische Bedingungen innerhalb von <code>if_else()</code> oder <code>case_when()</code> verwenden kann.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb147-1"><a href="datenvorbereitung.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_detect</span>(char, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">d+&quot;</span>)</span></code></pre></div>
<pre class="bordercode"><code>[1] TRUE</code></pre>
<div class="idea">
<p>In der Praxis müssen die Funktionen aus dem <code>stringr</code> Package in der Regel in Kombination mit <code>mutate()</code> verwendet werden. Einen weiteren Anwendungsfall stellt der Umbruch langer Achsenbeschriftung bei der Erstellung von Visualisierungen mithilfe von <code>str_wrap()</code> dar.</p>
</div>
<div class="exercise2">
<p>Das ist ein Platzhalter für eine Übung. Starte die Übung mit <code>hands_on("test")</code>.</p>
</div>
</div>
<div id="datafactor" class="section level2" number="6.11">
<h2><span class="header-section-number">6.11</span> Faktoren verändern</h2>
<p>Falls du nicht mehr genau im Kopf hast, was Faktoren sind, schaue Dir noch einmal Kapitel <a href="vars.html#factor">4.4</a> an. Faktoren sind vor allem zur automatischen Erstellung von Dummy Variablen für Regressionsmodelle (siehe Kapitel <a href="inductive.html#linregression">9.6.1</a>), für das richtige Abbilden und das Ändern der Reihenfolge für das Erstellen von Visualisierungen (siehe Kapitel <a href="visual.html#barplot">8.6</a>) sowie für andere inferenzstatistische Verfahren nützlich. Im Folgenden schauen wir uns Beispiele an, wie man mit einer Funktion aus dem <code>forcats</code> Package (mit dem <code>tidyverse</code> geladen) Faktoren umbenennen (<code>fct_recode()</code>) und deren Reihenfolge ändern (<code>fct_relevel()</code>, <code>fct_reorder()</code>) kann. Dafür verwenden wir die Spalte <code>Gruppe</code> aus dem <code>big5_mod</code> Datensatz mit den Faktorstufen (oder Leveln) <em>Jungspund</em>, <em>Mittel</em>, und <em>Weise</em>.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb149-1"><a href="datenvorbereitung.html#cb149-1" aria-hidden="true" tabindex="-1"></a>big5_mod <span class="sc">%&gt;%</span> </span>
<span id="cb149-2"><a href="datenvorbereitung.html#cb149-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Gruppe)</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 200 x 6
  Gruppe Alter Geschlecht Extraversion Neurotizismus    ID
  &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;             &lt;dbl&gt;         &lt;dbl&gt; &lt;int&gt;
1 Mittel    36 m                   3             1.9     1
2 Jung      30 f                   3.1           3.4     2
3 Jung      23 m                   3.4           2.4     3
4 Weise     54 m                   3.3           4.2     4
# ... with 196 more rows</code></pre>
<p>Um die Veränderungen der Faktorstufen besser darstellen zu können, ziehen wir uns die Spalte <code>Gruppe</code> aus dem Datensatz heraus (siehe Kapitel <a href="io.html#inR">5.3</a>). Zuvor müssen wir die Spalte allerdings noch zum Datentyp Faktor umwandeln.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb151-1"><a href="datenvorbereitung.html#cb151-1" aria-hidden="true" tabindex="-1"></a>faktoren <span class="ot">&lt;-</span> big5_mod <span class="sc">%&gt;%</span></span>
<span id="cb151-2"><a href="datenvorbereitung.html#cb151-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Gruppe =</span> <span class="fu">as.factor</span>(Gruppe)) <span class="sc">%&gt;%</span></span>
<span id="cb151-3"><a href="datenvorbereitung.html#cb151-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(Gruppe) </span></code></pre></div>
<p>Zum Anzeigen der Faktorstufen, verwenden wir <code>levels</code></p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb152-1"><a href="datenvorbereitung.html#cb152-1" aria-hidden="true" tabindex="-1"></a>faktoren <span class="sc">%&gt;%</span> </span>
<span id="cb152-2"><a href="datenvorbereitung.html#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levels</span>()</span></code></pre></div>
<pre class="bordercode"><code>[1] &quot;Jung&quot;   &quot;Mittel&quot; &quot;Weise&quot; </code></pre>
<p>Dass die Reihenfolge schon der Altersreihenfolge entspricht, liegt nur daran, dass wir die Faktorstufen oben genau spezifiziert haben. Ansonsten können durchaus unerwartete Reihenfolgen der Faktorstufen auftreten. Es lohnt sich also in jedem Fall ein Blick in die Faktorstufen, bevor man sie verwendet. Möchte man einzelne Faktoren umbenennen, verwendet man <code>fct_recode()</code>.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb154-1"><a href="datenvorbereitung.html#cb154-1" aria-hidden="true" tabindex="-1"></a>faktoren <span class="sc">%&gt;%</span> </span>
<span id="cb154-2"><a href="datenvorbereitung.html#cb154-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fct_recode</span>(<span class="at">Alt =</span> <span class="st">&quot;Weise&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb154-3"><a href="datenvorbereitung.html#cb154-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levels</span>()</span></code></pre></div>
<pre class="bordercode"><code>[1] &quot;Jung&quot;   &quot;Mittel&quot; &quot;Alt&quot;   </code></pre>
<p>Möchten wir eine bestimmte Faktorstufe an erster Stelle haben, verwenden wir <code>fct_relevel()</code> mit der gewünschten Stufe als Character.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb156-1"><a href="datenvorbereitung.html#cb156-1" aria-hidden="true" tabindex="-1"></a>faktoren <span class="sc">%&gt;%</span> </span>
<span id="cb156-2"><a href="datenvorbereitung.html#cb156-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fct_relevel</span>(<span class="st">&quot;Mittel&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb156-3"><a href="datenvorbereitung.html#cb156-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levels</span>()</span></code></pre></div>
<pre class="bordercode"><code>[1] &quot;Mittel&quot; &quot;Jung&quot;   &quot;Weise&quot; </code></pre>
<p>Zum Ändern der gesamten Reihenfolge kann man beliebig viele weitere Faktorstufen der Funktion übergeben.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb158-1"><a href="datenvorbereitung.html#cb158-1" aria-hidden="true" tabindex="-1"></a>faktoren <span class="sc">%&gt;%</span> </span>
<span id="cb158-2"><a href="datenvorbereitung.html#cb158-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fct_relevel</span>(<span class="st">&quot;Weise&quot;</span>, <span class="st">&quot;Mittel&quot;</span>, <span class="st">&quot;Jung&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb158-3"><a href="datenvorbereitung.html#cb158-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levels</span>()</span></code></pre></div>
<pre class="bordercode"><code>[1] &quot;Weise&quot;  &quot;Mittel&quot; &quot;Jung&quot;  </code></pre>
<p>Wenn die Reihenfolge der Faktoren in absteigender (<code>.desc = TRUE</code>) oder aufsteigender (<code>.desc = FALSE</code>) Reihenfolge z.B. in Abhängigkeit des Mittelwertes einer anderen Spalte (wie dem Ausmaß an Extraversion) sortiert werden soll, verwendet man <code>fct_reorder()</code>.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb160-1"><a href="datenvorbereitung.html#cb160-1" aria-hidden="true" tabindex="-1"></a>extraversion <span class="ot">&lt;-</span> big5_mod <span class="sc">%&gt;%</span> </span>
<span id="cb160-2"><a href="datenvorbereitung.html#cb160-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(Extraversion)</span></code></pre></div>
<div class="sourceCode" id="cb161"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb161-1"><a href="datenvorbereitung.html#cb161-1" aria-hidden="true" tabindex="-1"></a>faktoren <span class="sc">%&gt;%</span> </span>
<span id="cb161-2"><a href="datenvorbereitung.html#cb161-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fct_reorder</span>(</span>
<span id="cb161-3"><a href="datenvorbereitung.html#cb161-3" aria-hidden="true" tabindex="-1"></a>    extraversion, </span>
<span id="cb161-4"><a href="datenvorbereitung.html#cb161-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">.fun =</span> mean, </span>
<span id="cb161-5"><a href="datenvorbereitung.html#cb161-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">.desc =</span> <span class="cn">TRUE</span></span>
<span id="cb161-6"><a href="datenvorbereitung.html#cb161-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb161-7"><a href="datenvorbereitung.html#cb161-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levels</span>()</span></code></pre></div>
<pre class="bordercode"><code>[1] &quot;Mittel&quot; &quot;Jung&quot;   &quot;Weise&quot; </code></pre>
<p>Dabei kann man mit dem Argument <code>.fun</code> die gewünschte Funktion zur Auswertung der zweiten Variable (hier Extraversion) verwenden. In den am Anfang des Kapitels beschriebenen Anwendungsfällen wird es noch klarer werden, weshalb die Notwendigkeit von Faktoren besteht und inwiefern Dir die Funktionen aus dem <code>forcats</code> Package konkret das Leben erleichtern.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb163-1"><a href="datenvorbereitung.html#cb163-1" aria-hidden="true" tabindex="-1"></a>big5_mod <span class="sc">%&gt;%</span> </span>
<span id="cb163-2"><a href="datenvorbereitung.html#cb163-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Gruppe =</span> <span class="fu">fct_relevel</span>(Gruppe, <span class="st">&quot;Jung&quot;</span>))</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 200 x 6
  Alter Geschlecht Extraversion Neurotizismus Gruppe    ID
  &lt;dbl&gt; &lt;chr&gt;             &lt;dbl&gt;         &lt;dbl&gt; &lt;fct&gt;  &lt;int&gt;
1    36 m                   3             1.9 Mittel     1
2    30 f                   3.1           3.4 Jung       2
3    23 m                   3.4           2.4 Jung       3
4    54 m                   3.3           4.2 Weise      4
# ... with 196 more rows</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb165-1"><a href="datenvorbereitung.html#cb165-1" aria-hidden="true" tabindex="-1"></a>big5_mod <span class="sc">%&gt;%</span> </span>
<span id="cb165-2"><a href="datenvorbereitung.html#cb165-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Gruppe =</span> <span class="fu">fct_reorder</span>(</span>
<span id="cb165-3"><a href="datenvorbereitung.html#cb165-3" aria-hidden="true" tabindex="-1"></a>    Gruppe, Alter, </span>
<span id="cb165-4"><a href="datenvorbereitung.html#cb165-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">.fun =</span> mean, </span>
<span id="cb165-5"><a href="datenvorbereitung.html#cb165-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">.desc =</span> <span class="cn">FALSE</span>)</span>
<span id="cb165-6"><a href="datenvorbereitung.html#cb165-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 200 x 6
  Alter Geschlecht Extraversion Neurotizismus Gruppe    ID
  &lt;dbl&gt; &lt;chr&gt;             &lt;dbl&gt;         &lt;dbl&gt; &lt;fct&gt;  &lt;int&gt;
1    36 m                   3             1.9 Mittel     1
2    30 f                   3.1           3.4 Jung       2
3    23 m                   3.4           2.4 Jung       3
4    54 m                   3.3           4.2 Weise      4
# ... with 196 more rows</code></pre>
<div class="warning">
<p>Faktoren sollten erst unmittelbar vor Verwendung erstellt und verändert werden. Es kann im Umgang von Faktoren zu seltsamen Fehlermeldungen kommen, da diese innerhalb von R als Integer und nicht als Character behandelt werden.</p>
</div>
<div class="exercise2">
<p>Das ist ein Platzhalter für eine Übung. Starte die Übung mit <code>hands_on("test")</code>.</p>
</div>
</div>
<div id="datazeit" class="section level2" number="6.12">
<h2><span class="header-section-number">6.12</span> Mit Zeitdaten arbeiten</h2>
<p>In Kapitel <a href="vars.html#zeitdaten">4.5</a> wurden zwei verschiedene Zeitdatentypen bereits eingeführt. Wir schauen uns an dieser Stelle noch einige nützliche Funktionen aus dem <code>lubridate</code> Package an. Möchte man ein Datum auseinander nehmen, kann man die Funktionen <code>year()</code>, <code>month()</code> und <code>day()</code> verwenden.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb167-1"><a href="datenvorbereitung.html#cb167-1" aria-hidden="true" tabindex="-1"></a>video <span class="sc">%&gt;%</span> </span>
<span id="cb167-2"><a href="datenvorbereitung.html#cb167-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb167-3"><a href="datenvorbereitung.html#cb167-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Jahr =</span> <span class="fu">year</span>(Watchdate),</span>
<span id="cb167-4"><a href="datenvorbereitung.html#cb167-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Monat =</span> <span class="fu">month</span>(Watchdate),</span>
<span id="cb167-5"><a href="datenvorbereitung.html#cb167-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Tag =</span> <span class="fu">day</span>(Watchdate)</span>
<span id="cb167-6"><a href="datenvorbereitung.html#cb167-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb167-7"><a href="datenvorbereitung.html#cb167-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Watchdate, Tag, Monat, Jahr)</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 1,493 x 4
  Watchdate             Tag Monat  Jahr
  &lt;dttm&gt;              &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
1 2019-07-22 00:00:00    22     7  2019
2 2019-07-22 00:00:00    22     7  2019
3 2019-07-21 00:00:00    21     7  2019
4 2019-07-21 00:00:00    21     7  2019
# ... with 1,489 more rows</code></pre>
<p>Neben der bereits vorgestellten <code>ymd()</code> Funktion, die aus dem Format Jahr-Monat-Tag einen Eintrag vom Typ <code>Date</code> erstellt</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb169-1"><a href="datenvorbereitung.html#cb169-1" aria-hidden="true" tabindex="-1"></a>date1 <span class="ot">&lt;-</span> <span class="st">&quot;02.08.2019&quot;</span></span>
<span id="cb169-2"><a href="datenvorbereitung.html#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dmy</span>(date1)</span></code></pre></div>
<pre class="bordercode"><code>[1] &quot;2019-08-02&quot;</code></pre>
<p>gibt es auf selbe Art und Weise die Funktion <code>dmy()</code>, die mit Daten nach dem Format Tag-Monat-Jahr arbeiten kann.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb171-1"><a href="datenvorbereitung.html#cb171-1" aria-hidden="true" tabindex="-1"></a>date2 <span class="ot">&lt;-</span> <span class="st">&quot;2019-08-02&quot;</span></span>
<span id="cb171-2"><a href="datenvorbereitung.html#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ymd</span>(date2) </span></code></pre></div>
<pre class="bordercode"><code>[1] &quot;2019-08-02&quot;</code></pre>
</div>
<div id="binäre-antwortmatrix-erstellen" class="section level2" number="6.13">
<h2><span class="header-section-number">6.13</span> Binäre Antwortmatrix erstellen</h2>
<p>Wenn man Daten im Rahmen von Fragebögen erhebt, kriegt man meist nicht zurück, ob ein Item (eine Aufgabe oder Frage) richtig oder falsch beantwortet wurde. Stattdessen werden nur die abgegeben Antworten im Datensatz gespeichert. Mit <code>transform_binary()</code> aus dem <code>remp</code> Package kann man den Datensatz in die gewünschte binäre Antwortmatrix umwandeln. Sprich, man erhält die Information für jedes Item pro Person, ob das Item richtig (1) oder falsch (0) beantwortet wurde. Wenn wir einen Beispielsdatensatz mit drei Items und vier Antwortoptionen haben, die vier Personen beantwortet haben,</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb173-1"><a href="datenvorbereitung.html#cb173-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> big5 <span class="sc">%&gt;%</span> </span>
<span id="cb173-2"><a href="datenvorbereitung.html#cb173-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(O1<span class="sc">:</span>O3)</span>
<span id="cb173-3"><a href="datenvorbereitung.html#cb173-3" aria-hidden="true" tabindex="-1"></a>df2</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 200 x 3
     O1    O2    O3
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     5     1     5
2     5     3     5
3     3     3     5
4     2     5     3
# ... with 196 more rows</code></pre>
<p>bei Item 1 die Antwort 3 richtig ist, bei Item 2 die Antwort 2 und bei Item 3 die Antwort 4, würde man die Antworten in einer Variable speichern.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb175-1"><a href="datenvorbereitung.html#cb175-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="sc">%&gt;%</span> </span>
<span id="cb175-2"><a href="datenvorbereitung.html#cb175-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transform_binary</span>(<span class="at">answers =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">5</span>))</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 200 x 3
     O1    O2    O3
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0     1     1
2     0     0     1
3     0     0     1
4     0     0     0
# ... with 196 more rows</code></pre>
<p>Nun benutzen wir die Funktion konsistent zu den bisher gelernten in Kombination mit der Pipe.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r bordercode"><code class="sourceCode r"><span id="cb177-1"><a href="datenvorbereitung.html#cb177-1" aria-hidden="true" tabindex="-1"></a>big5 <span class="sc">%&gt;%</span> </span>
<span id="cb177-2"><a href="datenvorbereitung.html#cb177-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Geschlecht, O1<span class="sc">:</span>O3) <span class="sc">%&gt;%</span>  </span>
<span id="cb177-3"><a href="datenvorbereitung.html#cb177-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transform_binary</span>(<span class="at">answers =</span> <span class="fu">tibble</span>(<span class="st">&quot;f&quot;</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">5</span>))</span></code></pre></div>
<pre class="bordercode"><code># A tibble: 200 x 4
  Geschlecht    O1    O2    O3
       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1          0     0     1     1
2          1     0     0     1
3          0     0     0     1
4          0     0     0     0
# ... with 196 more rows</code></pre>

</div>
</div>



</div>
            </section>

          </div>
        </div>
      </div>
<a href="io.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="descr.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
},
"toc_depth": 3,
"info": false,
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
